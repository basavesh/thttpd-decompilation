//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <ctype.h>
#include <dirent.h>
#include <errno.h>
#include <fcntl.h>
#include <grp.h>
#include <netdb.h>
#include <pwd.h>
#include <signal.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/poll.h>
#include <sys/resource.h>
#include <sys/socket.h>
#include <sys/stat.h>
#include <sys/syslog.h>
#include <sys/time.h>
#include <sys/uio.h>
#include <sys/wait.h>
#include <time.h>
#include <unistd.h>

// ---------------- Integer Types Definitions -----------------

typedef int64_t int128_t;

// ----------------- Float Types Definitions ------------------

typedef double float64_t;

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

struct __dirstream {
    int32_t e0;
};

struct addrinfo {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    struct sockaddr * e5;
    char * e6;
    struct addrinfo * e7;
};

struct dirent {
    int32_t e0;
    int32_t e1;
    int16_t e2;
    char e3;
    char e4[256];
};

struct iovec {
    int64_t * e0;
    int32_t e1;
};

struct passwd {
    char * e0;
    char * e1;
    int32_t e2;
    int32_t e3;
    char * e4;
    char * e5;
    char * e6;
};

struct pollfd {
    int32_t e0;
    int16_t e1;
    int16_t e2;
};

struct rlimit {
    int32_t e0;
    int32_t e1;
};

struct sockaddr {
    int64_t e0;
    char e1[14];
};

struct stat {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int32_t e12;
    int32_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
};

struct timeval {
    int64_t e0;
    int64_t e1;
};

struct timezone {
    int32_t e0;
    int32_t e1;
};

struct tm {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    char * e10;
};

// ------------------- Function Prototypes --------------------

int64_t __do_global_dtors_aux(void);
int64_t _fini(void);
int64_t _init(void);
int64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t auth_check2(int64_t a1, int64_t * str, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t build_env(char * str2, char * str);
int64_t cgi_interpose_input(int64_t a1, int32_t fd);
int64_t cgi_interpose_output(int64_t a1, int64_t a2, int64_t a3);
int64_t cgi_kill(int64_t pid, int64_t a2, int64_t a3, int64_t a4, int64_t a5);
int64_t cgi_kill2(int64_t pid);
int64_t check_referrer(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t clear_connection(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5);
int64_t deregister_tm_clones(void);
int64_t expand_symlinks(int64_t a1, int64_t * a2, int32_t a3, int32_t a4);
int64_t ext_compare(int64_t str, int64_t str2);
int64_t fdwatch(int64_t timeout, int64_t a2, int64_t a3, int64_t a4);
int64_t fdwatch_add_fd(uint32_t a1, uint32_t a2, int32_t a3);
int64_t fdwatch_check_fd(uint32_t a1);
int64_t fdwatch_del_fd(uint32_t a1);
int64_t fdwatch_get_next_client_data(void);
int64_t fdwatch_get_nfiles(void);
int64_t fdwatch_logstats(uint64_t a1);
int64_t frame_dummy(void);
int64_t free_httpd_server(int64_t a1);
char * function_5030(char * name);
void function_5040(int64_t * ptr);
int32_t function_5050(char * s1, char * s2);
void function_5060(void);
struct tm * function_5070(int32_t * timer);
void function_5080(void);
int32_t * function_5090(void);
char * function_50a0(char * dest, char * src, int32_t n);
int32_t function_50b0(char * s1, char * s2, int32_t n);
void function_50c0(int32_t status);
char * function_50d0(char * dest, char * src);
int32_t function_50e0(char * path);
int32_t function_50f0(int32_t fd, struct iovec * iovec, int32_t count);
int32_t function_5100(char * s);
void function_5110(int64_t * base, int32_t nmemb, int32_t size, int32_t (*compar)(int64_t *, int64_t *));
int32_t function_5120(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * stream);
int32_t function_5130(char * s, int32_t maxlen, char * format, int64_t arg);
int32_t function_5140(int32_t fd, int32_t level, int32_t optname, int64_t * optval, int32_t optlen);
int32_t function_5150(char * path, char * buf, int32_t len);
int32_t function_5160(int32_t fd, int32_t cmd, ...);
int32_t function_5170(int32_t fd, int64_t * buf, int32_t n);
int32_t function_5180(void);
int32_t function_5190(struct _IO_FILE * stream);
struct __dirstream * function_51a0(char * name);
char * function_51b0(int32_t * timer);
int32_t function_51c0(int32_t fd, int32_t how);
int32_t function_51d0(char * s);
int32_t function_51e0(char * path);
int32_t function_51f0(void);
int64_t * function_5200(int64_t * addr, int32_t len, int32_t prot, int32_t flags, int32_t fd, int32_t offset);
int32_t function_5210(int32_t fd, int32_t fd2);
char * function_5220(char * s, int32_t c);
int32_t function_5230(char * s, int32_t maxlen, char * format, ...);
char * function_5240(int32_t ecode);
char * function_5250(char * s, int32_t c);
int32_t function_5260(struct timeval * tv, struct timezone * tz);
int64_t * function_5270(int64_t * s, int32_t c, int32_t n);
char * function_5280(char * buf, int32_t size);
int32_t function_5290(int32_t seconds);
int32_t function_52a0(int32_t fd);
int32_t function_52b0(int32_t n, int32_t * groups);
int32_t function_52c0(int32_t pipedes[2]);
int32_t function_52d0(struct sockaddr * sa, int32_t salen, char * host, int32_t hostlen, char * serv, int32_t servlen, int32_t flags);
int32_t function_52e0(void);
int32_t function_52f0(char * s, char * accept2);
int32_t function_5300(struct __dirstream * dirp);
int32_t function_5310(char * s, char * reject);
int64_t * function_5320(int64_t * s, int32_t c, int32_t n);
int32_t function_5330(int32_t fd, int64_t * buf, int32_t nbytes);
int32_t function_5340(char * file, struct stat * buf);
char * function_5350(char * s, int32_t n, struct _IO_FILE * stream);
int32_t function_5360(char * path, char * argv[1], char * envp[1]);
int32_t function_5370(char * s1, char * s2);
int64_t function_5380(char * nptr, char ** endptr, int32_t base);
struct passwd * function_5390(char * name);
int32_t function_53a0(struct _IO_FILE * stream, char * format, ...);
int32_t function_53b0(char * file, struct stat * buf);
int32_t function_53c0(char * nptr, char ** endptr, int32_t base);
int64_t * function_53d0(int64_t * dest, int64_t * src, int32_t n);
void function_53e0(void);
int32_t function_53f0(int32_t pid, int32_t sig);
int32_t function_5400(int32_t * timer);
int32_t function_5410(struct _IO_FILE * stream);
struct dirent * function_5420(struct __dirstream * dirp);
int64_t * function_5430(int32_t size);
int32_t function_5440(char * s1, char * s2, int32_t n);
int32_t function_5450(struct _IO_FILE * stream);
int32_t function_5460(int32_t inc);
int32_t function_5470(char * s, char * format, ...);
void function_5480(int32_t pri, char * fmt, ...);
int32_t function_5490(int32_t fd, int32_t n);
int32_t function_54a0(int32_t nochdir, int32_t noclose);
char * function_54b0(char * s, char * accept2);
int32_t function_54c0(int64_t resource, struct rlimit * rlimits);
int64_t * function_54d0(int64_t * ptr, int32_t size);
struct _IO_FILE * function_54e0(int32_t fd, char * modes);
int32_t function_54f0(int64_t * addr, int32_t len);
int32_t function_5500(struct pollfd * fds, int32_t nfds, int32_t timeout);
int32_t function_5510(int32_t fd, struct sockaddr * addr, int32_t len);
void (*function_5520(int32_t sig, void (*disp)(int32_t)))(int32_t);
int32_t function_5530(char * s, int32_t maxsize, char * format, struct tm * tp);
int64_t * function_5540(int64_t * dest, int64_t * src, int32_t n);
int32_t function_5550(int32_t gid);
int32_t function_5560(int32_t pid, int32_t * stat_loc, int32_t options);
int32_t function_5570(char * file, int32_t oflag, ...);
int32_t function_5580(int32_t fd, int32_t owner, int32_t group);
struct _IO_FILE * function_5590(char * filename, char * modes);
void function_55a0(char * s);
struct tm * function_55b0(int32_t * timer);
int32_t function_55c0(int32_t fd, struct sockaddr * addr, int32_t * addr_len);
int32_t function_55d0(int32_t fd, struct sockaddr * addr, int32_t * len);
char * function_55e0(char * dest, char * src);
void function_55f0(char * ident, int32_t option, int32_t facility);
int32_t function_5600(char * name, int32_t len);
int32_t function_5610(char * s, char * format, ...);
void function_5620(int32_t status);
int32_t function_5630(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s);
int32_t function_5640(int64_t resource, struct rlimit * rlimits);
int32_t function_5650(int32_t uid);
int32_t function_5660(char * name, char * service, struct addrinfo * req, struct addrinfo ** pai);
char * function_5670(char * s);
int32_t function_5680(char * user, int32_t group);
char * function_5690(char * key, char * salt);
int32_t function_56a0(int32_t seconds);
int32_t function_56b0(void);
char * function_56c0(char * haystack, char * needle);
int32_t function_56d0(void);
int32_t ** function_56e0(void);
int16_t ** function_56f0(void);
void function_5700(struct addrinfo * ai);
int32_t function_5710(int32_t domain, int32_t type, int32_t protocol);
void function_5720(int64_t * d);
int64_t handle_alrm(void);
int64_t handle_chld(void);
int64_t handle_hup(void);
int64_t handle_newconnect(int64_t * a1, uint32_t a2);
int64_t handle_term(int64_t a1);
int64_t handle_usr1(void);
int64_t handle_usr2(int64_t a1);
int64_t httpd_clear_ndelay(int64_t a1, int64_t a2, int64_t a3);
int64_t httpd_close_conn(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_destroy_conn(int64_t a1);
int64_t httpd_get_conn(int64_t a1, int64_t sock, int64_t a3);
int64_t httpd_got_request(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_initialize(int64_t str, int64_t a2, int64_t a3, int16_t a4, int64_t a5, int32_t a6, int64_t str5, int64_t str6, int64_t a9, int64_t * str7, int64_t a11, int64_t a12, int64_t a13, int64_t a14, int64_t a15, int64_t str8, int64_t str9, int64_t a18);
int64_t httpd_logstats(void);
int64_t httpd_method_str(int64_t a1);
int64_t httpd_ntoa(int64_t sa, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_parse_request(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_read_fully(int64_t fd, int64_t a2, uint64_t a3);
int64_t httpd_realloc_str(int64_t a1, uint64_t result, uint64_t a3);
int64_t httpd_send_err(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_set_logfp(int64_t a1, int64_t a2);
int64_t httpd_set_ndelay(int32_t fd, int64_t a2, int64_t a3);
int64_t httpd_start_request(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t httpd_terminate(int64_t a1);
int64_t httpd_unlisten(int64_t a1);
int64_t httpd_write_fully(int64_t fd, int64_t a2, uint64_t a3);
int64_t httpd_write_response(int64_t a1, int64_t a2, int64_t a3);
int64_t idle(int64_t a1, int64_t a2);
int64_t initialize_listen_socket(int64_t sa, int32_t a2, int32_t a3, int32_t a4, int64_t a5, int64_t a6);
int64_t l_resort(int64_t a1);
int64_t linger_clear_connection(int64_t a1);
int64_t logstats(int32_t a1, int64_t a2);
int64_t match(int64_t a1, int64_t a2);
int64_t match_one(int64_t a1, int32_t a2, int64_t a3);
int64_t mmc_cleanup(int64_t a1);
int64_t mmc_logstats(void);
int64_t mmc_map(int64_t path, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t mmc_term(void);
int64_t mmc_unmap(int64_t a1, int64_t a2, int64_t a3);
int64_t my_snprintf(int64_t * str, int64_t * size, char * format, int64_t a4, char * a5, int64_t a6);
int64_t name_compare(int64_t str, int64_t str2);
int64_t occasional(int64_t a1, int64_t a2);
int64_t panic(void);
int64_t really_clear_connection(int64_t a1, int64_t * a2, int64_t a3);
int64_t register_tm_clones(void);
int64_t scan_mon(int64_t * str, int64_t * a2);
int64_t scan_wday(int64_t * str, int64_t * a2);
int64_t send_authenticate(int64_t a1, int64_t a2);
int64_t send_err_file(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t * file_path);
int64_t send_mime(int64_t a1, int64_t a2, int64_t a3, int64_t * a4, int64_t str5, char * a6, int64_t a7, int64_t a8);
int64_t send_response(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t show_stats(int64_t a1, int64_t a2);
int64_t shut_down(int64_t a1, int64_t a2);
int64_t strlong_compare(int64_t str, int64_t str2);
int64_t tdate_parse(int64_t a1);
int64_t tmr_cancel(int64_t a1);
int64_t tmr_cleanup(void);
int64_t tmr_create(int32_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5);
int64_t tmr_init(int64_t a1, int64_t a2);
int64_t tmr_logstats(void);
int64_t tmr_mstimeout(int64_t * a1, int64_t a2, int64_t a3, int64_t a4);
int64_t tmr_reset(int64_t a1, int64_t a2);
int64_t tmr_run(int64_t * a1);
int64_t tmr_term(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);
int64_t tmr_timeout(int64_t a1, int64_t a2);
int64_t update_throttles(void);
int64_t usage(void);
int64_t wakeup_connection(int64_t a1);

// --------------------- Global Variables ---------------------

int32_t g1 = 0x7300656d; // 0x1000
int32_t g2 = 0x65730065; // 0x1001
int32_t * g3 = (int32_t *)-0xa6760000ac17; // 0x12030
int32_t g4 = 0x6362696c; // 0x12c0
int32_t * g5 = (int32_t *)-0x46a0000046be; // 0x12d70
int64_t g6 = -0x3ad900003ae1; // 0x12da0
int32_t * g7 = (int32_t *)-0x3054000030e3; // 0x12db0
int64_t g8 = -1; // 0x12e80
int32_t * g9 = (int32_t *)0x2710000026c; // 0x13280
char * g10; // 0x13553
int64_t g11 = 0x2d65676e6152003d; // 0x13618
int32_t g12 = 0x2000200; // 0x1387
int32_t g13 = 0x20002; // 0x1388
bool g14 = false; // 0x1389
int64_t g15 = 0xa2d2d213c002a; // 0x1393b
int64_t g16 = 0x6c33252073250040; // 0x150ca
int64_t g17 = 0x73253d5a54005a; // 0x153ed
int32_t * g18 = (int32_t *)0x1f00000000; // 0x15990
char * g20[6] = {
    "index.html",
    "index.htm",
    "index.xhtml",
    "index.xht",
    "Default.htm",
    "index.cgi"
}; // 0x18d70
char * g21[6] = {
    "GET",
    "HEAD",
    "POST",
    "PUT",
    "DELETE",
    "TRACE"
}; // 0x18da0
int64_t g22 = 0; // 0x18ff8
char * g25[2] = {
    "Request Timeout",
    "No request appeared within a reasonable time period.\n"
}; // 0x193b0
char (*g26)[54] = "No request appeared within a reasonable time period.\n"; // 0x193b8
int32_t g30 = 0; // 0x193d8
char (*g31)[9] = "compress"; // 0x193e0
int64_t g32 = 0; // 0x193e8
char (*g33)[3] = "gz"; // 0x193f0
int32_t g34 = 0; // 0x193f8
char (*g35)[5] = "gzip"; // 0x19400
int64_t g36 = 0; // 0x19408
char (*g37)[3] = "uu"; // 0x19410
int32_t g38 = 0; // 0x19418
char (*g39)[11] = "x-uuencode"; // 0x19420
int64_t g40 = 0; // 0x19428
int64_t * g41 = (int64_t *)"a"; // 0x19430
char (*g42)[13] = "audio/x-aiff"; // 0x194e0
char (*g43)[4] = "hdf"; // 0x19a10
int64_t g44 = 600; // 0x1ac80
char (*g45)[4] = "jan"; // 0x1ac90
char (*g46)[4] = "sun"; // 0x1ae00
int64_t g47 = 0; // 0x1aee0
int32_t g48 = 0; // 0x1aee8
char * g49; // 0x1aef0
int32_t g50 = 0; // 0x1aef8
int32_t g51 = 0; // 0x1aef9
int32_t g52 = 0; // 0x1aefc
int64_t g53 = 0; // 0x1af00
char * g54; // 0x1af08
char * g55; // 0x1af10
char * g56; // 0x1af18
char g57 = 0; // 0x1af20
char * g58; // 0x1af28
char g59 = 0; // 0x1af30
char * g60; // 0x1af38
int32_t g61 = 0; // 0x1af40
char g62 = 0; // 0x1af44
char * g63; // 0x1af48
int32_t g64 = 0; // 0x1af50
int32_t g65 = 0; // 0x1af54
int32_t g66 = 0; // 0x1af58
char * g67; // 0x1af60
int16_t g68 = 0; // 0x1af68
int64_t g69 = 0; // 0x1af70
int32_t g70 = 0; // 0x1af78
char * g71; // 0x1af80
char * g72; // 0x1af88
int32_t g73 = 0; // 0x1af90
char g74 = 0; // 0x1af94
char g75 = 0; // 0x1af98
char g76 = 0; // 0x1af9c
int64_t g77 = 0; // 0x1afa0
int64_t g78 = 0; // 0x1afa8
char g79 = 0; // 0x1afb0
int64_t g80 = 0; // 0x1afb8
int64_t g81 = 0; // 0x1afc0
int64_t g82 = 0; // 0x1afc8
int32_t g83 = 0; // 0x1afd0
int64_t g84 = 0; // 0x1afd8
int32_t g85 = 0; // 0x1afe0
int64_t g86 = 0; // 0x1afe8
int32_t g87 = 0; // 0x1aff0
int64_t g88 = 0; // 0x1aff3
int32_t g89 = 0; // 0x1aff4
int64_t g90 = 0; // 0x1aff5
int64_t g91 = 0; // 0x1aff7
int32_t g92 = 0; // 0x1aff8
int64_t g93 = 0; // 0x1aff9
char * g94; // 0x1b000
char g95 = 0; // 0x1b100
int32_t g96 = 0; // 0x1b104
int64_t g97 = 0; // 0x1b105
int32_t g98 = 0; // 0x1b108
char * g99; // 0x1b110
int32_t g100 = 0; // 0x1b113
char * g101; // 0x1b117
char * g102; // 0x1b1d8
int64_t g103 = 0; // 0x1b1e0
char * g104; // 0x1b1e8
char * g105; // 0x1b1f0
int64_t g106 = 0; // 0x1b1f8
int64_t g107 = 0; // 0x1b200
char * g108; // 0x1b208
int64_t g109 = 0; // 0x1b210
char * g110; // 0x1b218
int64_t g111 = 0; // 0x1b220
char * g112; // 0x1b228
int64_t g113 = 0; // 0x1b230
int64_t g114 = 0; // 0x1b238
int64_t g115 = 0; // 0x1b240
char * g116; // 0x1b248
int64_t g117 = 0; // 0x1b250
char * g118; // 0x1b258
int64_t g119 = 0; // 0x1b260
int64_t g120 = 0; // 0x1b268
char * g121; // 0x1b270
int64_t g122 = 0; // 0x1b278
char * g123; // 0x1b280
int64_t g124 = 0; // 0x1b288
int64_t g125 = 0; // 0x1b290
int64_t g126 = 0; // 0x1b298
char * g127; // 0x1b2a0
int64_t g128 = 0; // 0x1b2a8
int32_t g129 = 0; // 0x1b2b0
int64_t g130 = 0; // 0x1b2b8
int64_t g131 = 0; // 0x1b2c0
char * g132; // 0x1b2c8
int64_t g133 = 0; // 0x1b2d0
char * g134; // 0x1b2d8
int64_t g135 = 0; // 0x1b2e0
char * g136; // 0x1b2e8
int32_t g137 = 0; // 0x1b2f0
char * g138; // 0x1b300
int64_t g139 = 0; // 0x1b308
int64_t g140 = 0; // 0x1b310
char * g141; // 0x1b490
int64_t g142 = 0; // 0x1b498
int32_t g143 = 0; // 0x1b4a0
int32_t g144 = 0; // 0x1b4a8
int64_t g145 = 0; // 0x1b4b0
int64_t g146 = 0; // 0x1b4b8
int32_t g147 = 0; // 0x1b4c0
int32_t g148 = 0; // 0x1b4c4
int32_t g149 = 0; // 0x1b4c5
struct pollfd * g150 = NULL; // 0x1b4c8
int64_t g151 = 0; // 0x1b4d0
int64_t g152 = 0; // 0x1b4d8
int32_t g153 = 0; // 0x1b4df
int32_t g154 = 0; // 0x1b4e0
int32_t g155 = 0; // 0x1b4e1
int64_t g156 = 0; // 0x1b4e8
int32_t * g157 = NULL; // 0x1b4f0
int32_t g158 = 0; // 0x1b4f1
int32_t g159 = 0; // 0x1b4f3
int32_t g160 = 0; // 0x1b4f4
int64_t g161 = 0; // 0x1b4f8
int64_t g162 = 0; // 0x1b4ff
int32_t g163 = 0; // 0x1b500
int64_t g164 = 0; // 0x1b501
int64_t g165 = 0; // 0x1b508
int32_t g166 = 0; // 0x1b510
int64_t g167 = 0; // 0x1b518
int32_t g168 = 0; // 0x1b520
int64_t g169 = 0; // 0x1b530
int64_t g170 = 0; // 0x1b748
int32_t g171 = 0; // 0x1b74f
int32_t * g172 = NULL; // 0x1b750
int64_t g173 = 0; // 0x1b751
int64_t g174 = 0; // 0x1b753
int32_t g175 = 0; // 0x1b754
int64_t g176 = 0; // 0x1b755
int32_t g177 = 0; // 0x1b757
int32_t g178 = 0; // 0x1b758
int64_t g179 = 0; // 0x1b760
int64_t g180 = 0; // 0x1b768
int32_t g181 = 0; // 0x1b770
char g182 = 0; // 0x1b778
int64_t g183; // 0x1b77c
bool g184 = false; // 0x1c1f
int32_t g186 = 1; // 0x2002
int64_t g187 = 0x19a3000000000; // 0x202c
int32_t g188 = 8; // 0x2710
int32_t g189 = 0x696c2d64; // 0x320
char (*g190)[5] = "imit"; // 0x3e3
int32_t g191 = 0; // 0x3e7
int64_t g192 = 0; // 0x3e8
bool g193 = false; // 0x3e9
int32_t g194 = 0; // 0x3ff
int32_t g195 = 0; // 0x400
int64_t g196 = 5; // 0x4004
int128_t g197; // 0x4b0
int64_t g198 = 0; // 0x708
int32_t g199 = 0; // 0x76c
int32_t g200 = -0x1a000000; // 0x76d
int64_t g201 = 0x120000009f; // 0x7d0
int32_t g202 = 251; // 0x800
int64_t g203 = 0x120000004d000000; // 0xa0d
int32_t g204;
char (**g19)[13] = &g42; // 0x1838
char * g23[7] = {
    "Bad Request",
    "Your request has bad syntax or is inherently impossible to satisfy.\n",
    "Request Timeout",
    "No request appeared within a reasonable time period.\n",
    "Service Temporarily Overloaded",
    "The requested URL '%.80s' is temporarily overloaded.  Please try again later.\n",
    (char *)&g17
}; // 0x193a0
char * g24[6] = {
    "Your request has bad syntax or is inherently impossible to satisfy.\n",
    "Request Timeout",
    "No request appeared within a reasonable time period.\n",
    "Service Temporarily Overloaded",
    "The requested URL '%.80s' is temporarily overloaded.  Please try again later.\n",
    (char *)&g17
}; // 0x193a8
char * g27[3] = {
    "Service Temporarily Overloaded",
    "The requested URL '%.80s' is temporarily overloaded.  Please try again later.\n",
    (char *)&g17
}; // 0x193c0
char * g28[2] = {
    "The requested URL '%.80s' is temporarily overloaded.  Please try again later.\n",
    (char *)&g17
}; // 0x193c8
int64_t * g29 = &g17; // 0x193d0
char (**g185)[4] = &g43; // 0x2000

// ------- Dynamically Linked Functions Without Header --------

void __cxa_finalize(int64_t * a1);
void __gmon_start__(void);
int32_t __libc_start_main(int64_t a1, int32_t a2, char ** a3, void (*a4)(), void (*a5)(), void (*a6)());
char * crypt(char * a1, char * a2);
void (*sigset(int32_t a1, void (*a2)(int32_t)))(int32_t);

// ------------------------ Functions -------------------------

// Address range: 0x5000 - 0x501b
int64_t _init(void) {
    int64_t result = 0; // 0x5012
    if (*(int64_t *)0x18fe0 != 0) {
        // 0x5014
        __gmon_start__();
        result = &g204;
    }
    // 0x5016
    return result;
}

// Address range: 0x5030 - 0x5036
char * function_5030(char * name) {
    // 0x5030
    return getenv(name);
}

// Address range: 0x5040 - 0x5046
void function_5040(int64_t * ptr) {
    // 0x5040
    free(ptr);
}

// Address range: 0x5050 - 0x5056
int32_t function_5050(char * s1, char * s2) {
    // 0x5050
    return strcasecmp(s1, s2);
}

// Address range: 0x5060 - 0x5066
void function_5060(void) {
    // 0x5060
    closelog();
}

// Address range: 0x5070 - 0x5076
struct tm * function_5070(int32_t * timer) {
    // 0x5070
    return localtime(timer);
}

// Address range: 0x5080 - 0x5086
void function_5080(void) {
    // 0x5080
    abort();
}

// Address range: 0x5090 - 0x5096
int32_t * function_5090(void) {
    // 0x5090
    return __errno_location();
}

// Address range: 0x50a0 - 0x50a6
char * function_50a0(char * dest, char * src, int32_t n) {
    // 0x50a0
    return strncpy(dest, src, n);
}

// Address range: 0x50b0 - 0x50b6
int32_t function_50b0(char * s1, char * s2, int32_t n) {
    // 0x50b0
    return strncmp(s1, s2, n);
}

// Address range: 0x50c0 - 0x50c6
void function_50c0(int32_t status) {
    // 0x50c0
    _exit(status);
}

// Address range: 0x50d0 - 0x50d6
char * function_50d0(char * dest, char * src) {
    // 0x50d0
    return strcpy(dest, src);
}

// Address range: 0x50e0 - 0x50e6
int32_t function_50e0(char * path) {
    // 0x50e0
    return chroot(path);
}

// Address range: 0x50f0 - 0x50f6
int32_t function_50f0(int32_t fd, struct iovec * iovec, int32_t count) {
    // 0x50f0
    return writev(fd, iovec, count);
}

// Address range: 0x5100 - 0x5106
int32_t function_5100(char * s) {
    // 0x5100
    return puts(s);
}

// Address range: 0x5110 - 0x5116
void function_5110(int64_t * base, int32_t nmemb, int32_t size, int32_t (*compar)(int64_t *, int64_t *)) {
    // 0x5110
    qsort(base, nmemb, size, compar);
}

// Address range: 0x5120 - 0x5126
int32_t function_5120(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * stream) {
    // 0x5120
    return fread(ptr, size, n, stream);
}

// Address range: 0x5130 - 0x5136
int32_t function_5130(char * s, int32_t maxlen, char * format, int64_t arg) {
    // 0x5130
    return vsnprintf(s, maxlen, format, arg);
}

// Address range: 0x5140 - 0x5146
int32_t function_5140(int32_t fd, int32_t level, int32_t optname, int64_t * optval, int32_t optlen) {
    // 0x5140
    return setsockopt(fd, level, optname, optval, optlen);
}

// Address range: 0x5150 - 0x5156
int32_t function_5150(char * path, char * buf, int32_t len) {
    // 0x5150
    return readlink(path, buf, len);
}

// Address range: 0x5160 - 0x5166
int32_t function_5160(int32_t fd, int32_t cmd, ...) {
    // 0x5160
    return fcntl(fd, cmd);
}

// Address range: 0x5170 - 0x5176
int32_t function_5170(int32_t fd, int64_t * buf, int32_t n) {
    // 0x5170
    return write(fd, buf, n);
}

// Address range: 0x5180 - 0x5186
int32_t function_5180(void) {
    // 0x5180
    return getpid();
}

// Address range: 0x5190 - 0x5196
int32_t function_5190(struct _IO_FILE * stream) {
    // 0x5190
    return fclose(stream);
}

// Address range: 0x51a0 - 0x51a6
struct __dirstream * function_51a0(char * name) {
    // 0x51a0
    return opendir(name);
}

// Address range: 0x51b0 - 0x51b6
char * function_51b0(int32_t * timer) {
    // 0x51b0
    return ctime(timer);
}

// Address range: 0x51c0 - 0x51c6
int32_t function_51c0(int32_t fd, int32_t how) {
    // 0x51c0
    return shutdown(fd, how);
}

// Address range: 0x51d0 - 0x51d6
int32_t function_51d0(char * s) {
    // 0x51d0
    return strlen(s);
}

// Address range: 0x51e0 - 0x51e6
int32_t function_51e0(char * path) {
    // 0x51e0
    return chdir(path);
}

// Address range: 0x51f0 - 0x51f6
int32_t function_51f0(void) {
    // 0x51f0
    return getuid();
}

// Address range: 0x5200 - 0x5206
int64_t * function_5200(int64_t * addr, int32_t len, int32_t prot, int32_t flags, int32_t fd, int32_t offset) {
    // 0x5200
    return mmap(addr, len, prot, flags, fd, offset);
}

// Address range: 0x5210 - 0x5216
int32_t function_5210(int32_t fd, int32_t fd2) {
    // 0x5210
    return dup2(fd, fd2);
}

// Address range: 0x5220 - 0x5226
char * function_5220(char * s, int32_t c) {
    // 0x5220
    return strchr(s, c);
}

// Address range: 0x5230 - 0x5236
int32_t function_5230(char * s, int32_t maxlen, char * format, ...) {
    // 0x5230
    return snprintf(s, maxlen, format);
}

// Address range: 0x5240 - 0x5246
char * function_5240(int32_t ecode) {
    // 0x5240
    return gai_strerror(ecode);
}

// Address range: 0x5250 - 0x5256
char * function_5250(char * s, int32_t c) {
    // 0x5250
    return strrchr(s, c);
}

// Address range: 0x5260 - 0x5266
int32_t function_5260(struct timeval * tv, struct timezone * tz) {
    // 0x5260
    return gettimeofday(tv, tz);
}

// Address range: 0x5270 - 0x5276
int64_t * function_5270(int64_t * s, int32_t c, int32_t n) {
    // 0x5270
    return memset(s, c, n);
}

// Address range: 0x5280 - 0x5286
char * function_5280(char * buf, int32_t size) {
    // 0x5280
    return getcwd(buf, size);
}

// Address range: 0x5290 - 0x5296
int32_t function_5290(int32_t seconds) {
    // 0x5290
    return alarm(seconds);
}

// Address range: 0x52a0 - 0x52a6
int32_t function_52a0(int32_t fd) {
    // 0x52a0
    return close(fd);
}

// Address range: 0x52b0 - 0x52b6
int32_t function_52b0(int32_t n, int32_t * groups) {
    // 0x52b0
    return setgroups(n, groups);
}

// Address range: 0x52c0 - 0x52c6
int32_t function_52c0(int32_t pipedes[2]) {
    // 0x52c0
    return pipe(pipedes);
}

// Address range: 0x52d0 - 0x52d6
int32_t function_52d0(struct sockaddr * sa, int32_t salen, char * host, int32_t hostlen, char * serv, int32_t servlen, int32_t flags) {
    // 0x52d0
    return getnameinfo(sa, salen, host, hostlen, serv, servlen, flags);
}

// Address range: 0x52e0 - 0x52e6
int32_t function_52e0(void) {
    // 0x52e0
    return setsid();
}

// Address range: 0x52f0 - 0x52f6
int32_t function_52f0(char * s, char * accept2) {
    // 0x52f0
    return strspn(s, accept2);
}

// Address range: 0x5300 - 0x5306
int32_t function_5300(struct __dirstream * dirp) {
    // 0x5300
    return closedir(dirp);
}

// Address range: 0x5310 - 0x5316
int32_t function_5310(char * s, char * reject) {
    // 0x5310
    return strcspn(s, reject);
}

// Address range: 0x5320 - 0x5326
int64_t * function_5320(int64_t * s, int32_t c, int32_t n) {
    // 0x5320
    return memchr(s, c, n);
}

// Address range: 0x5330 - 0x5336
int32_t function_5330(int32_t fd, int64_t * buf, int32_t nbytes) {
    // 0x5330
    return read(fd, buf, nbytes);
}

// Address range: 0x5340 - 0x5346
int32_t function_5340(char * file, struct stat * buf) {
    // 0x5340
    return lstat(file, buf);
}

// Address range: 0x5350 - 0x5356
char * function_5350(char * s, int32_t n, struct _IO_FILE * stream) {
    // 0x5350
    return fgets(s, n, stream);
}

// Address range: 0x5360 - 0x5366
int32_t function_5360(char * path, char * argv[1], char * envp[1]) {
    // 0x5360
    return execve(path, argv, envp);
}

// Address range: 0x5370 - 0x5376
int32_t function_5370(char * s1, char * s2) {
    // 0x5370
    return strcmp(s1, s2);
}

// Address range: 0x5380 - 0x5386
int64_t function_5380(char * nptr, char ** endptr, int32_t base) {
    // 0x5380
    return strtoll(nptr, endptr, base);
}

// Address range: 0x5390 - 0x5396
struct passwd * function_5390(char * name) {
    // 0x5390
    return getpwnam(name);
}

// Address range: 0x53a0 - 0x53a6
int32_t function_53a0(struct _IO_FILE * stream, char * format, ...) {
    // 0x53a0
    return fprintf(stream, format);
}

// Address range: 0x53b0 - 0x53b6
int32_t function_53b0(char * file, struct stat * buf) {
    // 0x53b0
    return stat(file, buf);
}

// Address range: 0x53c0 - 0x53c6
int32_t function_53c0(char * nptr, char ** endptr, int32_t base) {
    // 0x53c0
    return strtol(nptr, endptr, base);
}

// Address range: 0x53d0 - 0x53d6
int64_t * function_53d0(int64_t * dest, int64_t * src, int32_t n) {
    // 0x53d0
    return memcpy(dest, src, n);
}

// Address range: 0x53e0 - 0x53e6
void function_53e0(void) {
    // 0x53e0
    tzset();
}

// Address range: 0x53f0 - 0x53f6
int32_t function_53f0(int32_t pid, int32_t sig) {
    // 0x53f0
    return kill(pid, sig);
}

// Address range: 0x5400 - 0x5406
int32_t function_5400(int32_t * timer) {
    // 0x5400
    return time(timer);
}

// Address range: 0x5410 - 0x5416
int32_t function_5410(struct _IO_FILE * stream) {
    // 0x5410
    return fileno(stream);
}

// Address range: 0x5420 - 0x5426
struct dirent * function_5420(struct __dirstream * dirp) {
    // 0x5420
    return readdir(dirp);
}

// Address range: 0x5430 - 0x5436
int64_t * function_5430(int32_t size) {
    // 0x5430
    return malloc(size);
}

// Address range: 0x5440 - 0x5446
int32_t function_5440(char * s1, char * s2, int32_t n) {
    // 0x5440
    return strncasecmp(s1, s2, n);
}

// Address range: 0x5450 - 0x5456
int32_t function_5450(struct _IO_FILE * stream) {
    // 0x5450
    return fflush(stream);
}

// Address range: 0x5460 - 0x5466
int32_t function_5460(int32_t inc) {
    // 0x5460
    return nice(inc);
}

// Address range: 0x5470 - 0x5476
int32_t function_5470(char * s, char * format, ...) {
    // 0x5470
    return sscanf(s, format);
}

// Address range: 0x5480 - 0x5486
void function_5480(int32_t pri, char * fmt, ...) {
    // 0x5480
    syslog(pri, fmt);
}

// Address range: 0x5490 - 0x5496
int32_t function_5490(int32_t fd, int32_t n) {
    // 0x5490
    return listen(fd, n);
}

// Address range: 0x54a0 - 0x54a6
int32_t function_54a0(int32_t nochdir, int32_t noclose) {
    // 0x54a0
    return daemon(nochdir, noclose);
}

// Address range: 0x54b0 - 0x54b6
char * function_54b0(char * s, char * accept2) {
    // 0x54b0
    return strpbrk(s, accept2);
}

// Address range: 0x54c0 - 0x54c6
int32_t function_54c0(int64_t resource, struct rlimit * rlimits) {
    // 0x54c0
    return setrlimit(resource, rlimits);
}

// Address range: 0x54d0 - 0x54d6
int64_t * function_54d0(int64_t * ptr, int32_t size) {
    // 0x54d0
    return realloc(ptr, size);
}

// Address range: 0x54e0 - 0x54e6
struct _IO_FILE * function_54e0(int32_t fd, char * modes) {
    // 0x54e0
    return fdopen(fd, modes);
}

// Address range: 0x54f0 - 0x54f6
int32_t function_54f0(int64_t * addr, int32_t len) {
    // 0x54f0
    return munmap(addr, len);
}

// Address range: 0x5500 - 0x5506
int32_t function_5500(struct pollfd * fds, int32_t nfds, int32_t timeout) {
    // 0x5500
    return poll(fds, nfds, timeout);
}

// Address range: 0x5510 - 0x5516
int32_t function_5510(int32_t fd, struct sockaddr * addr, int32_t len) {
    // 0x5510
    return bind(fd, addr, len);
}

// Address range: 0x5520 - 0x5526
void (*function_5520(int32_t sig, void (*disp)(int32_t)))(int32_t) {
    // 0x5520
    return sigset(sig, disp);
}

// Address range: 0x5530 - 0x5536
int32_t function_5530(char * s, int32_t maxsize, char * format, struct tm * tp) {
    // 0x5530
    return strftime(s, maxsize, format, tp);
}

// Address range: 0x5540 - 0x5546
int64_t * function_5540(int64_t * dest, int64_t * src, int32_t n) {
    // 0x5540
    return memmove(dest, src, n);
}

// Address range: 0x5550 - 0x5556
int32_t function_5550(int32_t gid) {
    // 0x5550
    return setgid(gid);
}

// Address range: 0x5560 - 0x5566
int32_t function_5560(int32_t pid, int32_t * stat_loc, int32_t options) {
    // 0x5560
    return waitpid(pid, stat_loc, options);
}

// Address range: 0x5570 - 0x5576
int32_t function_5570(char * file, int32_t oflag, ...) {
    // 0x5570
    return open(file, oflag);
}

// Address range: 0x5580 - 0x5586
int32_t function_5580(int32_t fd, int32_t owner, int32_t group) {
    // 0x5580
    return fchown(fd, owner, group);
}

// Address range: 0x5590 - 0x5596
struct _IO_FILE * function_5590(char * filename, char * modes) {
    // 0x5590
    return fopen(filename, modes);
}

// Address range: 0x55a0 - 0x55a6
void function_55a0(char * s) {
    // 0x55a0
    perror(s);
}

// Address range: 0x55b0 - 0x55b6
struct tm * function_55b0(int32_t * timer) {
    // 0x55b0
    return gmtime(timer);
}

// Address range: 0x55c0 - 0x55c6
int32_t function_55c0(int32_t fd, struct sockaddr * addr, int32_t * addr_len) {
    // 0x55c0
    return accept(fd, addr, addr_len);
}

// Address range: 0x55d0 - 0x55d6
int32_t function_55d0(int32_t fd, struct sockaddr * addr, int32_t * len) {
    // 0x55d0
    return getsockname(fd, addr, len);
}

// Address range: 0x55e0 - 0x55e6
char * function_55e0(char * dest, char * src) {
    // 0x55e0
    return strcat(dest, src);
}

// Address range: 0x55f0 - 0x55f6
void function_55f0(char * ident, int32_t option, int32_t facility) {
    // 0x55f0
    openlog(ident, option, facility);
}

// Address range: 0x5600 - 0x5606
int32_t function_5600(char * name, int32_t len) {
    // 0x5600
    return gethostname(name, len);
}

// Address range: 0x5610 - 0x5616
int32_t function_5610(char * s, char * format, ...) {
    // 0x5610
    return sprintf(s, format);
}

// Address range: 0x5620 - 0x5626
void function_5620(int32_t status) {
    // 0x5620
    exit(status);
}

// Address range: 0x5630 - 0x5636
int32_t function_5630(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s) {
    // 0x5630
    return fwrite(ptr, size, n, s);
}

// Address range: 0x5640 - 0x5646
int32_t function_5640(int64_t resource, struct rlimit * rlimits) {
    // 0x5640
    return getrlimit(resource, rlimits);
}

// Address range: 0x5650 - 0x5656
int32_t function_5650(int32_t uid) {
    // 0x5650
    return setuid(uid);
}

// Address range: 0x5660 - 0x5666
int32_t function_5660(char * name, char * service, struct addrinfo * req, struct addrinfo ** pai) {
    // 0x5660
    return getaddrinfo(name, service, req, pai);
}

// Address range: 0x5670 - 0x5676
char * function_5670(char * s) {
    // 0x5670
    return strdup(s);
}

// Address range: 0x5680 - 0x5686
int32_t function_5680(char * user, int32_t group) {
    // 0x5680
    return initgroups(user, group);
}

// Address range: 0x5690 - 0x5696
char * function_5690(char * key, char * salt) {
    // 0x5690
    return crypt(key, salt);
}

// Address range: 0x56a0 - 0x56a6
int32_t function_56a0(int32_t seconds) {
    // 0x56a0
    return sleep(seconds);
}

// Address range: 0x56b0 - 0x56b6
int32_t function_56b0(void) {
    // 0x56b0
    return fork();
}

// Address range: 0x56c0 - 0x56c6
char * function_56c0(char * haystack, char * needle) {
    // 0x56c0
    return strstr(haystack, needle);
}

// Address range: 0x56d0 - 0x56d6
int32_t function_56d0(void) {
    // 0x56d0
    return getdtablesize();
}

// Address range: 0x56e0 - 0x56e6
int32_t ** function_56e0(void) {
    // 0x56e0
    return __ctype_tolower_loc();
}

// Address range: 0x56f0 - 0x56f6
int16_t ** function_56f0(void) {
    // 0x56f0
    return __ctype_b_loc();
}

// Address range: 0x5700 - 0x5706
void function_5700(struct addrinfo * ai) {
    // 0x5700
    freeaddrinfo(ai);
}

// Address range: 0x5710 - 0x5716
int32_t function_5710(int32_t domain, int32_t type, int32_t protocol) {
    // 0x5710
    return socket(domain, type, protocol);
}

// Address range: 0x5720 - 0x5726
void function_5720(int64_t * d) {
    // 0x5720
    __cxa_finalize(d);
}

// Address range: 0x5730 - 0x5756
int64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    // 0x5730
    int64_t v1; // 0x5730
    __libc_start_main(0x5820, (int32_t)a6, (char **)&v1, NULL, NULL, (void (*)())a3);
    __asm_hlt();
    // UNREACHABLE
}

// Address range: 0x5760 - 0x5789
int64_t deregister_tm_clones(void) {
    // 0x5760
    return &g47;
}

// Address range: 0x5790 - 0x57c9
int64_t register_tm_clones(void) {
    // 0x5790
    return 0;
}

// Address range: 0x57d0 - 0x5809
int64_t __do_global_dtors_aux(void) {
    // 0x57d0
    if (*(char *)&g47 != 0) {
        // 0x5808
        int64_t result; // 0x57d0
        return result;
    }
    // 0x57dd
    if (*(int64_t *)0x18ff0 != 0) {
        // 0x57eb
        __cxa_finalize((int64_t *)*(int64_t *)0x19398);
    }
    int64_t result2 = deregister_tm_clones(); // 0x57f7
    *(char *)&g47 = 1;
    return result2;
}

// Address range: 0x5810 - 0x5819
int64_t frame_dummy(void) {
    // 0x5810
    return register_tm_clones();
}

// Address range: 0x5820 - 0x7e71
int main(int argc, char ** argv) {
    // 0x5820
    int128_t v1; // 0x5820
    int128_t v2 = v1;
    char ** v3; // bp-15368, 0x5820
    int64_t v4 = (int64_t)&v3; // 0x582a
    v3 = argv;
    g49 = (char *)argv;
    char * found_char_pos = strrchr((char *)argv, 47); // 0x5849
    int64_t ident = found_char_pos == NULL ? (int64_t)argv : (int64_t)found_char_pos + 1; // 0x5855
    openlog((char *)ident, LOG_PID | LOG_NDELAY, LOG_DAEMON);
    g59 = 0;
    g68 = 80;
    g58 = NULL;
    g63 = NULL;
    g62 = 0;
    g57 = 0;
    g74 = 0;
    g75 = 0;
    g76 = 0;
    g69 = 0;
    g70 = 0;
    g77 = 0;
    g79 = 0;
    g78 = 0;
    g54 = NULL;
    g67 = NULL;
    g56 = NULL;
    g60 = NULL;
    g55 = "nobody";
    g71 = "UTF-8";
    g72 = (char *)&g10;
    g73 = -1;
    int32_t v5 = argc; // 0x594f
    int64_t v6 = 1; // 0x594f
    char * str11; // 0x5820
    char * v7; // 0x5820
    int64_t v8; // 0x5820
    int64_t v9; // 0x5820
    int64_t v10; // 0x5820
    int64_t v11; // 0x5820
    int64_t v12; // 0x5820
    int64_t format3; // 0x5820
    int64_t format2; // 0x5820
    int64_t str5; // bp-15048, 0x5820
    int64_t v13; // 0x5820
    char * str3; // 0x599e
    char * str6; // 0x5820
    if (v5 >= 2) {
        // 0x5993
        v9 = 1;
        while (true) {
          lab_0x5993:
            // 0x5993
            v10 = v9;
            int64_t v14 = *(int64_t *)((0x100000000 * v10 >> 29) + (int64_t)v3); // 0x599a
            str3 = (char *)v14;
            v6 = v10;
            if (*str3 != 45) {
                // break -> 0x64bc
                break;
            }
            // 0x59a7
            if (strcmp(str3, "-V") == 0) {
                // 0x7c82
                puts("thttpd/2.29 23May2018");
                exit((int32_t)"thttpd/2.29 23May2018" ^ (int32_t)"thttpd/2.29 23May2018");
                // UNREACHABLE
            }
            // 0x59be
            if (strcmp(str3, "-C") != 0) {
                goto lab_0x6110;
            } else {
                int64_t v15 = v10 + 1; // 0x59d5
                if ((int32_t)v15 < v5) {
                    int64_t file_path = *(int64_t *)((0x100000000 * v15 >> 29) + (int64_t)v3); // 0x59ec
                    struct _IO_FILE * file = fopen((char *)file_path, "r"); // 0x59fa
                    int64_t str4 = file_path; // 0x5a02
                    if (file == NULL) {
                        // 0x68b1
                        perror((char *)str4);
                        exit(1);
                        // UNREACHABLE
                    }
                    // 0x5a08
                    if (fgets((char *)&str5, (int32_t)&g188, file) != NULL) {
                        while (true) {
                            char * found_char_pos2 = strchr((char *)&str5, 35); // 0x5a6a
                            if (found_char_pos2 != NULL) {
                                // 0x5a74
                                *found_char_pos2 = 0;
                            }
                            int64_t v16 = v4 + 320 + (int64_t)strspn((char *)&str5, " \t\n\r");
                            v11 = v16;
                            if (*(char *)v16 != 0) {
                                while (true) {
                                  lab_0x5acf:
                                    // 0x5acf
                                    str6 = (char *)v11;
                                    int64_t v17 = v11 + (int64_t)strcspn(str6, " \t\n\r"); // 0x5add
                                    char * v18 = (char *)v17; // 0x5ae0
                                    unsigned char v19 = *v18; // 0x5ae0
                                    char v20 = v19; // 0x5ae7
                                    char * v21 = v18; // 0x5ae7
                                    int64_t v22 = v17; // 0x5ae7
                                    int64_t v23 = v17; // 0x5ae7
                                    char * v24 = v18; // 0x5ae7
                                    if (v19 < 33) {
                                        int64_t v25 = v22;
                                        char * v26 = v21;
                                        v23 = v25;
                                        v24 = v26;
                                        while ((1 << (int64_t)(v20 % 64) & 0x100002600) != 0) {
                                            // 0x5aef
                                            *v26 = 0;
                                            int64_t v27 = v25 + 1; // 0x5af2
                                            char * v28 = (char *)v27;
                                            unsigned char v29 = *v28; // 0x5ae0
                                            v20 = v29;
                                            v21 = v28;
                                            v22 = v27;
                                            v23 = v27;
                                            v24 = v28;
                                            if (v29 >= 33) {
                                                // break -> 0x5b00
                                                break;
                                            }
                                            v25 = v22;
                                            v26 = v21;
                                            v23 = v25;
                                            v24 = v26;
                                        }
                                    }
                                    // 0x5b00
                                    str11 = v24;
                                    v13 = v23;
                                    char * found_char_pos3 = strchr(str6, 61); // 0x5b08
                                    if (found_char_pos3 == NULL) {
                                        // 0x5c50
                                        if (strcasecmp(str6, "debug") == 0) {
                                            // 0x5ee5
                                            g59 = 1;
                                            goto lab_0x5ab6;
                                        } else {
                                            int32_t v30 = strcasecmp(str6, "port"); // 0x5c6d
                                            v7 = str6;
                                            format3 = (int64_t)"%s: value required for %s option\n";
                                            if (v30 == 0) {
                                                goto lab_0x7003_26;
                                            }
                                            int32_t v31 = strcasecmp(str6, "dir"); // 0x5c84
                                            v7 = str6;
                                            format3 = (int64_t)"%s: value required for %s option\n";
                                            if (v31 == 0) {
                                                goto lab_0x7003_26;
                                            }
                                            // 0x5c91
                                            if (strcasecmp(str6, "chroot") == 0) {
                                                // 0x5f0e
                                                g62 = 1;
                                                g74 = 1;
                                                goto lab_0x5ab6;
                                            } else {
                                                // 0x5ca8
                                                if (strcasecmp(str6, "nochroot") == 0) {
                                                    // 0x5f3e
                                                    g62 = 0;
                                                    // 0x5f45
                                                    g74 = 0;
                                                    goto lab_0x5ab6;
                                                } else {
                                                    int32_t v32 = strcasecmp(str6, "data_dir"); // 0x5cc9
                                                    v7 = str6;
                                                    format3 = (int64_t)"%s: value required for %s option\n";
                                                    if (v32 == 0) {
                                                        goto lab_0x7003_26;
                                                    }
                                                    // 0x5cd6
                                                    if (strcasecmp(str6, "nosymlinkcheck") == 0) {
                                                        // 0x5f83
                                                        g74 = 1;
                                                        goto lab_0x5ab6;
                                                    } else {
                                                        // 0x5ced
                                                        if (strcasecmp(str6, "symlinkcheck") == 0) {
                                                            // 0x5f45
                                                            g74 = 0;
                                                            goto lab_0x5ab6;
                                                        } else {
                                                            int32_t v33 = strcasecmp(str6, "user"); // 0x5d0e
                                                            v7 = str6;
                                                            format3 = (int64_t)"%s: value required for %s option\n";
                                                            if (v33 == 0) {
                                                                goto lab_0x7003_26;
                                                            }
                                                            int32_t v34 = strcasecmp(str6, "cgipat"); // 0x5d25
                                                            v7 = str6;
                                                            format3 = (int64_t)"%s: value required for %s option\n";
                                                            if (v34 == 0) {
                                                                goto lab_0x7003_26;
                                                            }
                                                            int32_t v35 = strcasecmp(str6, "cgilimit"); // 0x5d3c
                                                            v7 = str6;
                                                            format3 = (int64_t)"%s: value required for %s option\n";
                                                            if (v35 == 0) {
                                                                goto lab_0x7003_26;
                                                            }
                                                            int32_t v36 = strcasecmp(str6, "urlpat"); // 0x5d53
                                                            v8 = 0;
                                                            v7 = str6;
                                                            format3 = (int64_t)"%s: value required for %s option\n";
                                                            if (v36 == 0) {
                                                                goto lab_0x7003_26;
                                                            }
                                                            goto lab_0x5d63;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    } else {
                                        // 0x5b16
                                        *found_char_pos3 = 0;
                                        int32_t v37 = strcasecmp(str6, "debug"); // 0x5b22
                                        v7 = str6;
                                        format3 = (int64_t)"%s: no value required for %s option\n";
                                        if (v37 == 0) {
                                            goto lab_0x7003_26;
                                        }
                                        int64_t str7 = (int64_t)found_char_pos3 + 1; // 0x5b2f
                                        if (strcasecmp(str6, "port") == 0) {
                                            // 0x5aa0
                                            g68 = strtol((char *)str7, NULL, 10);
                                            goto lab_0x5ab6;
                                        } else {
                                            // 0x5b4a
                                            if (strcasecmp(str6, "dir") == 0) {
                                                char * v38 = strdup((char *)str7); // 0x5ecb
                                                if (v38 == NULL) {
                                                    // 0x706f
                                                    syslog(LOG_CRIT, "out of memory copying a string");
                                                    format2 = (int64_t)"%s: out of memory copying a string\n";
                                                    goto lab_0x709a;
                                                }
                                                // 0x5ed9
                                                g58 = v38;
                                                goto lab_0x5ab6;
                                            } else {
                                                int32_t v39 = strcasecmp(str6, "chroot"); // 0x5b6b
                                                v7 = str6;
                                                format3 = (int64_t)"%s: no value required for %s option\n";
                                                if (v39 == 0) {
                                                    goto lab_0x7003_26;
                                                }
                                                int32_t v40 = strcasecmp(str6, "nochroot"); // 0x5b82
                                                v7 = str6;
                                                format3 = (int64_t)"%s: no value required for %s option\n";
                                                if (v40 == 0) {
                                                    goto lab_0x7003_26;
                                                }
                                                // 0x5b8f
                                                if (strcasecmp(str6, "data_dir") == 0) {
                                                    char * v41 = strdup((char *)str7); // 0x5ef4
                                                    if (v41 == NULL) {
                                                        // 0x706f
                                                        syslog(LOG_CRIT, "out of memory copying a string");
                                                        format2 = (int64_t)"%s: out of memory copying a string\n";
                                                        goto lab_0x709a;
                                                    }
                                                    // 0x5f02
                                                    g63 = v41;
                                                    goto lab_0x5ab6;
                                                } else {
                                                    int32_t v42 = strcasecmp(str6, "nosymlinkcheck"); // 0x5bb0
                                                    v7 = str6;
                                                    format3 = (int64_t)"%s: no value required for %s option\n";
                                                    if (v42 == 0) {
                                                        goto lab_0x7003_26;
                                                    }
                                                    int32_t v43 = strcasecmp(str6, "symlinkcheck"); // 0x5bc7
                                                    v7 = str6;
                                                    format3 = (int64_t)"%s: no value required for %s option\n";
                                                    if (v43 == 0) {
                                                        goto lab_0x7003_26;
                                                    }
                                                    // 0x5bd4
                                                    if (strcasecmp(str6, "user") == 0) {
                                                        char * v44 = strdup((char *)str7); // 0x5f24
                                                        if (v44 == NULL) {
                                                            // 0x706f
                                                            syslog(LOG_CRIT, "out of memory copying a string");
                                                            format2 = (int64_t)"%s: out of memory copying a string\n";
                                                            goto lab_0x709a;
                                                        }
                                                        // 0x5f32
                                                        g55 = v44;
                                                        goto lab_0x5ab6;
                                                    } else {
                                                        // 0x5beb
                                                        if (strcasecmp(str6, "cgipat") == 0) {
                                                            char * v45 = strdup((char *)str7); // 0x5f69
                                                            if (v45 == NULL) {
                                                                // 0x706f
                                                                syslog(LOG_CRIT, "out of memory copying a string");
                                                                format2 = (int64_t)"%s: out of memory copying a string\n";
                                                                goto lab_0x709a;
                                                            }
                                                            // 0x5f77
                                                            g69 = (int64_t)v45;
                                                            goto lab_0x5ab6;
                                                        } else {
                                                            // 0x5c02
                                                            if (strcasecmp(str6, "cgilimit") == 0) {
                                                                // 0x5f8f
                                                                g70 = strtol((char *)str7, NULL, 10);
                                                                goto lab_0x5ab6;
                                                            } else {
                                                                // 0x5c19
                                                                v8 = str7;
                                                                if (strcasecmp(str6, "urlpat") != 0) {
                                                                    goto lab_0x5d63;
                                                                } else {
                                                                    char * v46 = strdup((char *)str7); // 0x5c33
                                                                    if (v46 == NULL) {
                                                                        // 0x706f
                                                                        syslog(LOG_CRIT, "out of memory copying a string");
                                                                        format2 = (int64_t)"%s: out of memory copying a string\n";
                                                                        goto lab_0x709a;
                                                                    }
                                                                    // 0x5c41
                                                                    g77 = (int64_t)v46;
                                                                    goto lab_0x5ab6;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                          lab_0x5a40:
                            // 0x5a40
                            if (fgets((char *)&str5, (int32_t)&g188, file) == NULL) {
                                // break -> 0x5a2d
                                break;
                            }
                        }
                    }
                    // 0x5a2d
                    fclose(file);
                    v12 = v15 & 0xffffffff;
                    goto lab_0x5984;
                } else {
                    goto lab_0x6110;
                }
            }
        }
    }
  lab_0x64bc:
    // 0x64bc
    format2 = (int64_t)"usage:  %s [-C configfile] [-p port] [-d dir] [-r|-nor] [-dd data_dir] [-s|-nos] [-v|-nov] [-g|-nog] [-u user] [-c cgipat] [-t throttles] [-h host] [-l logfile] [-i pidfile] [-T charset] [-P P3P] [-M maxage] [-V] [-D]\n";
    int64_t v47; // 0x5820
    int64_t v48; // 0x5820
    int64_t v49; // 0x5820
    int64_t v50; // 0x5820
    int64_t v51; // 0x5820
    int64_t v52; // 0x5820
    int128_t v53; // bp-15176, 0x5820
    int128_t v54; // bp-15304, 0x5820
    struct addrinfo * addr_info; // bp-15336, 0x5820
    char v55; // 0x5820
    int64_t str8; // bp-5048, 0x5820
    int64_t v56; // 0x652f
    int64_t v57; // 0x6537
    int128_t v58; // 0x5820
    int128_t v59; // 0x5820
    if ((int32_t)v6 != v5) {
        goto lab_0x709a;
    } else {
        // 0x64c6
        tzset();
        int128_t v60 = __asm_pxor(v2, v2); // 0x64cb
        str5 = __asm_movdqa(v60);
        __asm_movdqa(v60);
        __asm_movdqa(v60);
        str5 = 1;
        snprintf((char *)&str8, 10, "%d", (int64_t)g68);
        int32_t errcode = getaddrinfo(g67, (char *)&str8, (struct addrinfo *)&str5, &addr_info); // 0x6542
        if (errcode != 0) {
            // 0x7cf3
            syslog(LOG_CRIT, "getaddrinfo %.80s - %.80s", g67, gai_strerror(errcode));
            int64_t stream = *(int64_t *)g22; // 0x7d23
            fprintf((struct _IO_FILE *)stream, "%s: getaddrinfo %s - %s\n", g49, g67, gai_strerror(errcode));
            exit(1);
            // UNREACHABLE
        }
        // 0x654f
        v56 = &str5;
        v57 = (int64_t)&addr_info;
        v58 = v60;
        v49 = v57;
        v51 = v56;
        v47 = 0;
        if (addr_info == NULL) {
            goto lab_0x660b;
        } else {
            int64_t v61 = 0;
            int64_t v62 = (int64_t)addr_info;
            int64_t v63 = 0;
            int32_t v64 = *(int32_t *)(v62 + 4); // 0x6580
            int64_t v65; // 0x5820
            int64_t v66; // 0x5820
            if (v64 == 2) {
                // 0x6570
                v65 = v63;
                v66 = v61 == 0 ? v62 : v61;
            } else {
                // 0x6588
                v65 = v63;
                v66 = v61;
                if (v64 == 10) {
                    // 0x658d
                    v65 = v63 == 0 ? v62 : v63;
                    v66 = v61;
                }
            }
            int64_t v67 = v66;
            int64_t v68 = v65;
            int64_t v69 = *(int64_t *)(v62 + 40); // 0x6577
            while (v69 != 0) {
                // 0x6580
                v61 = v67;
                v62 = v69;
                v63 = v68;
                v64 = *(int32_t *)(v62 + 4);
                if (v64 == 2) {
                    // 0x6570
                    v65 = v63;
                    v66 = v61 == 0 ? v62 : v61;
                } else {
                    // 0x6588
                    v65 = v63;
                    v66 = v61;
                    if (v64 == 10) {
                        // 0x658d
                        v65 = v63 == 0 ? v62 : v63;
                        v66 = v61;
                    }
                }
                // 0x6577
                v67 = v66;
                v68 = v65;
                v69 = *(int64_t *)(v62 + 40);
            }
            int128_t v70 = v60; // 0x659c
            int32_t v71 = v64; // 0x659c
            int64_t v72 = 0; // 0x659c
            if (v68 != 0) {
                int32_t * v73 = (int32_t *)(v68 + 16); // 0x659e
                uint32_t v74 = *v73; // 0x659e
                if (v74 >= 129) {
                    // 0x7da2
                    syslog(LOG_CRIT, "%.80s - sockaddr too small (%lu < %lu)", g67, 128, v74);
                    exit(1);
                    // UNREACHABLE
                }
                // 0x65af
                v70 = __asm_pxor(v60, v60);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                __asm_movdqa(v70);
                v54 = __asm_movdqa(v70);
                int64_t v75 = *(int64_t *)(v68 + 24); // 0x65ef
                v71 = *v73;
                memmove((int64_t *)&v54, (int64_t *)v75, v71);
                v72 = 1;
            }
            int128_t v76 = v70;
            v58 = v76;
            v49 = 0;
            v51 = v71;
            v47 = v72;
            if (v67 != 0) {
                int32_t * v77 = (int32_t *)(v67 + 16); // 0x6652
                uint32_t v78 = *v77; // 0x6652
                if (v78 >= 129) {
                    // 0x7da2
                    syslog(LOG_CRIT, "%.80s - sockaddr too small (%lu < %lu)", g67, 128, v78);
                    exit(1);
                    // UNREACHABLE
                }
                int128_t v79 = __asm_pxor(v76, v76); // 0x6663
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                __asm_movdqa(v79);
                v53 = __asm_movdqa(v79);
                int64_t v80 = *(int64_t *)(v67 + 24); // 0x66af
                uint32_t v81 = *v77; // 0x66b3
                memmove((int64_t *)&v53, (int64_t *)v80, v81);
                freeaddrinfo(addr_info);
                v55 = 0;
                v59 = v79;
                v50 = 0;
                v52 = v81;
                v48 = v72;
                goto lab_0x66d3;
            } else {
                goto lab_0x660b;
            }
        }
    }
  lab_0x6a10:;
    // 0x6a10
    struct _IO_FILE * file3; // 0x670e
    char * str = fgets((char *)&str5, (int32_t)&g13, file3); // 0x6a1b
    int128_t v82; // 0x5820
    int128_t v83 = v82; // 0x6a23
    int64_t v84; // 0x5820
    int64_t v85 = v84; // 0x6a23
    int128_t v86 = v82; // 0x6a23
    int64_t v87 = v84; // 0x6a23
    if (str == NULL) {
        // break -> 0x6749
        goto lab_0x6749;
    }
    goto lab_0x6a29;
  lab_0x6c41:;
    // 0x6c41
    int64_t v95; // 0x5820
    int64_t format; // 0x5820
    int32_t priority; // 0x5820
    syslog(priority, (char *)format, v95);
    exit(1);
    // UNREACHABLE
  lab_0x7a5c_2:;
    // 0x7a5c
    int128_t v96; // 0x7519
    int128_t v97 = v96; // 0x7a87
    int64_t * v98 = (int64_t *)&g27; // 0x7a87
    int64_t v99 = 503; // 0x7a87
    int64_t * v100 = (int64_t *)&g28; // 0x7a87
    int64_t v101; // 0x745d
    int64_t v102 = *(int64_t *)(v101 + 208); // 0x7a87
    goto lab_0x7400;
  lab_0x7419:;
    // 0x7419
    int128_t v125; // 0x5820
    int128_t v131 = v125; // 0x5820
    int64_t v126; // 0x5820
    int64_t v132 = v126; // 0x5820
    int64_t v127; // 0x5820
    int64_t v133 = v127; // 0x5820
    int64_t v128; // 0x5820
    int64_t v134 = v128; // 0x5820
    int64_t v129; // 0x5820
    int64_t v135 = v129; // 0x5820
    int64_t v130; // 0x5820
    int64_t v136 = v130; // 0x5820
    goto lab_0x7419_2;
  lab_0x740e:;
    // 0x740e
    int64_t v122; // 0x5820
    int64_t v120; // 0x5820
    int64_t v121; // 0x5820
    int64_t v124; // 0x7419
    clear_connection(v124, (int64_t *)&addr_info, v121, v120, v122);
    int128_t v119; // 0x5820
    v125 = v119;
    v126 = v120;
    v127 = v121;
    v128 = v57;
    v129 = v122;
    int64_t v123; // 0x5820
    v130 = v123;
    goto lab_0x7419;
  lab_0x7880:
    // 0x7880
    really_clear_connection(v124, (int64_t *)&addr_info, (int64_t)&g1);
    int128_t v142; // 0x5820
    v125 = v142;
    int64_t v141; // 0x5820
    v126 = v141;
    v127 = &g1;
    v128 = v57;
    int64_t v138; // 0x5820
    v129 = v138;
    int64_t v137; // 0x5820
    v130 = v137;
    goto lab_0x7419;
  lab_0x7760:;
    // 0x7760
    int32_t v157; // 0x5820
    int32_t v169 = v157;
    int64_t * v170; // 0x5820
    int64_t v117; // 0x5820
    int64_t v118; // 0x5820
    int64_t v171; // 0x5820
    int64_t v112; // 0x5820
    int64_t v115; // 0x5820
    int64_t v113; // 0x5820
    int64_t v114; // 0x5820
    int64_t v158; // 0x5820
    int64_t v172; // 0x5820
    int64_t * v116; // 0x7430
    int32_t * v143; // 0x7443
    int64_t * v148; // 0x7699
    int64_t v151; // 0x76e3
    int64_t * v152; // 0x76e7
    int64_t v173; // 0x78c5
    uint64_t v174; // 0x7990
    int128_t v111; // 0x5820
    if (v169 == 0) {
        int64_t * v175 = (int64_t *)(v124 + 112); // 0x7809
        *v175 = *v175 + 100;
        *v143 = 3;
        fdwatch_del_fd(*(int32_t *)(v151 + 704));
        int64_t * v176 = (int64_t *)(v124 + 96);
        if (*v176 != 0) {
            // 0x7829
            syslog(LOG_ERR, "replacing non-null wakeup_timer!");
        }
        // 0x783c
        v170 = v176;
        v171 = v137;
        v172 = *v175;
        goto lab_0x7840;
    } else {
        int64_t v177 = v169;
        *(int64_t *)(v124 + 88) = (int64_t)addr_info;
        uint64_t v178 = *v152; // 0x776f
        int64_t v179 = v177; // 0x777a
        int64_t v180 = 0; // 0x777a
        int64_t v181 = v158; // 0x777a
        if (v178 != 0) {
            int64_t v182; // 0x5820
            int64_t v183; // 0x5820
            int64_t v184; // 0x5820
            int64_t v185; // 0x5820
            if (v178 <= v177) {
                // 0x78ae
                v183 = v178;
                v184 = v177 - v178;
                v182 = 0;
                v185 = v177;
            } else {
                int64_t v186 = v178 - v177; // 0x778f
                int64_t v187 = *(int64_t *)(v151 + 368); // 0x7791
                int64_t v188 = v187 + v177; // 0x7799
                int64_t v189 = 0x100000000 * v186 >> 32; // 0x779c
                memmove((int64_t *)v187, (int64_t *)v188, (int32_t)v189);
                v183 = v186 & 0xffffffff;
                v184 = 0;
                v182 = v189;
                v185 = v188;
            }
            // 0x78b0
            v179 = v184;
            *v152 = v182;
            v180 = v183;
            v181 = v185;
        }
        int64_t v190 = v180;
        int64_t v191 = 0x100000000 * v179 >> 32; // 0x78bb
        int64_t * v192 = (int64_t *)(v124 + 136); // 0x78be
        v173 = *v192 + v191;
        *v192 = v173;
        int64_t v193 = *v116; // 0x78cf
        int64_t * v194 = (int64_t *)(v193 + 200); // 0x78d3
        uint64_t v195 = *v194 + v191; // 0x78da
        *v194 = v195;
        uint32_t v196 = *(int32_t *)(v124 + 56); // 0x78e4
        int64_t v197 = v196; // 0x78e4
        int64_t v198 = v190; // 0x78eb
        int64_t v199 = v181; // 0x78eb
        if (v196 >= 1) {
            int64_t v200 = v190; // 0x78f8
            int64_t v201 = 0; // 0x78f8
            if (v196 != 1) {
                int64_t v202 = g53 + 32; // 0x791d
                int64_t v203 = 0; // 0x7906
                int64_t v204 = 4 * v203; // 0x7910
                int64_t * v205 = (int64_t *)(48 * (int64_t)*(int32_t *)(v124 + 16 + v204) + v202); // 0x791d
                *v205 = *v205 + v191;
                int64_t v206 = 48 * (int64_t)*(int32_t *)(v124 + 20 + v204); // 0x792b
                int64_t * v207 = (int64_t *)(v206 + v202); // 0x792f
                *v207 = *v207 + v191;
                v203 += 2;
                v200 = v206;
                v201 = v203;
                while ((v197 & 0xfffffffe) != v203) {
                    // 0x7910
                    v204 = 4 * v203;
                    v205 = (int64_t *)(48 * (int64_t)*(int32_t *)(v124 + 16 + v204) + v202);
                    *v205 = *v205 + v191;
                    v206 = 48 * (int64_t)*(int32_t *)(v124 + 20 + v204);
                    v207 = (int64_t *)(v206 + v202);
                    *v207 = *v207 + v191;
                    v203 += 2;
                    v200 = v206;
                    v201 = v203;
                }
            }
            int64_t v208 = v201;
            v198 = v200;
            v199 = v208;
            if (v197 % 2 != 0) {
                int64_t v209 = 48 * (int64_t)*(int32_t *)(v124 + 16 + 4 * v208); // 0x794c
                int64_t * v210 = (int64_t *)(g53 + 32 + v209); // 0x7950
                *v210 = *v210 + v191;
                v198 = v209;
                v199 = v208;
            }
        }
        int64_t v211 = v199;
        v111 = v142;
        v112 = v198;
        v113 = v191;
        v114 = v211;
        v115 = v193;
        v117 = v197;
        v118 = v173;
        if (v173 < *(int64_t *)(v124 + 128)) {
            int64_t * v212 = (int64_t *)(v124 + 112); // 0x7962
            uint64_t v213 = *v212; // 0x7962
            if (v213 >= 101) {
                // 0x796c
                *v212 = v213 - 100;
            }
            int64_t v214 = *v148; // 0x7974
            v125 = v142;
            v126 = -1;
            v127 = v191;
            v128 = v211;
            v129 = v197;
            v130 = v173;
            if (v214 == -1) {
                goto lab_0x7419;
            } else {
                int64_t v215 = (int64_t)addr_info - *(int64_t *)(v124 + 80); // 0x7987
                v174 = v215 == 0 ? 1 : v215;
                if ((v174 || v195) < 0x100000000) {
                    uint32_t v216 = (int32_t)v195;
                    uint32_t v217 = (int32_t)v174;
                    v125 = v142;
                    v126 = v214;
                    v127 = v216 % v217;
                    v128 = v211;
                    v129 = v197;
                    v130 = v173;
                    if (v214 < (int64_t)(v216 / v217)) {
                        goto lab_0x79e6;
                    } else {
                        goto lab_0x7419;
                    }
                } else {
                    // 0x79a0
                    v125 = v142;
                    v126 = v214;
                    v127 = v195 % v174;
                    v128 = v211;
                    v129 = v197;
                    v130 = v173;
                    if (v214 < v195 / v174) {
                        goto lab_0x79e6;
                    } else {
                        goto lab_0x7419;
                    }
                }
            }
        } else {
            goto lab_0x7409;
        }
    }
  lab_0x77e6:;
    int32_t v218 = *__errno_location(); // 0x77eb
    uint32_t v219 = v218 - 4; // 0x77ed
    int64_t v220 = v219; // 0x77ed
    if (v219 < 29) {
        int32_t v221 = *(int32_t *)(4 * v220 + (int64_t)&g3); // 0x7800
        return (int64_t)v221 + (int64_t)&g3;
    }
    // 0x79b0
    v119 = v142;
    v120 = v220;
    int64_t v159; // 0x5820
    v121 = v159;
    v122 = v138;
    v123 = v137;
    if (v218 != 104) {
        int64_t v222 = *(int64_t *)(v151 + 208); // 0x79b9
        syslog(LOG_ERR, "write - %m sending %.80s", v222, (char *)v220);
        v119 = v142;
        v120 = v220;
        v121 = v222;
        v122 = v138;
        v123 = v137;
    }
    goto lab_0x740e;
  lab_0x74af:;
    int32_t * fd2 = (int32_t *)(v101 + 704); // 0x74af
    int64_t v167; // 0x749f
    int64_t v168; // 0x74a7
    int64_t nbyte2 = v167 - v168; // 0x74b7
    int64_t v166; // 0x5820
    int64_t buf2 = *(int64_t *)v166 + v168; // 0x74ba
    int32_t v223 = read(*fd2, (int64_t *)buf2, (int32_t)nbyte2); // 0x74c2
    v97 = v142;
    v98 = (int64_t *)&g23;
    v99 = 400;
    v100 = (int64_t *)&g24;
    v102 = (int64_t)&g10;
    int64_t v109; // 0x5820
    int64_t v110; // 0x5820
    int64_t v224; // 0x5820
    int64_t v225; // 0x5820
    int64_t v106; // 0x5820
    int64_t v226; // 0x5820
    int64_t v107; // 0x5820
    int64_t v227; // 0x5820
    int64_t v108; // 0x5820
    int64_t * v164; // 0x7469
    int32_t * v228; // 0x7511
    int128_t v105; // 0x5820
    if (v223 == 0) {
        goto lab_0x7400;
    } else {
        if (v223 < 0) {
            int32_t v229 = *__errno_location(); // 0x7895
            v97 = v142;
            v98 = (int64_t *)&g23;
            v99 = 400;
            v100 = (int64_t *)&g24;
            v102 = (int64_t)&g10;
            v125 = v142;
            v126 = v141;
            v127 = nbyte2;
            v128 = buf2;
            v129 = v138;
            v130 = v137;
            switch (v229) {
                case 4: {
                    goto lab_0x7419;
                }
                case 11: {
                    goto lab_0x7419;
                }
                default: {
                    goto lab_0x7400;
                }
            }
        } else {
            // 0x74d5
            *v164 = *v164 + (int64_t)v223;
            *(int64_t *)(v124 + 88) = (int64_t)addr_info;
            int64_t v230 = httpd_got_request(v101, buf2, nbyte2, v141, v138, v137); // 0x74eb
            v97 = v142;
            v98 = (int64_t *)&g23;
            v99 = 400;
            v100 = (int64_t *)&g24;
            v102 = (int64_t)&g10;
            v125 = v142;
            v126 = v141;
            v127 = nbyte2;
            v128 = buf2;
            v129 = v138;
            v130 = v137;
            switch ((int32_t)v230) {
                case 0: {
                    goto lab_0x7419;
                }
                case 2: {
                    goto lab_0x7400;
                }
                default: {
                    int64_t v231 = httpd_parse_request(v101, buf2, nbyte2, v141, v138, v137); // 0x7504
                    v105 = v142;
                    v106 = v141;
                    v107 = nbyte2;
                    v108 = buf2;
                    v109 = v138;
                    v110 = v137;
                    if ((int32_t)v231 < 0) {
                        goto lab_0x7405;
                    } else {
                        // 0x7511
                        v228 = (int32_t *)(v124 + 56);
                        *v228 = 0;
                        v96 = __asm_pcmpeqd(v142, v142);
                        int64_t v232 = __asm_movdqu(v96); // 0x751d
                        int64_t v233 = v124 + 64; // 0x751d
                        *(int128_t *)v233 = (int128_t)v232;
                        int64_t v234 = v141; // 0x752a
                        int64_t v235 = nbyte2; // 0x752a
                        if (g50 >= 1) {
                            int64_t v236 = v124 + 16;
                            int64_t * v237 = (int64_t *)v233;
                            int64_t * v238 = (int64_t *)(v124 + 72);
                            int64_t v239 = 0;
                            uint64_t v240 = 1;
                            int64_t v241 = *(int64_t *)(*v116 + 240); // 0x754f
                            int64_t v242 = v141; // 0x755d
                            int64_t v243 = nbyte2; // 0x755d
                            int32_t * v244; // 0x5820
                            int64_t v245; // 0x5820
                            uint64_t v246; // 0x5820
                            int64_t v247; // 0x5820
                            int64_t v248; // 0x5820
                            int64_t v249; // 0x5820
                            int64_t v250; // 0x5820
                            int64_t v251; // 0x756a
                            int64_t v252; // 0x756f
                            int64_t v253; // 0x7581
                            int32_t * v254; // 0x5820
                            int64_t v255; // 0x5820
                            int32_t v256; // 0x75c2
                            uint64_t v257; // 0x75da
                            uint32_t v258; // 0x5820
                            int64_t v259; // 0x7608
                            int64_t v260; // 0x7612
                            int64_t v261; // 0x761a
                            int64_t v262; // 0x7622
                            int64_t v263; // 0x7628
                            if ((int32_t)match(*(int64_t *)(g53 + v239), v241) != 0) {
                                // 0x7563
                                v250 = g53 + v239;
                                v251 = *(int64_t *)(v250 + 8);
                                v252 = *(int64_t *)(v250 + 24);
                                if (v252 > 2 * v251) {
                                    goto lab_0x7a5c_2;
                                }
                                // 0x7581
                                v253 = *(int64_t *)(v250 + 16);
                                if (v252 < v253) {
                                    goto lab_0x7a5c_2;
                                }
                                // 0x758f
                                if (*(int32_t *)(v250 + 40) >= 0) {
                                    // 0x758f
                                    v244 = (int32_t *)(v239 + 40 + g53);
                                    v245 = v251;
                                    v247 = v253;
                                } else {
                                    // 0x7596
                                    syslog(LOG_ERR, "throttle sending count was negative - shouldn't happen!");
                                    v254 = (int32_t *)(v239 + 40 + g53);
                                    *v254 = 0;
                                    v255 = g53 + v239;
                                    v244 = v254;
                                    v245 = *(int64_t *)(v255 + 8);
                                    v247 = *(int64_t *)(v255 + 16);
                                }
                                // 0x75c2
                                v242 = v247;
                                v246 = v245;
                                v256 = *v228;
                                *v228 = v256 + 1;
                                *(int32_t *)(v236 + 4 * (int64_t)v256) = (int32_t)v240 - 1;
                                v257 = (int64_t)*v244 + 1;
                                v258 = (int32_t)v257;
                                *v244 = v258;
                                if ((v257 || v246) < 0x100000000) {
                                    // 0x7600
                                    v248 = (int32_t)v246 / v258;
                                } else {
                                    // 0x75ee
                                    v248 = v246 / v257;
                                }
                                // 0x7604
                                v249 = v248;
                                v243 = *v237;
                                v259 = v243 - v249;
                                v260 = *v238;
                                v261 = v243 == -1 | v259 < 0 == ((v259 ^ v243) & (v243 ^ v249)) < 0 ? v249 : v243;
                                *v237 = v261;
                                v262 = v260 - v242;
                                v263 = v262 < 0 == ((v262 ^ v260) & (v260 ^ v242)) < 0 == (v262 != 0) ? v260 : v242;
                                *v238 = v260 == -1 ? v242 : v263;
                            }
                            int64_t v264 = v243;
                            int64_t v265 = v242;
                            v234 = v265;
                            v235 = v264;
                            while (v240 < (int64_t)g50) {
                                int64_t v266 = v240 + 1; // 0x7651
                                int64_t v267 = v239 + 48; // 0x7651
                                v234 = v265;
                                v235 = v264;
                                if (*v228 >= 10) {
                                    // break -> 0x7657
                                    break;
                                }
                                v239 = v267;
                                v240 = v266;
                                v241 = *(int64_t *)(*v116 + 240);
                                v242 = v265;
                                v243 = v264;
                                if ((int32_t)match(*(int64_t *)(g53 + v239), v241) != 0) {
                                    // 0x7563
                                    v250 = g53 + v239;
                                    v251 = *(int64_t *)(v250 + 8);
                                    v252 = *(int64_t *)(v250 + 24);
                                    if (v252 > 2 * v251) {
                                        goto lab_0x7a5c_2;
                                    }
                                    // 0x7581
                                    v253 = *(int64_t *)(v250 + 16);
                                    if (v252 < v253) {
                                        goto lab_0x7a5c_2;
                                    }
                                    // 0x758f
                                    if (*(int32_t *)(v250 + 40) >= 0) {
                                        // 0x758f
                                        v244 = (int32_t *)(v239 + 40 + g53);
                                        v245 = v251;
                                        v247 = v253;
                                    } else {
                                        // 0x7596
                                        syslog(LOG_ERR, "throttle sending count was negative - shouldn't happen!");
                                        v254 = (int32_t *)(v239 + 40 + g53);
                                        *v254 = 0;
                                        v255 = g53 + v239;
                                        v244 = v254;
                                        v245 = *(int64_t *)(v255 + 8);
                                        v247 = *(int64_t *)(v255 + 16);
                                    }
                                    // 0x75c2
                                    v242 = v247;
                                    v246 = v245;
                                    v256 = *v228;
                                    *v228 = v256 + 1;
                                    *(int32_t *)(v236 + 4 * (int64_t)v256) = (int32_t)v240 - 1;
                                    v257 = (int64_t)*v244 + 1;
                                    v258 = (int32_t)v257;
                                    *v244 = v258;
                                    if ((v257 || v246) < 0x100000000) {
                                        // 0x7600
                                        v248 = (int32_t)v246 / v258;
                                    } else {
                                        // 0x75ee
                                        v248 = v246 / v257;
                                    }
                                    // 0x7604
                                    v249 = v248;
                                    v243 = *v237;
                                    v259 = v243 - v249;
                                    v260 = *v238;
                                    v261 = v243 == -1 | v259 < 0 == ((v259 ^ v243) & (v243 ^ v249)) < 0 ? v249 : v243;
                                    *v237 = v261;
                                    v262 = v260 - v242;
                                    v263 = v262 < 0 == ((v262 ^ v260) & (v260 ^ v242)) < 0 == (v262 != 0) ? v260 : v242;
                                    *v238 = v260 == -1 ? v242 : v263;
                                }
                                // 0x7638
                                v264 = v243;
                                v265 = v242;
                                v234 = v265;
                                v235 = v264;
                            }
                        }
                        // 0x7657
                        v227 = v235;
                        v226 = v234;
                        int64_t v268 = httpd_start_request(v101, (int64_t *)&addr_info, v227, v226, v138, v137); // 0x765d
                        v105 = v96;
                        v106 = v226;
                        v107 = v227;
                        v108 = v57;
                        v109 = v138;
                        v110 = v137;
                        if ((int32_t)v268 < 0) {
                            goto lab_0x7405;
                        } else {
                            // 0x766a
                            if (*(int32_t *)(v101 + 528) == 0) {
                                int64_t v269 = *(int64_t *)(v101 + 192); // 0x7a8c
                                v224 = v269;
                                if (v269 < 0) {
                                    // 0x7af7
                                    *(int64_t *)(v124 + 128) = 0;
                                    v225 = 0;
                                    if (*(int64_t *)(v101 + 712) != 0) {
                                        goto lab_0x7aab;
                                    } else {
                                        goto lab_0x7b0f;
                                    }
                                } else {
                                    goto lab_0x7a99;
                                }
                            } else {
                                // 0x7679
                                *(int64_t *)(v124 + 136) = *(int64_t *)(v101 + 536);
                                v224 = *(int64_t *)(v101 + 544) + 1;
                                goto lab_0x7a99;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x7400:;
    int64_t v103 = *v100;
    int64_t v104 = *v98;
    httpd_send_err(v101, v99, v104, (int64_t)&g10, v103, v102);
    v105 = v97;
    v106 = (int64_t)&g10;
    v107 = v104;
    v108 = v99;
    v109 = v103;
    v110 = v102;
    goto lab_0x7405;
  lab_0x7405:
    // 0x7405
    v111 = v105;
    v112 = v106;
    v113 = v107;
    v114 = v108;
    v115 = *v116;
    v117 = v109;
    v118 = v110;
    goto lab_0x7409;
  lab_0x7840:;
    int64_t v276 = tmr_create((int32_t)v57, 0x88d0, v124, v172, 0); // 0x7850
    *v170 = v276;
    v95 = v124;
    format = (int64_t)"tmr_create(wakeup_connection) failed";
    priority = 2;
    v125 = v142;
    v126 = v172;
    v127 = v124;
    v128 = 0x88d0;
    v129 = 0;
    v130 = v171;
    if (v276 == 0) {
        // break (via goto) -> 0x6c41
        goto lab_0x6c41;
    }
    goto lab_0x7419;
  lab_0x7409:
    // 0x7409
    httpd_write_response(v115, v114, v113);
    v119 = v111;
    v120 = v112;
    v121 = v113;
    v122 = v117;
    v123 = v118;
    goto lab_0x740e;
  lab_0x79e6:
    // 0x79e6
    *v143 = 3;
    fdwatch_del_fd(*(int32_t *)(v151 + 704));
    uint64_t v270 = *v148; // 0x79fe
    uint64_t v271 = *(int64_t *)(*v116 + 200); // 0x7a02
    int64_t v272; // 0x5820
    if ((v271 || v270) < 0x100000000) {
        // 0x7a1f
        v272 = (int32_t)v271 / (int32_t)v270;
    } else {
        // 0x7a15
        v272 = v271 / v270;
    }
    int64_t * v273 = (int64_t *)(v124 + 96);
    if (*v273 != 0) {
        // 0x7a2f
        syslog(LOG_ERR, "replacing non-null wakeup_timer!");
    }
    int64_t v274 = 0x100000000 * (v272 - v174) / 0x100000000; // 0x7a42
    int64_t v275 = (int32_t)v274 < 1 ? 500 : v274 * (int64_t)&g192; // 0x7a53
    v170 = v273;
    v171 = v173;
    v172 = v275;
    goto lab_0x7840;
  lab_0x7a99:
    // 0x7a99
    *(int64_t *)(v124 + 128) = v224;
    v225 = v224;
    if (*(int64_t *)(v101 + 712) == 0) {
        goto lab_0x7b0f;
    } else {
        goto lab_0x7aab;
    }
  lab_0x7aab:
    // 0x7aab
    v105 = v96;
    v106 = v226;
    v107 = v227;
    v108 = v57;
    v109 = v138;
    v110 = v137;
    if (*(int64_t *)(v124 + 136) < v225) {
        // 0x7ab8
        *v143 = 2;
        *(int64_t *)(v124 + 80) = (int64_t)addr_info;
        *(int64_t *)(v124 + 112) = 0;
        fdwatch_del_fd(*fd2);
        fdwatch_add_fd(*fd2, (int32_t)v124, 1);
        v125 = v96;
        v126 = v226;
        v127 = 1;
        v128 = v124;
        v129 = v138;
        v130 = v137;
        goto lab_0x7419;
    } else {
        goto lab_0x7405;
    }
  lab_0x7b0f:;
    uint32_t v277 = *v228; // 0x7b0f
    int64_t v278 = v277; // 0x7b0f
    int64_t v279 = *(int64_t *)(v101 + 200); // 0x7b13
    int64_t v280 = v278; // 0x7b1d
    int64_t v281 = v227; // 0x7b1d
    int64_t v282 = v57; // 0x7b1d
    if (v277 >= 1) {
        // 0x7b1f
        if (v277 != 1) {
            int64_t v283 = v124 + 16; // 0x7b40
            int64_t v284; // 0x7b1f
            int64_t v285 = v284 + 32; // 0x7b4e
            int64_t v286 = v124 + 20; // 0x7b53
            int64_t v287 = 0;
            int64_t v288 = 4 * v287; // 0x7b40
            int64_t * v289 = (int64_t *)(48 * (int64_t)*(int32_t *)(v283 + v288) + v285); // 0x7b4e
            *v289 = *v289 + v279;
            int64_t * v290 = (int64_t *)(48 * (int64_t)*(int32_t *)(v286 + v288) + v285); // 0x7b61
            *v290 = *v290 + v279;
            int64_t v291 = v287 + 2; // 0x7b66
            while ((v278 & 0xfffffffe) != v291) {
                // 0x7b40
                v288 = 4 * v291;
                v289 = (int64_t *)(48 * (int64_t)*(int32_t *)(v283 + v288) + v285);
                *v289 = *v289 + v279;
                v290 = (int64_t *)(48 * (int64_t)*(int32_t *)(v286 + v288) + v285);
                *v290 = *v290 + v279;
                v291 += 2;
            }
        }
        int64_t v292 = 0;
        v280 = v278;
        v281 = g53;
        v282 = v292;
        if (v278 % 2 != 0) {
            int64_t v293 = 48 * (int64_t)*(int32_t *)(v124 + 16 + 4 * v292); // 0x7b7d
            int64_t * v294 = (int64_t *)(g53 + 32 + v293); // 0x7b81
            *v294 = *v294 + v279;
            v280 = v293;
            v281 = g53;
            v282 = v292;
        }
    }
    // 0x7b86
    *(int64_t *)(v124 + 136) = v279;
    v105 = v96;
    v106 = v280;
    v107 = v281;
    v108 = v282;
    v109 = v138;
    v110 = v137;
    goto lab_0x7405;
  lab_0x7c38:;
    // 0x7c38
    int64_t v295; // 0x5820
    int64_t v296 = v295;
    int64_t v297; // 0x5820
    int64_t v298; // 0x5820
    int64_t v299; // 0x5820
    if (g48 != 0) {
        int32_t v300 = g89; // 0x7c45
        v299 = v296;
        v298 = v297;
        if (v300 >= 0 != v300 != 0) {
            goto lab_0x7c52;
        }
    }
    // 0x7270
    int128_t v301; // 0x5820
    int128_t v302 = v301; // 0x5820
    int64_t v303; // 0x5820
    int64_t v304 = v303; // 0x5820
    int64_t v305; // 0x5820
    int64_t v306 = v305; // 0x5820
    int64_t v307 = v296; // 0x5820
    int64_t v308; // 0x5820
    int64_t v309 = v308; // 0x5820
    int64_t v310; // 0x5820
    int64_t v311 = v310; // 0x5820
    goto lab_0x7270;
  lab_0x7419_3:;
    // 0x7419
    int128_t v317; // 0x5820
    v131 = v317;
    int64_t v316; // 0x5820
    v132 = v316;
    int64_t v324; // 0x5820
    v133 = v324;
    int64_t v328; // 0x5820
    v134 = v328;
    int64_t v313; // 0x5820
    v135 = v313;
    int64_t v312; // 0x5820
    v136 = v312;
    int64_t v140; // 0x5820
    int64_t v139; // 0x5820
    int64_t v147; // 0x5820
    while (true) {
      lab_0x7419_2:
        // 0x7419
        v137 = v136;
        v138 = v135;
        v139 = v134;
        v140 = v133;
        v141 = v132;
        v142 = v131;
        v124 = fdwatch_get_next_client_data();
        v125 = v142;
        v126 = v141;
        v127 = v140;
        v128 = v139;
        v129 = v138;
        v130 = v137;
        switch (v124) {
            case 0: {
                goto lab_0x7419;
            }
            case -1: {
                goto lab_0x7bc0;
            }
            default: {
                // 0x7430
                v116 = (int64_t *)(v124 + 8);
                v119 = v142;
                v120 = v141;
                v121 = v140;
                v122 = v138;
                v123 = v137;
                if ((int32_t)fdwatch_check_fd(*(int32_t *)(*v116 + 704)) == 0) {
                    goto lab_0x740e;
                } else {
                    // 0x7443
                    v143 = (int32_t *)v124;
                    int32_t v144 = *v143; // 0x7443
                    switch (v144) {
                        case 4: {
                            int32_t fd = *(int32_t *)(*v116 + 704); // 0x76b8
                            int32_t v145 = read(fd, &str8, (int32_t)&g1); // 0x76c6
                            if (v145 < 0) {
                                int32_t v146 = *__errno_location(); // 0x786c
                                v125 = v142;
                                v126 = v141;
                                v127 = &g1;
                                v128 = v147;
                                v129 = v138;
                                v130 = v137;
                                switch (v146) {
                                    case 4: {
                                        goto lab_0x7419;
                                    }
                                    case 11: {
                                        goto lab_0x7419;
                                    }
                                    default: {
                                        goto lab_0x7880;
                                    }
                                }
                            } else {
                                // 0x76d3
                                v125 = v142;
                                v126 = v141;
                                v127 = &g1;
                                v128 = v147;
                                v129 = v138;
                                v130 = v137;
                                if (v145 != 0) {
                                    goto lab_0x7419;
                                } else {
                                    goto lab_0x7880;
                                }
                            }
                        }
                        case 2: {
                            // 0x7699
                            v148 = (int64_t *)(v124 + 64);
                            int64_t v149 = *v148; // 0x7699
                            int64_t v150 = 0x3b9aca00; // 0x76a1
                            if (v149 != -1) {
                                // 0x76a3
                                v150 = (v149 >= 0 ? v149 : v149 + 3) >> 2;
                            }
                            // 0x76e3
                            v151 = *v116;
                            v152 = (int64_t *)(v151 + 472);
                            if (*v152 == 0) {
                                uint64_t v153 = v150;
                                int64_t v154 = *(int64_t *)(v124 + 136); // 0x77bd
                                int64_t buf = *(int64_t *)(v151 + 712) + v154; // 0x77cc
                                uint64_t v155 = *(int64_t *)(v124 + 128) - v154; // 0x77cf
                                int64_t nbyte = v155 >= v153 ? v153 : v155; // 0x77d5
                                int32_t v156 = write(*(int32_t *)(v151 + 704), (int64_t *)buf, (int32_t)nbyte); // 0x77d9
                                v157 = v156;
                                v158 = buf;
                                v159 = nbyte;
                                if (v156 >= 0) {
                                    goto lab_0x7760;
                                } else {
                                    goto lab_0x77e6;
                                }
                            } else {
                                // 0x76f8
                                str8 = *(int64_t *)(v151 + 368);
                                int32_t v160 = writev(*(int32_t *)(v151 + 704), (struct iovec *)&str8, 2); // 0x7753
                                v157 = v160;
                                v158 = v147;
                                v159 = 2;
                                if (v160 < 0) {
                                    goto lab_0x77e6;
                                } else {
                                    goto lab_0x7760;
                                }
                            }
                        }
                        default: {
                            // 0x7458
                            v125 = v142;
                            v126 = v141;
                            v127 = v140;
                            v128 = v139;
                            v129 = v138;
                            v130 = v137;
                            if (v144 != 1) {
                                goto lab_0x7419;
                            } else {
                                // 0x745d
                                v101 = *v116;
                                int64_t v161 = v101 + 152; // 0x7461
                                int64_t * v162 = (int64_t *)v161; // 0x7461
                                uint64_t v163 = *v162; // 0x7461
                                v164 = (int64_t *)(v101 + 160);
                                uint64_t v165 = *v164; // 0x7469
                                if (v165 < v163) {
                                    // 0x745d
                                    v166 = v101 + 144;
                                    v167 = v163;
                                    v168 = v165;
                                    goto lab_0x74af;
                                } else {
                                    // 0x7476
                                    v97 = v142;
                                    v98 = (int64_t *)&g23;
                                    v99 = 400;
                                    v100 = (int64_t *)&g24;
                                    v102 = (int64_t)&g10;
                                    if (v163 >= (int64_t)&g14) {
                                        goto lab_0x7400;
                                    } else {
                                        // 0x7483
                                        v166 = v101 + 144;
                                        httpd_realloc_str(v166, v161, v163 + (int64_t)&g192);
                                        v167 = *v162;
                                        v168 = *v164;
                                        goto lab_0x74af;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x7bc0:
    // 0x7bc0
    tmr_run((int64_t *)&addr_info);
    v301 = v142;
    v303 = v141;
    v305 = v140;
    v295 = v139;
    v297 = v57;
    v308 = v138;
    v310 = v137;
    if (g65 != 0) {
        // 0x7bd1
        v301 = v142;
        v303 = v141;
        v305 = v140;
        v295 = v139;
        v297 = v57;
        v308 = v138;
        v310 = v137;
        if (g48 == 0) {
            // 0x7bda
            g48 = 1;
            v301 = v142;
            v303 = v141;
            v305 = v140;
            v295 = v139;
            v297 = 0;
            v308 = v138;
            v310 = v137;
            if (g80 != 0) {
                int32_t v334 = *(int32_t *)(g80 + 72); // 0x7bf0
                int64_t v335 = g80; // 0x7bf6
                if (v334 != -1) {
                    // 0x7bf8
                    fdwatch_del_fd(v334);
                    v335 = g80;
                }
                int32_t v336 = *(int32_t *)(v335 + 76); // 0x7c06
                int64_t v337 = v335; // 0x7c0c
                if (v336 != -1) {
                    // 0x7c0e
                    fdwatch_del_fd(v336);
                    v337 = g80;
                }
                // 0x7c1c
                httpd_unlisten(v337);
                v301 = v142;
                v303 = v141;
                v305 = v140;
                v295 = v139;
                v297 = v337;
                v308 = v138;
                v310 = v137;
            }
        }
    }
    goto lab_0x7c38;
  lab_0x73a1:;
    // 0x73a1
    int64_t v330; // 0x5820
    int64_t v338 = v330;
    v328 = v338;
    if (g80 == 0) {
        goto lab_0x7419_3;
    } else {
        int32_t v339 = *(int32_t *)(g80 + 72); // 0x73ad
        v328 = v338;
        if (v339 == -1) {
            goto lab_0x7419_3;
        } else {
            // 0x73b5
            v328 = v338;
            if ((int32_t)fdwatch_check_fd(v339) == 0) {
                goto lab_0x7419_3;
            } else {
                uint32_t v340 = *(int32_t *)(g80 + 72); // 0x73c5
                int64_t v341 = v340; // 0x73c5
                int64_t v342 = handle_newconnect((int64_t *)&addr_info, v340); // 0x73cb
                v328 = v341;
                v301 = v317;
                v303 = v316;
                v305 = v324;
                v295 = v341;
                v297 = v57;
                v308 = v313;
                v310 = v312;
                if ((int32_t)v342 != 0) {
                    goto lab_0x7c38;
                } else {
                    goto lab_0x7419_3;
                }
            }
        }
    }
  lab_0x6a82:;
    // 0x6a82
    int64_t v343; // bp-15312, 0x5820
    int64_t v344; // bp-15320, 0x5820
    int32_t items_assigned = sscanf((char *)&str5, " %4900[^ \t] %ld-%ld", &str8, &v344, &v343); // 0x6a9b
    int64_t v345; // 0x66f2
    char * v346; // 0x6709
    int128_t v89; // 0x5820
    if (items_assigned == 3) {
        goto lab_0x6ad0;
    } else {
        int32_t items_assigned2 = sscanf((char *)&str5, " %4900[^ \t] %ld", &str8, &v343); // 0x6ab9
        if (items_assigned2 != 2) {
            // 0x69c1
            syslog(LOG_CRIT, "unparsable line in %.80s - %.80s", v346, &str5);
            int64_t stream2 = *(int64_t *)g22; // 0x69e6
            fprintf((struct _IO_FILE *)stream2, "%s: unparsable line in %.80s - %.80s\n", g49, v346, &str5);
            v82 = v89;
            v84 = 0x100000000 * v345 >> 32;
            goto lab_0x6a10;
        } else {
            // 0x6ac7
            v344 = 0;
            goto lab_0x6ad0;
        }
    }
  lab_0x6ad0:
    // 0x6ad0
    if ((char)str8 == 47) {
        // 0x6ada
        int64_t str9; // bp-5047, 0x5820
        memmove(&str8, &str9, strlen((char *)&str9) + 1);
    }
    char * substr_pos = strstr((char *)&str8, "|/"); // 0x6aff
    char * v347 = substr_pos; // 0x6b07
    if (substr_pos != NULL) {
        int64_t v348 = (int64_t)v347;
        int64_t str10 = v348 + 2; // 0x6b14
        memmove((int64_t *)(v348 + 1), (int64_t *)str10, strlen((char *)str10) + 1);
        char * substr_pos2 = strstr((char *)&str8, "|/"); // 0x6b35
        while (substr_pos2 != NULL) {
            // 0x6b10
            v348 = (int64_t)substr_pos2;
            str10 = v348 + 2;
            memmove((int64_t *)(v348 + 1), (int64_t *)str10, strlen((char *)str10) + 1);
            substr_pos2 = strstr((char *)&str8, "|/");
        }
    }
    uint32_t v349 = g52; // 0x6b49
    if (g50 >= v349) {
        int64_t * mem; // 0x5820
        if (v349 == 0) {
            // 0x6b85
            g52 = 100;
            mem = malloc((int32_t)&g4);
        } else {
            // 0x6b66
            g52 = 2 * v349;
            mem = realloc((int64_t *)g53, 96 * v349);
        }
        // 0x6b99
        g53 = (int64_t)mem;
        if (mem == NULL) {
            // 0x7ca6
            syslog(LOG_CRIT, "out of memory allocating a throttletab");
            format2 = (int64_t)"%s: out of memory allocating a throttletab\n";
            goto lab_0x709a;
        }
    }
    char * v350 = strdup((char *)&str8); // 0x6bac
    if (v350 == NULL) {
        // 0x706f
        syslog(LOG_CRIT, "out of memory copying a string");
        format2 = (int64_t)"%s: out of memory copying a string\n";
        goto lab_0x709a;
    }
    int64_t v351 = g53 + 48 * (int64_t)g50;
    *(int64_t *)v351 = (int64_t)v350;
    *(int64_t *)(v351 + 8) = v343;
    *(int64_t *)(v351 + 16) = v344;
    int128_t v352 = __asm_pxor(v89, v89); // 0x6be6
    *(int128_t *)(v351 + 24) = (int128_t)__asm_movdqu(v352);
    *(int32_t *)(v351 + 40) = 0;
    g50 = &g51;
    v82 = v352;
    v84 = g53;
    goto lab_0x6a10;
  lab_0x5ab6:;
    int64_t v353 = v13 + (int64_t)strspn(str11, " \t\n\r"); // 0x5ac1
    v11 = v353;
    if (*(char *)v353 == 0) {
        // break -> 0x5a40
        goto lab_0x5a40;
    }
    goto lab_0x5acf;
  lab_0x5d63:;
    int64_t str12 = v8;
    if (strcasecmp(str6, "noemptyreferers") == 0) {
        goto lab_0x5f51;
    } else {
        // 0x5d7a
        if (strcasecmp(str6, "noemptyreferrers") == 0) {
            goto lab_0x5f51;
        } else {
            // 0x5d91
            if (strcasecmp(str6, "localpat") == 0) {
                // 0x5fa9
                v7 = str6;
                format3 = (int64_t)"%s: value required for %s option\n";
                if (str12 == 0) {
                    goto lab_0x7003_26;
                }
                char * v354 = strdup((char *)str12); // 0x5fb5
                if (v354 == NULL) {
                    // 0x706f
                    syslog(LOG_CRIT, "out of memory copying a string");
                    format2 = (int64_t)"%s: out of memory copying a string\n";
                    goto lab_0x709a;
                }
                // 0x5fc3
                g78 = (int64_t)v354;
            } else {
                // 0x5da8
                if (strcasecmp(str6, "throttles") == 0) {
                    // 0x5fcf
                    v7 = str6;
                    format3 = (int64_t)"%s: value required for %s option\n";
                    if (str12 == 0) {
                        goto lab_0x7003_26;
                    }
                    char * v355 = strdup((char *)str12); // 0x5fdb
                    if (v355 == NULL) {
                        // 0x706f
                        syslog(LOG_CRIT, "out of memory copying a string");
                        format2 = (int64_t)"%s: out of memory copying a string\n";
                        goto lab_0x709a;
                    }
                    // 0x5fe9
                    g54 = v355;
                } else {
                    // 0x5dbf
                    if (strcasecmp(str6, "host") == 0) {
                        // 0x5ff5
                        v7 = str6;
                        format3 = (int64_t)"%s: value required for %s option\n";
                        if (str12 == 0) {
                            goto lab_0x7003_26;
                        }
                        char * v356 = strdup((char *)str12); // 0x6001
                        if (v356 == NULL) {
                            // 0x706f
                            syslog(LOG_CRIT, "out of memory copying a string");
                            format2 = (int64_t)"%s: out of memory copying a string\n";
                            goto lab_0x709a;
                        }
                        // 0x600f
                        g67 = v356;
                    } else {
                        // 0x5dd6
                        if (strcasecmp(str6, "logfile") == 0) {
                            // 0x601b
                            v7 = str6;
                            format3 = (int64_t)"%s: value required for %s option\n";
                            if (str12 == 0) {
                                goto lab_0x7003_26;
                            }
                            char * v357 = strdup((char *)str12); // 0x6027
                            if (v357 == NULL) {
                                // 0x706f
                                syslog(LOG_CRIT, "out of memory copying a string");
                                format2 = (int64_t)"%s: out of memory copying a string\n";
                                goto lab_0x709a;
                            }
                            // 0x6035
                            g56 = v357;
                        } else {
                            // 0x5ded
                            if (strcasecmp(str6, "vhost") == 0) {
                                // 0x6041
                                v7 = str6;
                                format3 = (int64_t)"%s: no value required for %s option\n";
                                if (str12 != 0) {
                                    goto lab_0x7003_26;
                                }
                                // 0x604a
                                g75 = 1;
                            } else {
                                // 0x5e04
                                if (strcasecmp(str6, "novhost") == 0) {
                                    // 0x6056
                                    if (str12 != 0) {
                                        goto lab_0x7003_26;
                                    }
                                    // 0x605f
                                    g75 = 0;
                                } else {
                                    // 0x5e1b
                                    if (strcasecmp(str6, "globalpasswd") == 0) {
                                        // 0x606b
                                        v7 = str6;
                                        format3 = (int64_t)"%s: no value required for %s option\n";
                                        if (str12 != 0) {
                                            goto lab_0x7003_26;
                                        }
                                        // 0x6074
                                        g76 = 1;
                                    } else {
                                        // 0x5e32
                                        if (strcasecmp(str6, "noglobalpasswd") == 0) {
                                            // 0x6080
                                            v7 = str6;
                                            format3 = (int64_t)"%s: no value required for %s option\n";
                                            if (str12 != 0) {
                                                goto lab_0x7003_26;
                                            }
                                            // 0x6089
                                            g76 = 0;
                                        } else {
                                            // 0x5e49
                                            if (strcasecmp(str6, "pidfile") == 0) {
                                                // 0x6095
                                                v7 = str6;
                                                format3 = (int64_t)"%s: value required for %s option\n";
                                                if (str12 == 0) {
                                                    goto lab_0x7003_26;
                                                }
                                                char * v358 = strdup((char *)str12); // 0x60a1
                                                if (v358 == NULL) {
                                                    // 0x706f
                                                    syslog(LOG_CRIT, "out of memory copying a string");
                                                    format2 = (int64_t)"%s: out of memory copying a string\n";
                                                    goto lab_0x709a;
                                                }
                                                // 0x60af
                                                g60 = v358;
                                            } else {
                                                // 0x5e60
                                                if (strcasecmp(str6, "charset") == 0) {
                                                    // 0x60bb
                                                    v7 = str6;
                                                    format3 = (int64_t)"%s: value required for %s option\n";
                                                    if (str12 == 0) {
                                                        goto lab_0x7003_26;
                                                    }
                                                    char * v359 = strdup((char *)str12); // 0x60c7
                                                    if (v359 == NULL) {
                                                        // 0x706f
                                                        syslog(LOG_CRIT, "out of memory copying a string");
                                                        format2 = (int64_t)"%s: out of memory copying a string\n";
                                                        goto lab_0x709a;
                                                    }
                                                    // 0x60d5
                                                    g71 = v359;
                                                } else {
                                                    // 0x5e77
                                                    if (strcasecmp(str6, "p3p") == 0) {
                                                        // 0x60e1
                                                        v7 = str6;
                                                        format3 = (int64_t)"%s: value required for %s option\n";
                                                        if (str12 == 0) {
                                                            goto lab_0x7003_26;
                                                        }
                                                        char * v360 = strdup((char *)str12); // 0x60ed
                                                        if (v360 == NULL) {
                                                            // 0x706f
                                                            syslog(LOG_CRIT, "out of memory copying a string");
                                                            format2 = (int64_t)"%s: out of memory copying a string\n";
                                                            goto lab_0x709a;
                                                        }
                                                        // 0x60fb
                                                        g72 = v360;
                                                    } else {
                                                        int32_t v361 = strcasecmp(str6, "max_age"); // 0x5e98
                                                        v7 = str6;
                                                        format3 = (int64_t)"%s: unknown config option '%s'\n";
                                                        if (v361 != 0) {
                                                            goto lab_0x7003_26;
                                                        }
                                                        // 0x5ea5
                                                        v7 = str6;
                                                        format3 = (int64_t)"%s: value required for %s option\n";
                                                        if (str12 == 0) {
                                                            goto lab_0x7003_26;
                                                        }
                                                        // 0x5eae
                                                        g73 = strtol((char *)str12, NULL, 10);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            goto lab_0x5ab6;
        }
    }
  lab_0x5f51:
    // 0x5f51
    v7 = str6;
    format3 = (int64_t)"%s: no value required for %s option\n";
    if (str12 != 0) {
        goto lab_0x7003_26;
    }
    // 0x5f5a
    g79 = 1;
    goto lab_0x5ab6;
  lab_0x6110:
    // 0x6110
    if (strcmp(str3, "-p") != 0) {
        goto lab_0x6160;
    } else {
        int64_t v362 = v10 + 1; // 0x6123
        if ((int32_t)v362 < v5) {
            int64_t str13 = *(int64_t *)((0x100000000 * v362 >> 29) + (int64_t)v3); // 0x6133
            g68 = strtol((char *)str13, NULL, 10);
            v12 = v362 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x6160;
        }
    }
  lab_0x6160:
    // 0x6160
    if (strcmp(str3, "-d") != 0) {
        goto lab_0x61a0;
    } else {
        int64_t v363 = v10 + 1; // 0x6173
        if ((int32_t)v363 < v5) {
            int64_t v364 = *(int64_t *)((0x100000000 * v363 >> 29) + (int64_t)v3); // 0x6183
            g58 = (char *)v364;
            v12 = v363 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x61a0;
        }
    }
  lab_0x61a0:
    // 0x61a0
    if (strcmp(str3, "-r") == 0) {
        // 0x6200
        g62 = 1;
        // 0x6207
        g74 = 1;
        v12 = v10;
        goto lab_0x5984;
    } else {
        // 0x61b3
        if (strcmp(str3, "-nor") == 0) {
            // 0x5974
            g62 = 0;
            // 0x597b
            g74 = 0;
            v12 = v10;
            goto lab_0x5984;
        } else {
            // 0x61ca
            if (strcmp(str3, "-dd") != 0) {
                goto lab_0x6213;
            } else {
                // 0x61dd
                if ((int32_t)(v10 + 1) < v5) {
                    char ** v365 = v3; // 0x61e9
                    int64_t v366; // 0x61dd
                    int64_t v367 = *(int64_t *)((0x100000000 * v366 >> 29) + (int64_t)v365); // 0x61ed
                    g63 = (char *)v367;
                    v12 = v366 & 0xffffffff;
                    goto lab_0x5984;
                } else {
                    goto lab_0x6213;
                }
            }
        }
    }
  lab_0x5984:;
    int64_t v368 = v12 + 1; // 0x5984
    int64_t v369 = v368 & 0xffffffff; // 0x5984
    v9 = v369;
    v6 = v369;
    if ((int32_t)v368 >= v5) {
        // break -> 0x64bc
        goto lab_0x64bc;
    }
    goto lab_0x5993;
  lab_0x6213:
    // 0x6213
    if (strcmp(str3, "-s") == 0) {
        // 0x597b
        g74 = 0;
        v12 = v10;
        goto lab_0x5984;
    } else {
        // 0x622a
        if (strcmp(str3, "-nos") == 0) {
            // 0x6207
            g74 = 1;
            v12 = v10;
            goto lab_0x5984;
        } else {
            // 0x623d
            if (strcmp(str3, "-u") != 0) {
                goto lab_0x6270;
            } else {
                int64_t v370 = v10 + 1; // 0x6250
                if ((int32_t)v370 < v5) {
                    int64_t v371 = *(int64_t *)((0x100000000 * v370 >> 29) + (int64_t)v3); // 0x6260
                    g55 = (char *)v371;
                    v12 = v370 & 0xffffffff;
                    goto lab_0x5984;
                } else {
                    goto lab_0x6270;
                }
            }
        }
    }
  lab_0x6270:
    // 0x6270
    if (strcmp(str3, "-c") != 0) {
        goto lab_0x62a3;
    } else {
        int64_t v372 = v10 + 1; // 0x6283
        if ((int32_t)v372 < v5) {
            int64_t v373 = *(int64_t *)((0x100000000 * v372 >> 29) + (int64_t)v3); // 0x6293
            g69 = v373;
            v12 = v372 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x62a3;
        }
    }
  lab_0x62a3:
    // 0x62a3
    if (strcmp(str3, "-t") != 0) {
        goto lab_0x62d6;
    } else {
        int64_t v374 = v10 + 1; // 0x62b6
        if ((int32_t)v374 < v5) {
            int64_t v375 = *(int64_t *)((0x100000000 * v374 >> 29) + (int64_t)v3); // 0x62c6
            g54 = (char *)v375;
            v12 = v374 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x62d6;
        }
    }
  lab_0x62d6:
    // 0x62d6
    if (strcmp(str3, "-h") != 0) {
        goto lab_0x6309;
    } else {
        int64_t v376 = v10 + 1; // 0x62e9
        if ((int32_t)v376 < v5) {
            int64_t v377 = *(int64_t *)((0x100000000 * v376 >> 29) + (int64_t)v3); // 0x62f9
            g67 = (char *)v377;
            v12 = v376 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x6309;
        }
    }
  lab_0x6309:
    // 0x6309
    if (strcmp(str3, "-l") != 0) {
        goto lab_0x633c;
    } else {
        int64_t v378 = v10 + 1; // 0x631c
        if ((int32_t)v378 < v5) {
            int64_t v379 = *(int64_t *)((0x100000000 * v378 >> 29) + (int64_t)v3); // 0x632c
            g56 = (char *)v379;
            v12 = v378 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x633c;
        }
    }
  lab_0x633c:
    // 0x633c
    if (strcmp(str3, "-v") == 0) {
        // 0x63bf
        g75 = 1;
        v12 = v10;
        goto lab_0x5984;
    } else {
        // 0x634f
        if (strcmp(str3, "-nov") == 0) {
            // 0x63cb
            g75 = 0;
            v12 = v10;
            goto lab_0x5984;
        } else {
            // 0x6362
            if (strcmp(str3, "-g") == 0) {
                // 0x63d7
                g76 = 1;
                v12 = v10;
                goto lab_0x5984;
            } else {
                // 0x6375
                if (strcmp(str3, "-nog") == 0) {
                    // 0x6449
                    g76 = 0;
                    v12 = v10;
                    goto lab_0x5984;
                } else {
                    // 0x638c
                    if (strcmp(str3, "-i") != 0) {
                        goto lab_0x63e3;
                    } else {
                        int64_t v380 = v10 + 1; // 0x639f
                        if ((int32_t)v380 < v5) {
                            int64_t v381 = *(int64_t *)((0x100000000 * v380 >> 29) + (int64_t)v3); // 0x63af
                            g60 = (char *)v381;
                            v12 = v380 & 0xffffffff;
                            goto lab_0x5984;
                        } else {
                            goto lab_0x63e3;
                        }
                    }
                }
            }
        }
    }
  lab_0x63e3:
    // 0x63e3
    if (strcmp(str3, "-T") != 0) {
        goto lab_0x6416;
    } else {
        int64_t v382 = v10 + 1; // 0x63f6
        if ((int32_t)v382 < v5) {
            int64_t v383 = *(int64_t *)((0x100000000 * v382 >> 29) + (int64_t)v3); // 0x6406
            g71 = (char *)v383;
            v12 = v382 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x6416;
        }
    }
  lab_0x6416:
    // 0x6416
    if (strcmp(str3, "-P") != 0) {
        goto lab_0x6455;
    } else {
        int64_t v384 = v10 + 1; // 0x6429
        if ((int32_t)v384 < v5) {
            int64_t v385 = *(int64_t *)((0x100000000 * v384 >> 29) + (int64_t)v3); // 0x6439
            g72 = (char *)v385;
            v12 = v384 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x6455;
        }
    }
  lab_0x6455:
    // 0x6455
    if (strcmp(str3, "-M") != 0) {
        goto lab_0x6497;
    } else {
        int64_t v386 = v10 + 1; // 0x6468
        if ((int32_t)v386 < v5) {
            int64_t str14 = *(int64_t *)((0x100000000 * v386 >> 29) + (int64_t)v3); // 0x6478
            g73 = strtol((char *)str14, NULL, 10);
            v12 = v386 & 0xffffffff;
            goto lab_0x5984;
        } else {
            goto lab_0x6497;
        }
    }
  lab_0x6497:
    // 0x6497
    if (strcmp(str3, "-D") != 0) {
        // 0x7e6c
        usage();
        // UNREACHABLE
    }
    // 0x64ae
    g59 = 1;
    v12 = v10;
    goto lab_0x5984;
  lab_0x709a:
    // 0x709a
    fprintf((struct _IO_FILE *)*(int64_t *)g22, (char *)format2, g49);
    exit(1);
    // UNREACHABLE
  lab_0x660b:
    // 0x660b
    freeaddrinfo(addr_info);
    v55 = 1;
    v59 = v58;
    v50 = v49;
    v52 = v51;
    v48 = v47;
    if ((int32_t)v47 != 0) {
        goto lab_0x66d3;
    } else {
        // 0x6622
        syslog(LOG_ERR, "can't find any valid address");
        format2 = (int64_t)"%s: can't find any valid address\n";
        goto lab_0x709a;
    }
  lab_0x66d3:
    // 0x66d3
    g50 = 0;
    g52 = 0;
    g53 = 0;
    int128_t v387 = v59; // 0x66fc
    int64_t v388 = v50; // 0x66fc
    int64_t v389 = v52; // 0x66fc
    int64_t v390 = v48; // 0x66fc
    if (g54 != NULL) {
        // 0x66fe
        v345 = (int64_t)g54;
        v3 = (char **)v48;
        v346 = (char *)(v345 & 0xffffffff);
        file3 = fopen(g54, "r");
        if (file3 == NULL) {
            // 0x7dcb
            syslog(LOG_CRIT, "%.80s - %m", v346, v50);
            // 0x68b1
            perror((char *)(0x100000000 * v345 >> 32));
            exit(1);
            // UNREACHABLE
        }
        // 0x671c
        gettimeofday((struct timeval *)&addr_info, NULL);
        char * str2 = fgets((char *)&str5, (int32_t)&g13, file3); // 0x673b
        v83 = v59;
        v85 = v50;
        if (str2 != NULL) {
            // 0x6a29
            v86 = v59;
            v87 = v50;
            while (true) {
              lab_0x6a29:;
                int64_t v88 = v87;
                v89 = v86;
                char * found_char_pos4 = strchr((char *)&str5, 35); // 0x6a31
                if (found_char_pos4 != NULL) {
                    // 0x6a3b
                    *found_char_pos4 = 0;
                }
                int32_t len = strlen((char *)&str5); // 0x6a41
                if (len < 1) {
                    // 0x6a80
                    v82 = v89;
                    v84 = v88;
                    if (len == 0) {
                        goto lab_0x6a10;
                    } else {
                        goto lab_0x6a82;
                    }
                } else {
                    int64_t v90 = (int64_t)len + 1;
                    int64_t v91 = v90 + 0xfffffffe & 0xffffffff; // 0x6a50
                    char * v92 = (char *)(v4 + 320 + v91); // 0x6a53
                    unsigned char v93 = *v92; // 0x6a53
                    while (v93 < 33) {
                        if ((1 << (int64_t)(v93 % 64) & 0x100002600) == 0) {
                            // break -> 0x6a82
                            break;
                        }
                        // 0x6a67
                        *v92 = 0;
                        int64_t v94 = v90 - 1; // 0x6a6f
                        v82 = v89;
                        v84 = v91;
                        if (v90 == 2 || v94 == 0) {
                            goto lab_0x6a10;
                        }
                        v90 = v94;
                        v91 = v90 + 0xfffffffe & 0xffffffff;
                        v92 = (char *)(v4 + 320 + v91);
                        v93 = *v92;
                    }
                    goto lab_0x6a82;
                }
            }
        }
      lab_0x6749:
        // 0x6749
        fclose(file3);
        v387 = v83;
        v388 = v85;
        v389 = (int64_t)file3;
        v390 = (int64_t)v3 & 0xffffffff;
    }
    int64_t group = 0x7fff; // 0x6770
    int32_t owner = 0x7fff; // 0x6770
    if (getuid() == 0) {
        struct passwd * v391 = getpwnam(g55); // 0x6779
        if (v391 == NULL) {
            // 0x7dee
            syslog(LOG_CRIT, "unknown user - '%.80s'", g55);
            v7 = g55;
            format3 = (int64_t)"%s: unknown user - '%s'\n";
          lab_0x7003_26:;
            int64_t stream3 = *(int64_t *)g22;
            fprintf((struct _IO_FILE *)stream3, (char *)format3, g49, v7);
            exit(1);
            // UNREACHABLE
        }
        int64_t v392 = (int64_t)v391; // 0x6779
        group = (int64_t)*(int32_t *)(v392 + 20);
        owner = *(int32_t *)(v392 + 16);
    }
    int64_t v393 = v389; // 0x6799
    int64_t v394 = 0; // 0x6799
    if (g56 != NULL) {
        // 0x679f
        if (strcmp(g56, "/dev/null") == 0) {
            // 0x7d66
            g57 = 1;
            v393 = v389;
            v394 = 0;
        } else {
            // 0x67b6
            if (strcmp(g56, "-") == 0) {
                // 0x7d74
                v393 = v389;
                v394 = *(int64_t *)*(int64_t *)0x18fd0;
            } else {
                struct _IO_FILE * file4 = fopen(g56, "a"); // 0x67d7
                if (file4 == NULL) {
                    // 0x7d83
                    syslog(LOG_CRIT, "%.80s - %m", g56, v388);
                    // 0x68b1
                    perror((char *)(int64_t)g56);
                    exit(1);
                    // UNREACHABLE
                }
                // 0x67ec
                if (*g56 != 47) {
                    // 0x67f4
                    syslog(LOG_WARNING, "logfile is not an absolute path, you may not be able to re-open it");
                    int64_t stream4 = *(int64_t *)g22; // 0x680e
                    fprintf((struct _IO_FILE *)stream4, "%s: logfile is not an absolute path, you may not be able to re-open it\n", g49);
                }
                int64_t v395 = (int64_t)file4; // 0x67d7
                fcntl(fileno(file4), F_SETFD);
                v393 = 1;
                v394 = v395;
                if (getuid() == 0) {
                    int32_t v396 = fchown(fileno(file4), owner, (int32_t)group); // 0x685a
                    v393 = group;
                    v394 = v395;
                    if (v396 < 0) {
                        // 0x6863
                        syslog(LOG_WARNING, "fchown logfile - %m", group);
                        perror("fchown logfile");
                        v393 = group;
                        v394 = v395;
                    }
                }
            }
        }
    }
    // 0x6882
    if (g58 != NULL) {
        // 0x688e
        if (chdir(g58) < 0) {
            // 0x6897
            syslog(LOG_CRIT, "chdir - %m", v393);
            // 0x68b1
            perror((char *)(int64_t)"chdir");
            exit(1);
            // UNREACHABLE
        }
    }
    // 0x68c0
    getcwd((char *)&str5, (int32_t)&g1);
    char v397 = *(char *)(v56 - 1 + (int64_t)strlen((char *)&str5)); // 0x68d5
    if (v397 != 47) {
        // 0x68dd
        *(int16_t *)(v4 + 320 + (int64_t)strlen((char *)&str5)) = 47;
    }
    // 0x68f4
    if (g59 == 0) {
        // 0x6904
        fclose((struct _IO_FILE *)*(int64_t *)*(int64_t *)0x18fd8);
        int64_t file6 = *(int64_t *)*(int64_t *)0x18fd0; // 0x691a
        if (v394 != file6) {
            // 0x6922
            fclose((struct _IO_FILE *)file6);
        }
        // 0x6927
        fclose((struct _IO_FILE *)*(int64_t *)g22);
        v95 = v393;
        format = (int64_t)"daemon - %m";
        priority = 2;
        if (daemon(1, 1) >= 0) {
            goto lab_0x6955;
        } else {
            goto lab_0x6c41;
        }
    } else {
        // 0x68fd
        setsid();
        goto lab_0x6955;
    }
  lab_0x6955:;
    int64_t v398 = v393; // 0x695f
    if (g60 != NULL) {
        struct _IO_FILE * file5 = fopen(g60, "w"); // 0x696c
        if (file5 == NULL) {
            // 0x697a
            syslog(LOG_CRIT, "%.80s - %m", g60, v388);
            // 0x6f00
            exit(1);
            // UNREACHABLE
        }
        int64_t pid = getpid(); // 0x6c15
        fprintf(file5, "%d\n", pid);
        fclose(file5);
        v398 = pid;
    }
    int32_t v399 = fdwatch_get_nfiles(); // 0x6c2b
    g61 = v399;
    v95 = v398;
    format = (int64_t)"fdwatch initialization failure";
    priority = 2;
    if (v399 >= 0) {
        // 0x6c52
        g61 = v399 - 10;
        int64_t v400 = v398; // 0x6c62
        int64_t v401 = v390; // 0x6c62
        if (g62 == 1) {
            // 0x6c68
            if (chroot((char *)&str5) < 0) {
                // 0x6c79
                syslog(LOG_CRIT, "chroot - %m", v398);
                // 0x68b1
                perror((char *)(int64_t)"chroot");
                exit(1);
                // UNREACHABLE
            }
            // 0x6c98
            v3 = (char **)(0x100000000 * v390 >> 32);
            int64_t v402 = v398; // 0x6ca6
            if (g56 != NULL) {
                // 0x6ca8
                v402 = v398;
                if (strcmp(g56, "-") != 0) {
                    int32_t len2 = strlen((char *)&str5); // 0x6cc6
                    if (strncmp(g56, (char *)&str5, len2) == 0) {
                        int64_t str15 = (int64_t)g56 - 1 + (int64_t)len2; // 0x7e4c
                        int64_t v403 = (int64_t)strlen((char *)str15) + 1; // 0x7e58
                        memmove((int64_t *)g56, (int64_t *)str15, (int32_t)v403);
                        v402 = v403;
                    } else {
                        // 0x6ce4
                        syslog(LOG_WARNING, "logfile is not within the chroot tree, you will not be able to re-open it");
                        int64_t stream5 = *(int64_t *)g22; // 0x6cfe
                        fprintf((struct _IO_FILE *)stream5, "%s: logfile is not within the chroot tree, you will not be able to re-open it\n", g49);
                        v402 = (int64_t)g49;
                    }
                }
            }
            // 0x6d1e
            str5 = 47;
            int32_t v404 = chdir((char *)&str5); // 0x6d30
            v400 = v402;
            v401 = (int64_t)v3 & 0xffffffff;
            if (v404 < 0) {
                // 0x6d3d
                syslog(LOG_CRIT, "chroot chdir - %m", v402);
                // 0x68b1
                perror((char *)(int64_t)"chroot chdir");
                exit(1);
                // UNREACHABLE
            }
        }
        // 0x6d5c
        if (g63 != NULL) {
            // 0x6d68
            if (chdir(g63) < 0) {
                // 0x6d71
                syslog(LOG_CRIT, "data_dir chdir - %m", v400);
                // 0x68b1
                perror((char *)(int64_t)"data_dir chdir");
                exit(1);
                // UNREACHABLE
            }
        }
        // 0x6d90
        sigset(15, (void (*)(int32_t))0x7e80);
        sigset(2, (void (*)(int32_t))0x7e80);
        sigset(17, (void (*)(int32_t))0x7eb0);
        sigset(13, (void (*)(int32_t))1);
        sigset(1, (void (*)(int32_t))0x7f70);
        sigset(10, (void (*)(int32_t))0x7f80);
        sigset(12, (void (*)(int32_t))0x7fc0);
        sigset(14, (void (*)(int32_t))0x7fe0);
        g64 = 0;
        g65 = 0;
        g66 = 0;
        alarm(360);
        tmr_init(360, 0x7fe0);
        int64_t v405 = v55 != 0 ? 0 : (int64_t)&v53; // 0x6e6b
        int64_t v406 = (int32_t)v401 == 0 ? 0 : (int64_t)&v54; // 0x6e77
        int64_t v407 = httpd_initialize((int64_t)g67, v405, v406, g68, g69, g70, (int64_t)g71, (int64_t)g72, (int64_t)g73, &str5, (int64_t)g57, v394, (int64_t)g74, (int64_t)g75, (int64_t)g76, g77, g78, (int64_t)g79); // 0x6eeb
        g80 = v407;
        if (v407 == 0) {
            // 0x6f00
            exit(1);
            // UNREACHABLE
        }
        int64_t v408 = g181; // 0x6f11
        int64_t v409 = tmr_create(0, 0x8030, v408, 0x1d4c0, 1); // 0x6f28
        v95 = v408;
        format = (int64_t)"tmr_create(occasional) failed";
        priority = 2;
        if (v409 != 0) {
            int64_t v410 = g181; // 0x6f3e
            int64_t v411 = tmr_create(0, 0x8050, v410, (int64_t)&g13, 1); // 0x6f55
            v95 = v410;
            format = (int64_t)"tmr_create(idle) failed";
            priority = 2;
            if (v411 != 0) {
                // 0x6f85
                if (g50 < 1) {
                    goto lab_0x6fbb;
                } else {
                    int64_t v412 = g181; // 0x6f8e
                    int64_t v413 = tmr_create(0, 0x8190, v412, (int64_t)&g201, 1); // 0x6fa5
                    v95 = v412;
                    format = (int64_t)"tmr_create(update_throttles) failed";
                    priority = 2;
                    if (v413 != 0) {
                        goto lab_0x6fbb;
                    } else {
                        goto lab_0x6c41;
                    }
                }
            } else {
                goto lab_0x6c41;
            }
        } else {
            goto lab_0x6c41;
        }
    } else {
        goto lab_0x6c41;
    }
  lab_0x6fbb:;
    int64_t v414 = g181; // 0x6fbb
    int64_t v415 = tmr_create(0, 0x83b0, v414, 0x36ee80, 1); // 0x6fd2
    v95 = v414;
    format = (int64_t)"tmr_create(show_stats) failed";
    priority = 2;
    if (v415 != 0) {
        int64_t time_val = time(NULL); // 0x7016
        g81 = time_val;
        g82 = time_val;
        g83 = 0;
        g84 = 0;
        g85 = 0;
        if (getuid() != 0) {
            goto lab_0x711d;
        } else {
            // 0x7056
            v95 = v414;
            format = (int64_t)"setgroups - %m";
            priority = 2;
            if (setgroups(0, NULL) >= 0) {
                int32_t gid = group; // 0x70ab
                v95 = v414;
                format = (int64_t)"setgid - %m";
                priority = 2;
                if (setgid(gid) >= 0) {
                    // 0x70c3
                    if (initgroups(g55, gid) < 0) {
                        // 0x70d6
                        syslog(LOG_WARNING, "initgroups - %m", v414);
                    }
                    // 0x70e9
                    v95 = v414;
                    format = (int64_t)"setuid - %m";
                    priority = 2;
                    if (setuid(owner) >= 0) {
                        // 0x7101
                        if (g62 == 0) {
                            // 0x710a
                            syslog(LOG_WARNING, "started as root without requesting chroot(), warning only");
                        }
                        goto lab_0x711d;
                    } else {
                        goto lab_0x6c41;
                    }
                } else {
                    goto lab_0x6c41;
                }
            } else {
                goto lab_0x6c41;
            }
        }
    } else {
        goto lab_0x6c41;
    }
  lab_0x711d:;
    int64_t * mem2 = malloc(144 * g61); // 0x7131
    int64_t v416 = (int64_t)mem2; // 0x7131
    g86 = v416;
    v95 = v414;
    format = (int64_t)"out of memory allocating a connecttab";
    priority = 2;
    if (mem2 != NULL) {
        int64_t v417 = v414; // 0x7150
        if (g61 >= 1) {
            uint64_t v418 = (int64_t)g61; // 0x711d
            int64_t v419 = 0; // 0x7159
            int64_t v420 = v414; // 0x7159
            if (g61 != 1) {
                int64_t v421 = v418 & 0xfffffffe; // 0x7161
                int64_t v422 = 0; // 0x716e
                int64_t v423 = v416 + 152; // 0x716e
                *(int32_t *)(v423 - 152) = 0;
                *(int32_t *)(v423 - 148) = (int32_t)v422 | 1;
                *(int64_t *)(v423 - 144) = 0;
                *(int32_t *)(v423 - 8) = 0;
                v422 += 2;
                *(int32_t *)(v423 - 4) = (int32_t)v422;
                *(int64_t *)v423 = 0;
                v423 += 288;
                v419 = v422;
                v420 = v421;
                while (v421 != v422) {
                    // 0x7170
                    *(int32_t *)(v423 - 152) = 0;
                    *(int32_t *)(v423 - 148) = (int32_t)v422 | 1;
                    *(int64_t *)(v423 - 144) = 0;
                    *(int32_t *)(v423 - 8) = 0;
                    v422 += 2;
                    *(int32_t *)(v423 - 4) = (int32_t)v422;
                    *(int64_t *)v423 = 0;
                    v423 += 288;
                    v419 = v422;
                    v420 = v421;
                }
            }
            // 0x71af
            v417 = v420;
            if (v418 % 2 != 0) {
                int64_t v424 = 144 * v419; // 0x71b9
                int64_t v425 = v424 + v416;
                *(int32_t *)v425 = 0;
                *(int32_t *)(v425 + 4) = (int32_t)v419 + 1;
                *(int64_t *)(v425 + 8) = 0;
                v417 = v424;
            }
        }
        int64_t v426 = 144 * (int64_t)g61; // 0x71d8
        *(int32_t *)(v426 - 140 + v416) = -1;
        g87 = 0;
        g89 = 0;
        g92 = 0;
        int64_t v427 = v417; // 0x720f
        if (g80 != 0) {
            int32_t v428 = *(int32_t *)(g80 + 72); // 0x7211
            int64_t v429 = v417; // 0x7217
            if (v428 != -1) {
                // 0x7219
                fdwatch_add_fd(v428, 0, 0);
                v429 = 0;
            }
            int32_t v430 = *(int32_t *)(g80 + 76); // 0x7229
            v427 = v429;
            if (v430 != -1) {
                // 0x7231
                fdwatch_add_fd(v430, 0, 0);
                v427 = 0;
            }
        }
        // 0x723a
        gettimeofday((struct timeval *)&addr_info, NULL);
        v299 = 0;
        v298 = v57;
        if (g48 != 0 == g89 < 1) {
          lab_0x7c52:
            // 0x7c52
            shut_down(v298, v299);
            syslog(LOG_NOTICE, "exiting");
            closelog();
            exit(0);
            // UNREACHABLE
        }
        // 0x7270
        v147 = &str8;
        v302 = v387;
        v304 = v426;
        v306 = v427;
        v307 = 0;
        v309 = 1;
        v311 = g70;
        while (true) {
          lab_0x7270:
            // 0x7270
            v312 = v311;
            v313 = v309;
            int64_t v314 = v307;
            int64_t v315 = v306;
            v316 = v304;
            v317 = v302;
            int64_t v318 = v315; // 0x7277
            int64_t v319 = v314; // 0x7277
            if (g64 != 0) {
                int64_t v320 = v315; // 0x7284
                int64_t v321 = v314; // 0x7284
                if (g57 == 0 && g80 != 0) {
                    // 0x7298
                    v320 = v315;
                    v321 = v314;
                    if (g56 != NULL) {
                        // 0x72a8
                        v320 = v315;
                        v321 = (int64_t)"-";
                        if (strcmp(g56, "-") != 0) {
                            // 0x72b8
                            syslog(LOG_NOTICE, "re-opening logfile");
                            struct _IO_FILE * file2 = fopen(g56, "a"); // 0x72d9
                            if (file2 == NULL) {
                                // 0x7312
                                syslog(LOG_CRIT, "re-opening %.80s - %m", g56, v316);
                                v320 = (int64_t)g56;
                                v321 = (int64_t)"re-opening %.80s - %m";
                            } else {
                                int64_t v322 = (int64_t)file2; // 0x72d9
                                fcntl(fileno(file2), F_SETFD);
                                httpd_set_logfp(g80, v322);
                                v320 = 1;
                                v321 = v322;
                            }
                        }
                    }
                }
                // 0x7330
                g64 = 0;
                v318 = v320;
                v319 = v321;
            }
            int64_t v323 = v319;
            v324 = v318;
            int64_t v325 = tmr_mstimeout((int64_t *)&addr_info, v323, v324, v316); // 0x733d
            int32_t v326 = fdwatch(v325, v323, v324, v316); // 0x734a
            if (v326 < 0) {
                int32_t v327 = *__errno_location(); // 0x7ba5
                v95 = v324;
                format = (int64_t)"fdwatch - %m";
                priority = 3;
                v301 = v317;
                v303 = v316;
                v305 = v324;
                v295 = v323;
                v297 = v325;
                v308 = v313;
                v310 = v312;
                switch (v327) {
                    case 11: {
                        goto lab_0x7c38;
                    }
                    case 4: {
                        goto lab_0x7c38;
                    }
                    default: {
                        goto lab_0x6c41;
                    }
                }
            } else {
                // 0x7352
                gettimeofday((struct timeval *)&addr_info, NULL);
                if (v326 == 0) {
                    // 0x7c30
                    tmr_run((int64_t *)&addr_info);
                    v301 = v317;
                    v303 = v316;
                    v305 = v324;
                    v295 = 0;
                    v297 = v57;
                    v308 = v313;
                    v310 = v312;
                    goto lab_0x7c38;
                } else {
                    // 0x7366
                    v328 = 0;
                    if (g80 == 0) {
                        goto lab_0x7419_3;
                    } else {
                        int32_t v329 = *(int32_t *)(g80 + 76); // 0x7376
                        v330 = 0;
                        if (v329 == -1) {
                            goto lab_0x73a1;
                        } else {
                            // 0x737e
                            v330 = 0;
                            if ((int32_t)fdwatch_check_fd(v329) == 0) {
                                goto lab_0x73a1;
                            } else {
                                uint32_t v331 = *(int32_t *)(g80 + 76); // 0x738e
                                int64_t v332 = v331; // 0x738e
                                int64_t v333 = handle_newconnect((int64_t *)&addr_info, v331); // 0x7394
                                v330 = v332;
                                v301 = v317;
                                v303 = v316;
                                v305 = v324;
                                v295 = v332;
                                v297 = v57;
                                v308 = v313;
                                v310 = v312;
                                if ((int32_t)v333 != 0) {
                                    goto lab_0x7c38;
                                } else {
                                    goto lab_0x73a1;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    goto lab_0x6c41;
}

// Address range: 0x7e80 - 0x7eac
int64_t handle_term(int64_t a1) {
    // 0x7e80
    int64_t v1; // 0x7e80
    shut_down(a1, v1);
    syslog(LOG_NOTICE, "exiting due to signal %d", a1 & 0xffffffff);
    closelog();
    exit(1);
    return &g204;
}

// Address range: 0x7eb0 - 0x7f63
int64_t handle_chld(void) {
    int32_t * v1 = __errno_location(); // 0x7eb7
    int32_t v2 = *v1; // 0x7ebf
    int64_t stat_loc; // bp-36, 0x7eb0
    int32_t v3 = waitpid(-1, (int32_t *)&stat_loc, WNOHANG); // 0x7ed6
    int32_t v4 = v3; // 0x7edd
    if (v3 == 0) {
        // 0x7f55
        *v1 = v2;
        return 0;
    }
    int64_t result; // 0x7eb0
    while (true) {
      lab_0x7f06:
        // 0x7f06
        if (v4 < 0) {
            // 0x7f30
            result = 10;
            switch (*v1) {
                case 4: {
                    goto lab_0x7ef0;
                }
                case 11: {
                    goto lab_0x7ef0;
                }
                case 10: {
                    goto lab_0x7f55;
                }
                default: {
                    goto lab_0x7f42;
                }
            }
        } else {
            // 0x7f0a
            if (g80 != 0) {
                int32_t * v5 = (int32_t *)(g80 + 36); // 0x7f16
                int32_t v6 = *v5; // 0x7f16
                *v5 = (v6 > 1 ? v6 : 1) - 1;
            }
            goto lab_0x7ef0;
        }
    }
  lab_0x7f42:
    // 0x7f42
    syslog(LOG_ERR, "child wait - %m", 1);
    // 0x7f55
    *v1 = v2;
    return &g204;
  lab_0x7ef0:
    // 0x7ef0
    v4 = waitpid(-1, (int32_t *)&stat_loc, WNOHANG);
    result = 0;
    if (v4 == 0) {
      lab_0x7f55:
        // 0x7f55
        *v1 = v2;
        return result;
    }
    goto lab_0x7f06;
}

// Address range: 0x7f70 - 0x7f7b
int64_t handle_hup(void) {
    // 0x7f70
    g64 = 1;
    int64_t result; // 0x7f70
    return result;
}

// Address range: 0x7f80 - 0x7fba
int64_t handle_usr1(void) {
    // 0x7f80
    int64_t result; // 0x7f80
    if (g89 != 0) {
        // 0x7f8a
        g65 = 1;
        return result;
    }
    // 0x7f96
    shut_down(result, result);
    syslog(LOG_NOTICE, "exiting");
    closelog();
    exit(0);
    // UNREACHABLE
}

// Address range: 0x7fc0 - 0x7fdd
int64_t handle_usr2(int64_t a1) {
    int32_t * v1 = __errno_location(); // 0x7fc3
    int64_t v2; // 0x7fc0
    int64_t result = logstats(0, v2); // 0x7fcf
    return result;
}

// Address range: 0x7fe0 - 0x8024
int64_t handle_alrm(void) {
    int32_t * v1 = __errno_location(); // 0x7fe3
    if (g66 == 0) {
        // 0x8013
        chdir("/tmp");
        abort();
        // UNREACHABLE
    }
    // 0x7ff3
    g66 = 0;
    int32_t result = alarm(360); // 0x8005
    return result;
}

// Address range: 0x8030 - 0x804a
int64_t occasional(int64_t a1, int64_t a2) {
    // 0x8030
    mmc_cleanup(a2);
    tmr_cleanup();
    g66 = 1;
    int64_t result; // 0x8030
    return result;
}

// Address range: 0x8050 - 0x8183
int64_t idle(int64_t a1, int64_t a2) {
    // 0x8050
    int64_t result; // 0x8050
    if (g61 < 1) {
        // 0x8174
        return result;
    }
    int32_t v1 = g61; // 0x808f
    int64_t v2 = 0; // 0x808b
    int64_t v3 = 0; // 0x8050
    int32_t v4; // 0x8050
    int64_t v5; // 0x8050
    int64_t v6; // 0x8050
    int64_t v7; // 0x8050
    int64_t v8; // 0x8050
    int64_t v9; // 0x8050
    int64_t v10; // 0x8050
    int64_t v11; // 0x8050
    int64_t v12; // 0x8050
    int64_t v13; // 0x8050
    int64_t v14; // 0x8050
    int64_t v15; // 0x8050
    while (true) {
      lab_0x80a6:;
        int64_t v16 = v10;
        int64_t v17 = v7;
        int64_t v18 = v14;
        int32_t v19 = v1;
        v15 = g86 + v3;
        int32_t v20 = *(int32_t *)v15; // 0x80b1
        uint32_t v21 = v20 - 2; // 0x80b5
        int64_t v22 = v21; // 0x80b5
        if (v21 >= 2) {
            // 0x8100
            v4 = v19;
            v13 = v18;
            v6 = v17;
            v9 = v16;
            if (v20 != 1) {
                goto lab_0x808b;
            } else {
                // 0x8105
                v4 = v19;
                v13 = v18;
                v6 = v17;
                v9 = v16;
                if (a2 - *(int64_t *)(v15 + 88) < 60) {
                    goto lab_0x808b;
                } else {
                    int64_t * v23 = (int64_t *)(v15 + 8); // 0x8118
                    int64_t v24 = *v23; // 0x8118
                    syslog(LOG_INFO, "%.80s connection timed out reading", (char *)httpd_ntoa(v24 + 16, a2, v18, v22, v17, v16));
                    int64_t v25 = *v23; // 0x813c
                    int64_t v26 = *(int64_t *)&g25; // 0x8148
                    int64_t v27 = (int64_t)g26; // 0x8152
                    httpd_send_err(v25, 408, v26, (int64_t)&g10, v27, (int64_t)&g10);
                    httpd_write_response(*v23, 408, v26);
                    v11 = (int64_t)&g10;
                    v12 = v26;
                    v5 = v27;
                    v8 = (int64_t)&g10;
                    goto lab_0x8080;
                }
            }
        } else {
            // 0x80bd
            v4 = v19;
            v13 = v18;
            v6 = v17;
            v9 = v16;
            if (a2 - *(int64_t *)(v15 + 88) < 300) {
                goto lab_0x808b;
            } else {
                int64_t v28 = httpd_ntoa(*(int64_t *)(v15 + 8) + 16, a2, v18, v22, v17, v16); // 0x80d7
                syslog(LOG_INFO, "%.80s connection timed out sending", (char *)v28);
                v11 = v22;
                v12 = v28;
                v5 = v17;
                v8 = v16;
                goto lab_0x8080;
            }
        }
    }
    // 0x8174
    return result;
  lab_0x808b:
    // 0x808b
    v1 = v4;
    v2++;
    int64_t v29 = v1; // 0x808f
    v14 = v13;
    v7 = v6;
    v10 = v9;
    v3 += 144;
    result = v29;
    if (v2 >= v29) {
        return result;
    }
    goto lab_0x80a6;
  lab_0x8080:
    // 0x8080
    clear_connection(v15, (int64_t *)a2, v12, v11, v5);
    v4 = g61;
    v13 = v12;
    v6 = v5;
    v9 = v8;
    goto lab_0x808b;
}

// Address range: 0x8190 - 0x83af
int64_t update_throttles(void) {
    // 0x8190
    int64_t result; // 0x8190
    if ((uint32_t)g50 >= 1) {
        int64_t v1 = 40; // 0x81d6
        int64_t v2 = 0;
        *(int64_t *)(v1 + g53 - 8) = 0;
        int64_t v3 = g53 + v1;
        int64_t v4 = *(int64_t *)(v3 - 24); // 0x8276
        int64_t v5 = *(int64_t *)(v3 - 16); // 0x827b
        int32_t v6; // 0x8289
        int64_t v7; // 0x8294
        if (v5 < v4) {
            // 0x8289
            v6 = *(int32_t *)v3;
            if (v6 != 0) {
                // 0x8294
                v7 = *(int64_t *)(v3 - 40);
                syslog(LOG_NOTICE, "throttle #%d '%.80s' rate %ld lower than minimum %ld; %d sending", v2, (char *)v7, (int32_t)v5, (int32_t)v4, (int64_t)v6);
            }
        }
        int64_t v8 = v2 + 1; // 0x81e0
        int64_t v9 = g50; // 0x81e4
        v1 += 48;
        result = v9;
        while (v8 < v9) {
            // 0x81f8
            v2 = v8;
            *(int64_t *)(v1 + g53 - 8) = 0;
            // 0x826f
            v3 = g53 + v1;
            v4 = *(int64_t *)(v3 - 24);
            v5 = *(int64_t *)(v3 - 16);
            if (v5 < v4) {
                // 0x8289
                v6 = *(int32_t *)v3;
                if (v6 != 0) {
                    // 0x8294
                    v7 = *(int64_t *)(v3 - 40);
                    syslog(LOG_NOTICE, "throttle #%d '%.80s' rate %ld lower than minimum %ld; %d sending", v2, (char *)v7, (int32_t)v5, (int32_t)v4, (int64_t)v6);
                }
            }
            // 0x81e0
            v8 = v2 + 1;
            v9 = g50;
            v1 += 48;
            result = v9;
        }
    }
    // 0x82ba
    if (g61 < 1) {
        // 0x83a0
        return result;
    }
    int64_t v10 = 0; // 0x82df
    int64_t v11 = g86 + 16;
    int64_t v12 = 144 * v10; // 0x830b
    int64_t v13 = v12 + g86;
    int64_t result2 = v12; // 0x8319
    int64_t v14; // 0x8190
    int64_t v15; // 0x8190
    int64_t v16; // 0x8190
    int64_t v17; // 0x8190
    int64_t * v18; // 0x8190
    uint32_t v19; // 0x8324
    int64_t v20; // 0x8324
    int64_t v21; // 0x8190
    uint64_t v22; // 0x8384
    uint32_t v23; // 0x8389
    uint64_t v24; // 0x8389
    int64_t v25; // 0x8355
    int64_t v26; // 0x8366
    int64_t v27; // 0x836a
    if ((*(int32_t *)v13 & -2) == 2) {
        // 0x831b
        v18 = (int64_t *)(v13 + 64);
        *v18 = -1;
        v19 = *(int32_t *)(v13 + 56);
        v20 = v19;
        result2 = v12;
        v14 = 0;
        if (v19 >= 1) {
            v15 = -1;
            v21 = 48 * (int64_t)*(int32_t *)(4 * v14 + v11) + g53;
            v22 = *(int64_t *)(v21 + 8);
            v23 = *(int32_t *)(v21 + 40);
            v24 = (int64_t)v23;
            if ((v22 || v24) >= 0x100000000) {
                // 0x8350
                v16 = v22 / v24;
            } else {
                // 0x839a
                v16 = (int32_t)v22 / v23;
            }
            // 0x8355
            v17 = v16;
            v25 = v15 - v17;
            v26 = v15 == -1 | v25 < 0 == ((v25 ^ v15) & (v17 ^ v15)) < 0 ? v17 : v15;
            v27 = v14 + 1;
            v14 = v27;
            while (v27 != v20) {
                // 0x8377
                v15 = v26;
                v21 = 48 * (int64_t)*(int32_t *)(4 * v14 + v11) + g53;
                v22 = *(int64_t *)(v21 + 8);
                v23 = *(int32_t *)(v21 + 40);
                v24 = (int64_t)v23;
                if ((v22 || v24) >= 0x100000000) {
                    // 0x8350
                    v16 = v22 / v24;
                } else {
                    // 0x839a
                    v16 = (int32_t)v22 / v23;
                }
                // 0x8355
                v17 = v16;
                v25 = v15 - v17;
                v26 = v15 == -1 | v25 < 0 == ((v25 ^ v15) & (v17 ^ v15)) < 0 ? v17 : v15;
                v27 = v14 + 1;
                v14 = v27;
            }
            // 0x82f0
            *v18 = v26;
            result2 = v17;
        }
    }
    // 0x82f3
    v10++;
    int64_t v28 = v11 + 144; // 0x8301
    while (v10 != (int64_t)g61) {
        // 0x8307
        v11 = v28;
        v12 = 144 * v10;
        v13 = v12 + g86;
        result2 = v12;
        if ((*(int32_t *)v13 & -2) == 2) {
            // 0x831b
            v18 = (int64_t *)(v13 + 64);
            *v18 = -1;
            v19 = *(int32_t *)(v13 + 56);
            v20 = v19;
            result2 = v12;
            v14 = 0;
            if (v19 >= 1) {
                v15 = -1;
                v21 = 48 * (int64_t)*(int32_t *)(4 * v14 + v11) + g53;
                v22 = *(int64_t *)(v21 + 8);
                v23 = *(int32_t *)(v21 + 40);
                v24 = (int64_t)v23;
                if ((v22 || v24) >= 0x100000000) {
                    // 0x8350
                    v16 = v22 / v24;
                } else {
                    // 0x839a
                    v16 = (int32_t)v22 / v23;
                }
                // 0x8355
                v17 = v16;
                v25 = v15 - v17;
                v26 = v15 == -1 | v25 < 0 == ((v25 ^ v15) & (v17 ^ v15)) < 0 ? v17 : v15;
                v27 = v14 + 1;
                v14 = v27;
                while (v27 != v20) {
                    // 0x8377
                    v15 = v26;
                    v21 = 48 * (int64_t)*(int32_t *)(4 * v14 + v11) + g53;
                    v22 = *(int64_t *)(v21 + 8);
                    v23 = *(int32_t *)(v21 + 40);
                    v24 = (int64_t)v23;
                    if ((v22 || v24) >= 0x100000000) {
                        // 0x8350
                        v16 = v22 / v24;
                    } else {
                        // 0x839a
                        v16 = (int32_t)v22 / v23;
                    }
                    // 0x8355
                    v17 = v16;
                    v25 = v15 - v17;
                    v26 = v15 == -1 | v25 < 0 == ((v25 ^ v15) & (v17 ^ v15)) < 0 ? v17 : v15;
                    v27 = v14 + 1;
                    v14 = v27;
                }
                // 0x82f0
                *v18 = v26;
                result2 = v17;
            }
        }
        // 0x82f3
        v10++;
        v28 = v11 + 144;
    }
    // 0x83a0
    return result2;
}

// Address range: 0x83b0 - 0x83b8
int64_t show_stats(int64_t a1, int64_t a2) {
    // 0x83b0
    return logstats((int32_t)a2, a2);
}

// Address range: 0x83c0 - 0x856a
int64_t handle_newconnect(int64_t * a1, uint32_t a2) {
    // 0x83c0
    int64_t result; // 0x83c0
    if ((uint32_t)g89 >= g61) {
      lab_0x8511:
        // 0x8511
        syslog(LOG_WARNING, "too many connections!");
      lab_0x8524:
        // 0x8524
        tmr_run(a1);
        result = 0;
        // 0x852e
        return result;
    }
    // 0x83e0
    int64_t format; // 0x83c0
    while (true) {
      lab_0x83fc:
        // 0x83fc
        format = (int64_t)"the connects free list is messed up";
        if (g87 == -1) {
            // break -> 0x854b
            break;
        }
        int64_t v1 = g86 + 144 * (int64_t)g87;
        int32_t * v2 = (int32_t *)v1; // 0x841c
        format = (int64_t)"the connects free list is messed up";
        if (*v2 != 0) {
            // break -> 0x854b
            break;
        }
        // 0x8427
        int128_t v3; // 0x83c0
        int128_t v4 = v3;
        int64_t * v5 = (int64_t *)(v1 + 8);
        int64_t v6 = *v5; // 0x842f
        int64_t v7 = v6; // 0x8437
        if (v6 == 0) {
            int64_t * mem = malloc(720); // 0x843e
            v7 = (int64_t)mem;
            *v5 = v7;
            format = (int64_t)"out of memory allocating an httpd_conn";
            if (mem == NULL) {
                // break -> 0x854b
                break;
            }
            // 0x8450
            *(int32_t *)mem = 0;
            g92 = &g93;
        }
        // 0x845d
        result = 1;
        switch ((int32_t)v8) {
            case 0: {
                goto lab_0x8524;
            }
            case 2: {
                return result;
            }
            default: {
                // 0x8480
                *v2 = 1;
                int32_t * v9 = (int32_t *)(v1 + 4); // 0x848c
                g87 = *v9;
                *v9 = -1;
                g89 = &g90;
                *(int64_t *)(v1 + 88) = g80;
                *(int64_t *)(v1 + 136) = 0;
                *(int32_t *)(v1 + 56) = 0;
                int128_t v10 = __asm_xorps(v4, v4); // 0x84c1
                __asm_movups(*(int128_t *)(v1 + 96), v10);
                httpd_set_ndelay(*(int32_t *)(*v5 + 704), (int64_t)a2, v7);
                fdwatch_add_fd(*(int32_t *)(*v5 + 704), (int32_t)v1, 0);
                g83++;
                int32_t v11 = g89; // 0x84f4
                if (v11 > g85) {
                    // 0x8506
                    g85 = v11;
                }
                // 0x83f0
                v3 = v10;
                if (g61 <= v11) {
                    goto lab_0x8511;
                }
                goto lab_0x83fc;
            }
        }
    }
    // 0x854b
    syslog(LOG_CRIT, (char *)format);
    exit(1);
    // UNREACHABLE
}

// Address range: 0x8570 - 0x867c
int64_t clear_connection(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5) {
    int64_t * v1 = (int64_t *)(a1 + 96); // 0x857a
    int64_t v2 = *v1; // 0x857a
    int64_t v3 = v2; // 0x857a
    int32_t v4 = 0; // 0x8581
    if (v2 != 0) {
        // 0x8590
        tmr_cancel(v2);
        *v1 = 0;
        v4 = *(int32_t *)&v3;
        if (v4 == 4) {
            int64_t * v5 = (int64_t *)(a1 + 104); // 0x8595
            tmr_cancel(*v5);
            *v5 = 0;
            *(int32_t *)(*(int64_t *)(a1 + 8) + 556) = 0;
            // 0x864d
            return really_clear_connection(a1, a2, a3);
        }
    }
    int64_t * v6 = (int64_t *)(a1 + 8); // 0x85b9
    int64_t v7 = *v6; // 0x85b9
    if (*(int32_t *)(v7 + 556) == 0) {
        // 0x864d
        return really_clear_connection(a1, a2, a3);
    }
    int64_t v8 = v7; // 0x85cd
    if (v4 != 3) {
        // 0x85cf
        fdwatch_del_fd(*(int32_t *)(v7 + 704));
        v8 = *v6;
    }
    // 0x85de
    *(int32_t *)a1 = 4;
    shutdown(*(int32_t *)(v8 + 704), SHUT_WR);
    fdwatch_add_fd(*(int32_t *)(*v6 + 704), (int32_t)a1, 0);
    int64_t * v9 = (int64_t *)(a1 + 104); // 0x8608
    if (*v9 != 0) {
        // 0x860f
        syslog(LOG_ERR, "replacing non-null linger_timer!");
    }
    int64_t result = tmr_create((int32_t)(int64_t)a2, 0x89f0, a1, 500, 0); // 0x8637
    *v9 = result;
    if (result != 0) {
        // 0x8645
        return result;
    }
    // 0x865f
    syslog(LOG_CRIT, "tmr_create(linger_clear_connection) failed");
    exit(1);
    // UNREACHABLE
}

// Address range: 0x8680 - 0x879d
int64_t shut_down(int64_t a1, int64_t a2) {
    // 0x8680
    int64_t tp; // bp-48, 0x8680
    gettimeofday((struct timeval *)&tp, NULL);
    int64_t v1 = &tp; // 0x869a
    logstats((int32_t)v1, 0);
    int64_t v2 = 0; // 0x86a9
    int64_t v3 = v1; // 0x86a9
    int64_t v4; // 0x8680
    if (g61 >= 1) {
        int64_t v5 = 0; // 0x86c3
        int64_t v6 = 8;
        int64_t v7 = g86 + v6;
        int64_t v8 = v7; // 0x86ed
        int64_t v9 = 0; // 0x86ed
        if (*(int32_t *)(v7 - 8) != 0) {
            // 0x86ef
            httpd_close_conn(*(int64_t *)v7, &tp, v4, v4, v4, v4);
            v8 = g86 + v6;
            v9 = v1;
        }
        int64_t v10 = v9;
        int64_t v11 = *(int64_t *)v8; // 0x8702
        int64_t v12 = 0; // 0x8709
        int64_t v13 = g86; // 0x8709
        int64_t * v14; // 0x8717
        if (v11 != 0) {
            // 0x870b
            httpd_destroy_conn(v11);
            v13 = g86;
            v14 = (int64_t *)(v13 + v6);
            v12 = *v14;
            free((int64_t *)v12);
            g92 = &g91;
            *v14 = 0;
        }
        int64_t v15 = v13;
        v5++;
        int64_t v16 = v6 + 144; // 0x86e5
        v2 = v10;
        v3 = v12;
        while (v5 < (int64_t)g61) {
            // 0x86e7
            v6 = v16;
            v7 = v15 + v6;
            v8 = v7;
            v9 = v10;
            int64_t v17 = v15; // 0x86ed
            if (*(int32_t *)(v7 - 8) != 0) {
                // 0x86ef
                httpd_close_conn(*(int64_t *)v7, &tp, v4, v4, v4, v4);
                v17 = g86;
                v8 = v17 + v6;
                v9 = v1;
            }
            // 0x8702
            v10 = v9;
            v11 = *(int64_t *)v8;
            v12 = 0;
            v13 = v17;
            if (v11 != 0) {
                // 0x870b
                httpd_destroy_conn(v11);
                v13 = g86;
                v14 = (int64_t *)(v13 + v6);
                v12 = *v14;
                free((int64_t *)v12);
                g92 = &g91;
                *v14 = 0;
            }
            // 0x86d0
            v15 = v13;
            v5++;
            v16 = v6 + 144;
            v2 = v10;
            v3 = v12;
        }
    }
    // 0x8731
    if (v3 != 0) {
        // 0x873d
        g80 = 0;
        int32_t v18 = *(int32_t *)(v3 + 72); // 0x8748
        if (v18 != -1) {
            // 0x8750
            fdwatch_del_fd(v18);
        }
        int32_t v19 = *(int32_t *)(v3 + 76); // 0x8755
        if (v19 != -1) {
            // 0x875d
            fdwatch_del_fd(v19);
        }
        // 0x8762
        httpd_terminate(v3);
    }
    // 0x876a
    mmc_term();
    tmr_term(v3, v2, v4, v4, v4, v4);
    free((int64_t *)g86);
    if (g53 != 0) {
        // 0x878c
        free((int64_t *)g53);
    }
    // 0x8791
    return &g204;
}

// Address range: 0x87a0 - 0x8891
int64_t logstats(int32_t a1, int64_t a2) {
    int64_t v1 = a1; // 0x87ab
    if (a1 == 0) {
        // 0x87ad
        int64_t tp; // bp-24, 0x87a0
        gettimeofday((struct timeval *)&tp, NULL);
        v1 = &tp;
    }
    int64_t v2 = *(int64_t *)v1; // 0x87ba
    int64_t v3 = v2 - g81; // 0x87ca
    uint64_t v4 = v3 != 0 ? v3 : 1; // 0x87d6
    g81 = v2;
    syslog(LOG_NOTICE, "up %ld seconds, stats for %ld seconds:", (int32_t)(v2 - g82), (int32_t)v4);
    if (v4 >= 1) {
        int128_t v5 = __asm_cvtsi2ss((int64_t)g83); // 0x8803
        int128_t v6 = __asm_cvtsi2ss(v4); // 0x8808
        int128_t v7 = __asm_cvtss2sd(__asm_divss(v5, v6)); // 0x8811
        int128_t v8 = __asm_divss(__asm_cvtsi2ss(g84), v6); // 0x8827
        __asm_xorps(v6, v6);
        syslog(LOG_NOTICE, "  thttpd - %ld connections (%g/sec), %d max simultaneous, %lld bytes (%g/sec), %d httpd_conns allocated", g83, (float64_t)(int64_t)v7, (int64_t)g85, g84, (float64_t)(int64_t)__asm_cvtss2sd(v8), (int64_t)g92);
    }
    // 0x884c
    g83 = 0;
    g84 = 0;
    g85 = 0;
    httpd_logstats();
    mmc_logstats();
    fdwatch_logstats(v4);
    return tmr_logstats();
}

// Address range: 0x88a0 - 0x88ca
int64_t usage(void) {
    int64_t stream = *(int64_t *)g22; // 0x88a8
    fprintf((struct _IO_FILE *)stream, "usage:  %s [-C configfile] [-p port] [-d dir] [-r|-nor] [-dd data_dir] [-s|-nos] [-v|-nov] [-g|-nog] [-u user] [-c cgipat] [-t throttles] [-h host] [-l logfile] [-i pidfile] [-T charset] [-P P3P] [-M maxage] [-V] [-D]\n", g49);
    exit(1);
    // UNREACHABLE
}

// Address range: 0x88d0 - 0x88fb
int64_t wakeup_connection(int64_t a1) {
    int64_t v1 = a1;
    *(int64_t *)(a1 + 96) = 0;
    if (*(int32_t *)&v1 != 3) {
        // 0x88fa
        int64_t result; // 0x88d0
        return result;
    }
    // 0x88dd
    *(int32_t *)v1 = 2;
    int64_t v2 = *(int64_t *)(v1 + 8); // 0x88e6
    return fdwatch_add_fd(*(int32_t *)(v2 + 704), (int32_t)v1, 1);
}

// Address range: 0x8900 - 0x89ee
int64_t really_clear_connection(int64_t a1, int64_t * a2, int64_t a3) {
    int64_t * v1 = (int64_t *)(a1 + 8); // 0x8907
    int64_t v2 = *v1; // 0x8907
    g84 += *(int64_t *)(v2 + 200);
    int64_t v3 = v2; // 0x891f
    if ((int32_t)v2 != 3) {
        // 0x8921
        fdwatch_del_fd(*(int32_t *)(v2 + 704));
        v3 = *v1;
    }
    // 0x8930
    int64_t v4; // 0x8900
    httpd_close_conn(v3, a2, a3, v4, v4, v4);
    uint32_t v5 = *(int32_t *)(a1 + 56); // 0x8938
    if (v5 >= 1) {
        uint64_t v6 = (int64_t)v5; // 0x8938
        int64_t v7 = 0; // 0x8949
        if (v5 != 1) {
            int64_t v8 = g53 + 40; // 0x896d
            int64_t v9 = 0; // 0x8956
            int64_t v10 = 4 * v9; // 0x8960
            int32_t * v11 = (int32_t *)(48 * (int64_t)*(int32_t *)(a1 + 16 + v10) + v8); // 0x896d
            *v11 = *v11 - 1;
            int32_t * v12 = (int32_t *)(48 * (int64_t)*(int32_t *)(v10 + a1 + 20) + v8); // 0x897f
            *v12 = *v12 - 1;
            int64_t v13 = v9 + 2; // 0x8984
            v9 = v13;
            while ((v6 & 0xfffffffe) != v13) {
                // 0x8960
                v10 = 4 * v9;
                v11 = (int32_t *)(48 * (int64_t)*(int32_t *)(a1 + 16 + v10) + v8);
                *v11 = *v11 - 1;
                v12 = (int32_t *)(48 * (int64_t)*(int32_t *)(v10 + a1 + 20) + v8);
                *v12 = *v12 - 1;
                v13 = v9 + 2;
                v9 = v13;
            }
            // 0x898d
            v7 = 4 * v13;
        }
        if (v6 % 2 != 0) {
            int32_t v14 = *(int32_t *)(a1 + 16 + v7); // 0x8991
            int32_t * v15 = (int32_t *)(g53 + 40 + 48 * (int64_t)v14); // 0x899e
            *v15 = *v15 - 1;
        }
    }
    int64_t * v16 = (int64_t *)(a1 + 104); // 0x89a3
    int64_t v17 = *v16; // 0x89a3
    if (v17 != 0) {
        // 0x89ac
        tmr_cancel(v17);
        *v16 = 0;
    }
    // 0x89b9
    *(int32_t *)a1 = 0;
    *(int32_t *)(a1 + 4) = g87;
    int64_t v18 = 0x38e38e39 * (a1 - g86) / 16; // 0x89d3
    g87 = v18;
    g89 = &g88;
    return v18 & 0xffffffff;
}

// Address range: 0x89f0 - 0x89fd
int64_t linger_clear_connection(int64_t a1) {
    // 0x89f0
    *(int64_t *)(a1 + 104) = 0;
    int64_t v1; // 0x89f0
    return really_clear_connection(a1, (int64_t *)v1, v1);
}

// Address range: 0x8a00 - 0x8e9a
int64_t httpd_initialize(int64_t str, int64_t a2, int64_t a3, int16_t a4, int64_t a5, int32_t a6, int64_t str5, int64_t str6, int64_t a9, int64_t * str7, int64_t a11, int64_t a12, int64_t a13, int64_t a14, int64_t a15, int64_t str8, int64_t str9, int64_t a18) {
    // 0x8a00
    int128_t v1; // 0x8a00
    int128_t v2 = v1;
    int64_t v3 = a5;
    int64_t * mem = malloc(136); // 0x8a27
    if (mem == NULL) {
        // 0x8be1
        syslog(LOG_CRIT, (char *)(int64_t)"out of memory allocating an httpd_server");
        // 0x8bf0
        return 0;
    }
    int64_t result = (int64_t)mem; // 0x8a27
    if (str == 0) {
        // 0x8a5b
        __asm_movups(*(int128_t *)mem, __asm_xorps(v2, v2));
        if (gethostname((char *)&g94, 256) < 0) {
            // 0x8a9c
            *(char *)&g94 = 0;
        } else {
            int64_t * v4 = (int64_t *)(result + 8); // 0x8a7a
            if (!((*v4 != 0 | *(char *)&g94 == 0))) {
                // 0x8a8a
                *v4 = (int64_t)&g94;
            }
        }
    } else {
        char * v5 = strdup((char *)str); // 0x8a3c
        int64_t v6 = (int64_t)v5; // 0x8a3c
        *mem = v6;
        if (v5 == NULL) {
            // 0x8be1
            syslog(LOG_CRIT, (char *)(int64_t)"out of memory copying hostname");
            // 0x8bf0
            return 0;
        }
        // 0x8a49
        *(int64_t *)(result + 8) = v6;
    }
    int16_t * v7 = (int16_t *)(result + 16); // 0x8aa3
    *v7 = a4;
    if (a5 == 0) {
        // 0x8b25
        *(int64_t *)(result + 24) = 0;
    } else {
        char * str2 = strdup((char *)((int64_t)(*(char *)&v3 == 47) + a5)); // 0x8aba
        int64_t * str4 = (int64_t *)(result + 24); // 0x8abf
        *str4 = (int64_t)str2;
        if (str2 == NULL) {
            // 0x8be1
            syslog(LOG_CRIT, (char *)(int64_t)"out of memory copying cgi_pattern");
            // 0x8bf0
            return 0;
        }
        char * substr_pos = strstr(str2, "|/"); // 0x8ad6
        if (substr_pos != NULL) {
            int64_t v8 = (int64_t)substr_pos;
            int64_t str3 = v8 + 2; // 0x8af4
            memmove((int64_t *)(v8 + 1), (int64_t *)str3, strlen((char *)str3) + 1);
            char * substr_pos2 = strstr((char *)*str4, "|/"); // 0x8b16
            while (substr_pos2 != NULL) {
                // 0x8af0
                v8 = (int64_t)substr_pos2;
                str3 = v8 + 2;
                memmove((int64_t *)(v8 + 1), (int64_t *)str3, strlen((char *)str3) + 1);
                substr_pos2 = strstr((char *)*str4, "|/");
            }
        }
    }
    // 0x8b2d
    *(int32_t *)(result + 32) = a6;
    *(int32_t *)(result + 36) = 0;
    *(int64_t *)(result + 40) = (int64_t)strdup((char *)str5);
    *(int64_t *)(result + 48) = (int64_t)strdup((char *)str6);
    *(int32_t *)(result + 56) = (int32_t)a9;
    char * v9 = strdup((char *)str7); // 0x8b68
    *(int64_t *)(result + 64) = (int64_t)v9;
    if (v9 == NULL) {
        // 0x8be1
        syslog(LOG_CRIT, (char *)(int64_t)"out of memory copying cwd");
        // 0x8bf0
        return 0;
    }
    if (str8 == 0) {
        // 0x8baf
        *(int64_t *)(result + 112) = 0;
    } else {
        char * v10 = strdup((char *)str8); // 0x8b83
        *(int64_t *)(result + 112) = (int64_t)v10;
        if (v10 == NULL) {
            // 0x8be1
            syslog(LOG_CRIT, (char *)(int64_t)"out of memory copying url_pattern");
            // 0x8bf0
            return 0;
        }
    }
    if (str9 == 0) {
        // 0x8c02
        *(int64_t *)(result + 120) = 0;
    } else {
        char * v11 = strdup((char *)str9); // 0x8bc7
        *(int64_t *)(result + 120) = (int64_t)v11;
        if (v11 == NULL) {
            // 0x8be1
            syslog(LOG_CRIT, (char *)(int64_t)"out of memory copying local_pattern");
            // 0x8bf0
            return 0;
        }
    }
    int64_t v12 = a6;
    *(int32_t *)(result + 80) = (int32_t)a11;
    *(int64_t *)(result + 88) = a12;
    int32_t v13 = a13; // 0x8c3c
    *(int32_t *)(result + 96) = v13;
    int32_t v14 = a14; // 0x8c40
    *(int32_t *)(result + 100) = v14;
    int32_t v15 = a15; // 0x8c44
    *(int32_t *)(result + 104) = v15;
    *(int32_t *)(result + 128) = (int32_t)a18;
    int32_t v16 = -1; // 0x8c52
    if (a3 != 0) {
        // 0x8c54
        v16 = initialize_listen_socket(a3, v13, v14, v15, v3, v12);
    }
    int32_t * v17 = (int32_t *)(result + 76); // 0x8c63
    *v17 = v16;
    int64_t v18; // 0x8a00
    if (a2 == 0) {
        int64_t v19 = result + 72; // 0x8ca0
        *(int32_t *)v19 = -1;
        v18 = v19;
        if (v16 == -1) {
            // 0x8c8d
            free_httpd_server(result);
            // 0x8bf0
            return 0;
        }
    } else {
        int64_t v20 = result + 72; // 0x8c77
        int32_t v21 = initialize_listen_socket(a2, v13, v14, v15, v3, v12); // 0x8c7b
        *(int32_t *)v20 = v21;
        v18 = v20;
        if (v21 == -1) {
            // 0x8c84
            v18 = v20;
            if (*v17 == -1) {
                // 0x8c8d
                free_httpd_server(result);
                // 0x8bf0
                return 0;
            }
        }
    }
    // 0x8cb1
    qsort((int64_t *)&g29, 3, 32, (int32_t (*)(int64_t *, int64_t *))0xee60);
    qsort((int64_t *)&g41, 193, 32, (int32_t (*)(int64_t *, int64_t *))0xee60);
    g30 = strlen((char *)g29);
    g32 = strlen(g31);
    g34 = strlen(g33);
    g36 = strlen(g35);
    g38 = strlen(g37);
    g40 = strlen(g39);
    int64_t v22 = 24; // 0x8d6e
    int64_t str10 = *(int64_t *)(v22 + (int64_t)&g41 - 24); // 0x8d70
    int32_t len = strlen((char *)str10); // 0x8d75
    *(int64_t *)(v22 + (int64_t)&g41 - 16) = (int64_t)len;
    int64_t str11 = *(int64_t *)(v22 + (int64_t)&g41 - 8); // 0x8d7f
    int32_t len2 = strlen((char *)str11); // 0x8d84
    *(int64_t *)(v22 + (int64_t)&g41) = (int64_t)len2;
    v22 += 32;
    while (v22 != (int64_t)&g19) {
        // 0x8d70
        str10 = *(int64_t *)(v22 + (int64_t)&g41 - 24);
        len = strlen((char *)str10);
        *(int64_t *)(v22 + (int64_t)&g41 - 16) = (int64_t)len;
        str11 = *(int64_t *)(v22 + (int64_t)&g41 - 8);
        len2 = strlen((char *)str11);
        *(int64_t *)(v22 + (int64_t)&g41) = (int64_t)len2;
        v22 += 32;
    }
    // 0x8d9a
    if (*mem == 0) {
        // 0x8df7
        syslog(LOG_NOTICE, "%.80s starting on port %d", "thttpd/2.29 23May2018", (int64_t)*v7);
        // 0x8bf0
        return result;
    }
    int64_t sa = *(int32_t *)v18 == -1 ? a3 : a2; // 0x8da5
    int16_t v23 = *(int16_t *)sa; // 0x8da9
    int32_t salen = v23 != 2 ? v23 != 10 ? 0 : 28 : 16; // 0x8dc4
    uint16_t v24; // 0x8e6f
    if (getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1) != 0) {
        // 0x8dec
        *(int16_t *)&g99 = 63;
        // 0x8e6f
        v24 = *v7;
        syslog(LOG_NOTICE, "%.80s starting on %.80s, port %d", "thttpd/2.29 23May2018", (char *)&g99, (int64_t)v24);
        // 0x8bf0
        return result;
    }
    // 0x8e1b
    if (*(int32_t *)(sa + 8) != 0 || *(int32_t *)(sa + 12) != 0 || *(int32_t *)(sa + 16) != -0x10000) {
        // 0x8e6f
        v24 = *v7;
        syslog(LOG_NOTICE, "%.80s starting on %.80s, port %d", "thttpd/2.29 23May2018", (char *)&g99, (int64_t)v24);
        // 0x8bf0
        return result;
    }
    // 0x8e33
    if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
        int32_t len3 = strlen((char *)&g101); // 0x8e57
        memmove((int64_t *)&g99, (int64_t *)&g101, len3 + 1);
    }
    // 0x8e6f
    v24 = *v7;
    syslog(LOG_NOTICE, "%.80s starting on %.80s, port %d", "thttpd/2.29 23May2018", (char *)&g99, (int64_t)v24);
    // 0x8bf0
    return result;
}

// Address range: 0x8ea0 - 0x8ec4
int64_t httpd_set_logfp(int64_t a1, int64_t a2) {
    int64_t * v1 = (int64_t *)(a1 + 88); // 0x8eaa
    int64_t file = *v1; // 0x8eaa
    int64_t result; // 0x8ea0
    if (file != 0) {
        // 0x8eb3
        result = fclose((struct _IO_FILE *)file);
    }
    // 0x8eb8
    *v1 = a2;
    return result;
}

// Address range: 0x8ed0 - 0x91b9
int64_t initialize_listen_socket(int64_t sa, int32_t a2, int32_t a3, int32_t a4, int64_t a5, int64_t a6) {
    // 0x8ed0
    int64_t v1; // 0x8ed0
    int16_t v2 = v1;
    if ((v2 & -9) != 2) {
        // 0x8fe7
        syslog(LOG_CRIT, "unknown sockaddr family on listen socket");
        // 0x91a9
        return 0xffffffff;
    }
    int32_t sock_fd = socket((int32_t)v1 % 0x10000, SOCK_STREAM, IPPROTO_IP); // 0x8efa
    if (sock_fd < 0) {
        int32_t salen = v2 != 2 ? v2 != 10 ? 0 : 28 : 16; // 0x9018
        if (getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1) != 0) {
            // 0x9040
            *(int16_t *)&g99 = 63;
            // 0x90f9
            syslog(LOG_CRIT, "socket %.80s - %m", (char *)&g99, 200);
            // 0x91a9
            return 0xffffffff;
        }
        // 0x90a5
        if (*(int32_t *)(sa + 8) != 0 || *(int32_t *)(sa + 12) != 0 || *(int32_t *)(sa + 16) != -0x10000) {
            // 0x90f9
            syslog(LOG_CRIT, "socket %.80s - %m", (char *)&g99, 200);
            // 0x91a9
            return 0xffffffff;
        }
        uint32_t v3 = g100 ^ 0x3a666666 | *(int32_t *)&g99 ^ 0x66663a3a; // 0x90d3
        if (v3 == 0) {
            int32_t len = strlen((char *)&g101); // 0x90e1
            memmove((int64_t *)&g99, (int64_t *)&g101, len + 1);
        }
        // 0x90f9
        syslog(LOG_CRIT, "socket %.80s - %m", (char *)&g99, (int64_t)v3);
        // 0x91a9
        return 0xffffffff;
    }
    // 0x8f07
    fcntl(sock_fd, F_SETFD);
    int32_t option_value = 1; // bp-44, 0x8f1f
    if (setsockopt(sock_fd, SO_DEBUG, 2, (int64_t *)&option_value, 4) < 0) {
        // 0x8f48
        syslog(LOG_CRIT, "setsockopt SO_REUSEADDR - %m", 2);
    }
    struct sockaddr * addr = (struct sockaddr *)sa; // 0x8f81
    if (bind(sock_fd, addr, v2 == 2 ? 16 : v2 == 10 ? 28 : 0) >= 0) {
        int32_t v4 = fcntl(sock_fd, F_GETFL); // 0x8f9a
        int64_t v5 = 0; // 0x8fa2
        int64_t format = (int64_t)"fcntl F_GETFL - %m"; // 0x8fa2
        if (v4 != -1) {
            int64_t v6 = v4 | (int32_t)&g202; // 0x8fa8
            v5 = v6;
            format = (int64_t)"fcntl O_NDELAY - %m";
            if (fcntl(sock_fd, F_SETFL) >= 0) {
                int32_t v7 = listen(sock_fd, (int32_t)&g195); // 0x8fce
                v5 = v6;
                format = (int64_t)"listen - %m";
                if (v7 >= 0) {
                    // 0x91a9
                    return sock_fd;
                }
            }
        }
        // 0x911f
        syslog(LOG_CRIT, (char *)format, v5);
        // 0x919b
        close(sock_fd);
        // 0x91a9
        return 0xffffffff;
    }
    int32_t salen2 = v2 == 2 ? 16 : v2 != 10 ? 0 : 28; // 0x905f
    int64_t v8; // 0x8ed0
    if (getnameinfo(addr, salen2, (char *)&g99, 200, NULL, 0, 1) == 0) {
        // 0x912d
        v8 = 200;
        if (*(int32_t *)(sa + 8) == 0) {
            // 0x9134
            v8 = 200;
            if (*(int32_t *)(sa + 12) == 0) {
                // 0x913b
                v8 = 200;
                if (*(int32_t *)(sa + 16) == -0x10000) {
                    uint32_t v9 = g100 ^ 0x3a666666 | *(int32_t *)&g99 ^ 0x66663a3a; // 0x915b
                    int64_t v10 = v9; // 0x915b
                    v8 = v10;
                    if (v9 == 0) {
                        int32_t len2 = strlen((char *)&g101); // 0x9169
                        memmove((int64_t *)&g99, (int64_t *)&g101, len2 + 1);
                        v8 = v10;
                    }
                }
            }
        }
    } else {
        // 0x908e
        *(int16_t *)&g99 = 63;
        v8 = 200;
    }
    // 0x9181
    syslog(LOG_CRIT, "bind %.80s - %m", (char *)&g99, v8);
    // 0x919b
    close(sock_fd);
    // 0x91a9
    return 0xffffffff;
}

// Address range: 0x91c0 - 0x922e
int64_t free_httpd_server(int64_t a1) {
    if (a1 != 0) {
        // 0x91cc
        free((int64_t *)a1);
    }
    int64_t v1 = *(int64_t *)(a1 + 64); // 0x91d1
    if (v1 != 0) {
        // 0x91da
        free((int64_t *)v1);
    }
    int64_t v2 = *(int64_t *)(a1 + 24); // 0x91df
    if (v2 != 0) {
        // 0x91e8
        free((int64_t *)v2);
    }
    int64_t v3 = *(int64_t *)(a1 + 40); // 0x91ed
    if (v3 != 0) {
        // 0x91f6
        free((int64_t *)v3);
    }
    int64_t v4 = *(int64_t *)(a1 + 48); // 0x91fb
    if (v4 != 0) {
        // 0x9204
        free((int64_t *)v4);
    }
    int64_t v5 = *(int64_t *)(a1 + 112); // 0x9209
    if (v5 != 0) {
        // 0x9212
        free((int64_t *)v5);
    }
    int64_t v6 = *(int64_t *)(a1 + 120); // 0x9217
    if (v6 != 0) {
        // 0x9220
        free((int64_t *)v6);
    }
    // 0x9225
    free((int64_t *)a1);
    return &g204;
}

// Address range: 0x9230 - 0x92e0
int64_t httpd_ntoa(int64_t sa, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    // 0x9230
    int64_t v1; // 0x9230
    int16_t v2 = v1;
    int32_t salen = v2 != 2 ? v2 != 10 ? 0 : 28 : 16; // 0x9252
    if (getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1) != 0) {
        // 0x9277
        *(int16_t *)&g99 = 63;
        // 0x92d3
        return (int64_t)&g99;
    }
    // 0x9282
    if (*(int32_t *)(sa + 8) != 0 || *(int32_t *)(sa + 12) != 0 || *(int32_t *)(sa + 16) != -0x10000) {
        // 0x92d3
        return (int64_t)&g99;
    }
    // 0x9297
    if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
        int32_t len = strlen((char *)&g101); // 0x92bb
        memmove((int64_t *)&g99, (int64_t *)&g101, len + 1);
    }
    // 0x92d3
    return (int64_t)&g99;
}

// Address range: 0x92e0 - 0x9323
int64_t httpd_terminate(int64_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 72); // 0x92e4
    int32_t fd = *v1; // 0x92e4
    if (fd != -1) {
        // 0x92ec
        close(fd);
        *v1 = -1;
    }
    int32_t * v2 = (int32_t *)(a1 + 76); // 0x92f8
    int32_t fd2 = *v2; // 0x92f8
    if (fd2 != -1) {
        // 0x9300
        close(fd2);
        *v2 = -1;
    }
    int64_t file = *(int64_t *)(a1 + 88); // 0x930c
    if (file != 0) {
        // 0x9315
        fclose((struct _IO_FILE *)file);
    }
    // 0x931a
    return free_httpd_server(a1);
}

// Address range: 0x9330 - 0x935e
int64_t httpd_unlisten(int64_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 72); // 0x9334
    int32_t fd = *v1; // 0x9334
    int64_t v2; // 0x9330
    if (fd != -1) {
        int32_t v3 = close(fd); // 0x933c
        *v1 = -1;
        v2 = v3;
    }
    int32_t * v4 = (int32_t *)(a1 + 76); // 0x9348
    int32_t fd2 = *v4; // 0x9348
    int64_t result = v2; // 0x934e
    if (fd2 != -1) {
        int32_t v5 = close(fd2); // 0x9350
        *v4 = -1;
        result = v5;
    }
    // 0x935c
    return result;
}

// Address range: 0x9360 - 0x9425
int64_t httpd_write_response(int64_t a1, int64_t a2, int64_t a3) {
    // 0x9360
    int64_t result; // 0x9360
    if (g95 == 1) {
        int32_t fd = *(int32_t *)(a1 + 704); // 0x9374
        int32_t v1 = fcntl(fd, F_GETFL); // 0x9386
        result = v1;
        if (v1 != -1 && (v1 & -2049) != v1) {
            // 0x939c
            result = fcntl(fd, F_SETFL);
        }
    }
    int64_t * v2 = (int64_t *)(a1 + 472); // 0x93aa
    uint64_t v3 = *v2; // 0x93aa
    if (v3 == 0) {
        // 0x941c
        return result;
    }
    int32_t fd2 = *(int32_t *)(a1 + 704); // 0x93b6
    int64_t v4 = *(int64_t *)(a1 + 368); // 0x93bd
    int64_t v5 = 0; // 0x93c8
    int64_t v6 = 0; // 0x93c8
    int64_t result3; // 0x9360
    int64_t v7; // 0x9360
    uint32_t result2; // 0x9405
    while (true) {
      lab_0x93e2:;
        int64_t v8 = v6;
        int64_t v9 = v5;
        int32_t v10 = write(fd2, (int64_t *)(v9 + v4), (int32_t)(v3 - v9)); // 0x93ef
        if (v10 < 0) {
            // 0x9400
            result2 = *__errno_location();
            switch (result2) {
                case 11: {
                    // 0x93d0
                    sleep(1);
                    v7 = v8;
                    goto lab_0x93da;
                }
                case 4: {
                    // 0x93d0
                    sleep(1);
                    v7 = v8;
                    goto lab_0x93da;
                }
                default: {
                    goto lab_0x9411_2;
                }
            }
        } else {
            // 0x93f8
            result3 = 0;
            if (v10 == 0) {
                goto lab_0x9411;
            }
            // 0x93fa
            v7 = v8 + (int64_t)v10 & 0xffffffff;
            goto lab_0x93da;
        }
    }
  lab_0x9411_2:
    // 0x9411
    *v2 = 0;
    // 0x941c
    return result2;
  lab_0x93da:
    // 0x93da
    v6 = v7;
    v5 = 0x100000000 * v6 >> 32;
    result3 = v5;
    if (v3 <= v5) {
      lab_0x9411:
        // 0x9411
        *v2 = 0;
        // 0x941c
        return result3;
    }
    goto lab_0x93e2;
}

// Address range: 0x9430 - 0x9463
int64_t httpd_clear_ndelay(int64_t a1, int64_t a2, int64_t a3) {
    int32_t fd = a1; // 0x943c
    int32_t result = fcntl(fd, F_GETFL); // 0x943c
    if (result == -1) {
        // 0x9452
        return result;
    }
    if ((result & -2049) != result) {
        // 0x9454
        return fcntl(fd, F_SETFL);
    }
    // 0x9452
    return result;
}

// Address range: 0x9470 - 0x94f2
int64_t httpd_write_fully(int64_t fd, int64_t a2, uint64_t a3) {
    // 0x9470
    if (a3 == 0) {
        // 0x94e7
        return 0;
    }
    int64_t v1 = 0; // 0x949a
    int64_t v2 = 0;
    int64_t v3; // 0x9470
    int64_t v4; // 0x9470
    int64_t v5; // 0x94af
    while (true) {
      lab_0x94a2:;
        int64_t v6 = v2;
        int64_t v7 = v1;
        int32_t v8 = write((int32_t)fd, (int64_t *)(v7 + a2), (int32_t)(a3 - v7)); // 0x94af
        v5 = v8;
        if (v8 < 0) {
            // 0x94d0
            switch (*__errno_location()) {
                case 11: {
                    // 0x9490
                    sleep(1);
                    v3 = v6;
                    goto lab_0x949a;
                }
                case 4: {
                    // 0x9490
                    sleep(1);
                    v3 = v6;
                    goto lab_0x949a;
                }
                default: {
                    return v5 & 0xffffffff & 0xffffffff;
                }
            }
        } else {
            int64_t v9 = v6 + v5 & 0xffffffff; // 0x94bb
            v3 = v9;
            v4 = v9;
            if (v8 == 0) {
                // 0x94e7
                return v4 & 0xffffffff;
            }
            goto lab_0x949a;
        }
    }
    // 0x94e7
    return v5 & 0xffffffff & 0xffffffff;
  lab_0x949a:
    // 0x949a
    v2 = v3;
    v1 = 0x100000000 * v2 >> 32;
    v4 = v2;
    if (v1 >= a3) {
        // 0x94e7
        return v4 & 0xffffffff;
    }
    goto lab_0x94a2;
}

// Address range: 0x9500 - 0x9533
int64_t httpd_set_ndelay(int32_t fd, int64_t a2, int64_t a3) {
    int32_t result = fcntl(fd, F_GETFL); // 0x950c
    if (result == -1) {
        // 0x9522
        return result;
    }
    if ((result || (int32_t)&g202) != result) {
        // 0x9524
        return fcntl(fd, F_SETFL);
    }
    // 0x9522
    return result;
}

// Address range: 0x9540 - 0x95fe
int64_t httpd_realloc_str(int64_t a1, uint64_t result, uint64_t a3) {
    if (result == 0) {
        // 0x9590
        abort();
        // UNREACHABLE
    }
    // 0x9556
    if (result >= a3) {
        // 0x95d2
        return result;
    }
    uint64_t v1 = 2 * result; // 0x9565
    uint64_t v2 = 5 * a3 / 4; // 0x956c
    int64_t v3 = v1 > v2 ? v1 : v2; // 0x9573
    *(int64_t *)result = v3;
    int64_t v4 = v3 + 1; // 0x957e
    int64_t * v5 = (int64_t *)a1; // 0x9582
    int32_t v6 = v4; // 0x9582
    int64_t * mem = realloc(v5, v6); // 0x9582
    int64_t result2 = (int64_t)mem; // 0x9582
    *v5 = result2;
    g98 += (int32_t)(v4 - result);
    if (mem != NULL) {
        // 0x95d2
        return result2;
    }
    // 0x95de
    syslog(LOG_ERR, "out of memory reallocating a string to %ld bytes", v6);
    exit(1);
    // UNREACHABLE
}

// Address range: 0x9600 - 0x96ed
int64_t httpd_send_err(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t v1 = a2 & 0xffffffff; // 0x961f
    int64_t v2 = a6; // 0x962c
    int64_t v3; // bp-1048, 0x9600
    if (*(int32_t *)(*(int64_t *)(a1 + 8) + 100) != 0) {
        int64_t v4 = *(int64_t *)(a1 + 344); // 0x962e
        v2 = a6;
        if (*(char *)v4 != 0) {
            // 0x963a
            my_snprintf(&v3, &g192, "%s/%s/err%d.html", v4, "errors", v1);
            int64_t result = send_err_file(a1, v1, a3, a4, &v3); // 0x966d
            v2 = v1;
            if ((int32_t)result != 0) {
                // 0x96b2
                return result;
            }
        }
    }
    // 0x9676
    my_snprintf(&v3, &g192, "%s/err%d.html", (int64_t)"errors", (char *)v1, v2);
    int64_t result2 = send_err_file(a1, v1, a3, a4, &v3); // 0x96a9
    if ((int32_t)result2 == 0) {
        // 0x96c4
        return send_response(a1, v1, a3, a4, a5, a6);
    }
    // 0x96b2
    return result2;
}

// Address range: 0x96f0 - 0x9776
int64_t my_snprintf(int64_t * str, int64_t * size, char * format, int64_t a4, char * a5, int64_t a6) {
    // 0x96f0
    int64_t v1; // 0x96f0
    if ((char)v1 != 0) {
        // 0x970a
        int128_t v2; // 0x96f0
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
        __asm_movaps(v2);
    }
    int64_t v3 = 0x3000000018; // bp-216, 0x9762
    int32_t chars_printed = vsnprintf((char *)str, (int32_t)(int64_t)size, format, (int64_t)&v3); // 0x9769
    return chars_printed;
}

// Address range: 0x9780 - 0x9905
int64_t send_err_file(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t * file_path) {
    struct _IO_FILE * file = fopen((char *)file_path, "r"); // 0x97a6
    if (file == NULL) {
        // 0x98f3
        return 0;
    }
    // 0x97b4
    send_mime(a1, a2 & 0xffffffff, a3, (int64_t *)&g10, a4, "text/html; charset=%s", -1, 0);
    int64_t data; // bp-2056, 0x9780
    int32_t items_read = fread(&data, 1, (int32_t)&g191, file); // 0x97ed
    int64_t v1 = a1 + 368;
    int64_t v2 = a1 + 464;
    int64_t * v3; // 0x9780
    int64_t * v4; // 0x9780
    if (items_read == 0) {
        // 0x97b4
        v4 = (int64_t *)v1;
        v3 = (int64_t *)(a1 + 472);
    } else {
        int64_t * v5 = (int64_t *)(a1 + 472);
        int64_t * v6 = (int64_t *)v1;
        *(char *)((int64_t)items_read + (int64_t)&data) = 0;
        int32_t len = strlen((char *)&data); // 0x9817
        int64_t v7 = len; // 0x9817
        httpd_realloc_str(v1, v2, *v5 + v7);
        memcpy((int64_t *)(*v5 + *v6), &data, len);
        *v5 = *v5 + v7;
        int32_t items_read2 = fread(&data, 1, (int32_t)&g191, file); // 0x9864
        v4 = v6;
        v3 = v5;
        while (items_read2 != 0) {
            // 0x9810
            *(char *)((int64_t)items_read2 + (int64_t)&data) = 0;
            len = strlen((char *)&data);
            v7 = len;
            httpd_realloc_str(v1, v2, *v5 + v7);
            memcpy((int64_t *)(*v5 + *v6), &data, len);
            *v5 = *v5 + v7;
            items_read2 = fread(&data, 1, (int32_t)&g191, file);
            v4 = v6;
            v3 = v5;
        }
    }
    int64_t * v8 = v3;
    fclose(file);
    int64_t str; // bp-1048, 0x9780
    my_snprintf(&str, &g192, "    <hr>\n\n    <address><a href=\"%s\">%s</a></address>\n\n  </body>\n\n</html>\n", (int64_t)"http://www.acme.com/software/thttpd/", "thttpd/2.29 23May2018", (int64_t)"text/html; charset=%s");
    int32_t len2 = strlen((char *)&str); // 0x98a5
    int64_t v9 = len2; // 0x98a5
    httpd_realloc_str(v1, v2, *v8 + v9);
    memcpy((int64_t *)(*v8 + *v4), &str, len2);
    *v8 = *v8 + v9;
    // 0x98f3
    return 1;
}

// Address range: 0x9910 - 0x9da4
int64_t send_response(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    // 0x9910
    send_mime(a1, a2, a3, (int64_t *)&g10, a4, "text/html; charset=%s", -1, 0);
    int64_t v1 = a2 & 0xffffffff; // 0x9966
    int64_t v2 = v1; // 0x996b
    char * v3 = (char *)a3; // 0x9972
    int64_t str; // bp-3048, 0x9910
    my_snprintf(&str, &g201, "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<html>\n\n  <head>\n    <meta http-equiv=\"Content-type\" content=\"text/html;charset=UTF-8\">\n    <title>%d %s</title>\n  </head>\n\n  <body bgcolor=\"#cc9999\" text=\"#000000\" link=\"#2020ff\" vlink=\"#4040cc\">\n\n    <h2>%d %s</h2>\n", v1, v3, v1);
    int32_t len = strlen((char *)&str); // 0x997e
    int64_t v4 = len; // 0x997e
    int64_t v5 = a1 + 368; // 0x9986
    int64_t v6 = a1 + 464; // 0x998d
    int64_t * v7 = (int64_t *)(a1 + 472); // 0x9994
    httpd_realloc_str(v5, v6, *v7 + v4);
    int64_t * v8 = (int64_t *)v5; // 0x99a9
    memcpy((int64_t *)(*v7 + *v8), &str, len);
    *v7 = *v7 + v4;
    char v9 = *(char *)&v2; // 0x99c9
    int64_t v10; // bp-4056, 0x9910
    int64_t v11 = &v10;
    int64_t v12 = a6; // 0x99cd
    int64_t v13 = v11; // 0x99cd
    if (v9 != 0) {
        int64_t v14; // 0x9910
        if (v9 == 62) {
            // 0x9a00
            *(int32_t *)v11 = 0x3b746726;
            v14 = v11 + 3;
        } else {
            if (v9 != 60) {
                // 0x9a10
                *(char *)v11 = v9;
                v14 = v11;
            } else {
                // 0x99ed
                *(int32_t *)v11 = 0x3b746c26;
                v14 = v11 + 3;
            }
        }
        // 0x9a12
        v12++;
        int64_t v15 = v14 + 1; // 0x9a12
        char v16 = *(char *)v12; // 0x9a16
        v13 = v15;
        while (v16 != 0 == v15 - v11 < (int64_t)&g190) {
            char v17 = v16;
            int64_t v18 = v15;
            if (v17 == 62) {
                // 0x9a00
                *(int32_t *)v18 = 0x3b746726;
                v14 = v18 + 3;
            } else {
                if (v17 != 60) {
                    // 0x9a10
                    *(char *)v18 = v17;
                    v14 = v18;
                } else {
                    // 0x99ed
                    *(int32_t *)v18 = 0x3b746c26;
                    v14 = v18 + 3;
                }
            }
            // 0x9a12
            v12++;
            v15 = v14 + 1;
            v16 = *(char *)v12;
            v13 = v15;
        }
    }
    // 0x9a3c
    *(char *)v13 = 0;
    my_snprintf(&str, &g201, (char *)a5, v11, v3, v2);
    int32_t len2 = strlen((char *)&str); // 0x9a65
    int64_t v19 = len2; // 0x9a65
    httpd_realloc_str(v5, v6, *v7 + v19);
    memcpy((int64_t *)(*v7 + *v8), &str, len2);
    *v7 = *v7 + v19;
    if ((int32_t)match((int64_t)"**MSIE**", *(int64_t *)(a1 + 280)) != 0) {
        // 0x9abd
        httpd_realloc_str(v5, v6, *v7 + 5);
        int64_t v20 = *v7 + *v8;
        *(char *)(v20 + 4) = 10;
        *(int32_t *)v20 = 0x2d2d213c;
        int64_t v21 = *v7; // 0x9ae1
        *v7 = v21 + 5;
        httpd_realloc_str(v5, v6, v21 + 83);
        int128_t v22 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9b00
        int64_t v23 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v23 + 62), v22);
        __asm_movups(*(int128_t *)(v23 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v23 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v23 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v23, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v24 = *v7; // 0x9b3b
        *v7 = v24 + 78;
        httpd_realloc_str(v5, v6, v24 + 156);
        int128_t v25 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9b5d
        int64_t v26 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v26 + 62), v25);
        __asm_movups(*(int128_t *)(v26 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v26 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v26 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v26, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v27 = *v7; // 0x9b98
        *v7 = v27 + 78;
        httpd_realloc_str(v5, v6, v27 + 156);
        int128_t v28 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9bba
        int64_t v29 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v29 + 62), v28);
        __asm_movups(*(int128_t *)(v29 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v29 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v29 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v29, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v30 = *v7; // 0x9bf5
        *v7 = v30 + 78;
        httpd_realloc_str(v5, v6, v30 + 156);
        int128_t v31 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9c17
        int64_t v32 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v32 + 62), v31);
        __asm_movups(*(int128_t *)(v32 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v32 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v32 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v32, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v33 = *v7; // 0x9c52
        *v7 = v33 + 78;
        httpd_realloc_str(v5, v6, v33 + 156);
        int128_t v34 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9c74
        int64_t v35 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v35 + 62), v34);
        __asm_movups(*(int128_t *)(v35 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v35 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v35 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v35, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v36 = *v7; // 0x9caf
        *v7 = v36 + 78;
        httpd_realloc_str(v5, v6, v36 + 156);
        int128_t v37 = __asm_movups_1(0xa2e656e6f2064656e6e6163206e776f); // 0x9cd1
        int64_t v38 = *v7 + *v8;
        __asm_movups(*(int128_t *)(v38 + 62), v37);
        __asm_movups(*(int128_t *)(v38 + 48), __asm_movups_1(0x776f2073746920666f2064616574736e));
        __asm_movups(*(int128_t *)(v38 + 32), __asm_movups_1(0x6920726f727265207369687420776f68));
        __asm_movups(*(int128_t *)(v38 + 16), __asm_movups_1(0x73206f7420736e67696564204549534d));
        __asm_movups(*(int128_t *)v38, __asm_movups_1(0x2074616874206f7320676e6964646150));
        int64_t v39 = *v7; // 0x9d0c
        *v7 = v39 + 78;
        httpd_realloc_str(v5, v6, v39 + 82);
        *(int32_t *)(*v7 + *v8) = 0xa3e2d2d;
        *v7 = *v7 + 4;
    }
    // 0x9d36
    int64_t str2; // bp-1048, 0x9910
    my_snprintf(&str2, &g192, "    <hr>\n\n    <address><a href=\"%s\">%s</a></address>\n\n  </body>\n\n</html>\n", (int64_t)"http://www.acme.com/software/thttpd/", "thttpd/2.29 23May2018", v2);
    int32_t len3 = strlen((char *)&str2); // 0x9d65
    int64_t v40 = len3; // 0x9d65
    httpd_realloc_str(v5, v6, *v7 + v40);
    int64_t * dest_mem = memcpy((int64_t *)(*v7 + *v8), &str2, len3); // 0x9d8a
    *v7 = *v7 + v40;
    return (int64_t)dest_mem;
}

// Address range: 0x9db0 - 0x9dcf
int64_t httpd_method_str(int64_t a1) {
    int64_t v1 = a1 + 0xffffffff; // 0x9db0
    if ((int32_t)v1 < 6) {
        // 0x9db8
        return *(int64_t *)((0x100000000 * v1 >> 29) + (int64_t)&g21);
    }
    // 0x9dc7
    return (int64_t)"UNKNOWN";
}

// Address range: 0x9dd0 - 0xa20b
int64_t httpd_get_conn(int64_t a1, int64_t sock, int64_t a3) {
    // 0x9dd0
    int128_t v1; // 0x9dd0
    int128_t v2 = v1;
    int128_t v3 = v1;
    int64_t v4; // 0x9dd0
    int128_t v5; // 0x9dd0
    if ((int32_t)v4 == 0) {
        int64_t v6 = a3 + 152; // 0x9df3
        *(int64_t *)v6 = 0;
        httpd_realloc_str(a3 + 144, v6, 500);
        int64_t v7 = a3 + 456; // 0x9e22
        int64_t v8 = a3 + 440; // 0x9e3a
        int64_t v9 = a3 + 424; // 0x9e52
        int64_t v10 = a3 + 408; // 0x9e6f
        int64_t v11 = a3 + 392; // 0x9e7d
        int64_t v12 = a3 + 376; // 0x9e8b
        int128_t v13 = __asm_xorps(v3, v3); // 0x9e99
        __asm_movups(*(int128_t *)v7, v13);
        __asm_movups(*(int128_t *)v8, v13);
        __asm_movups(*(int128_t *)v9, v13);
        __asm_movups(*(int128_t *)v10, v13);
        __asm_movups(*(int128_t *)v11, v13);
        __asm_movups(*(int128_t *)v12, v13);
        httpd_realloc_str(a3 + 216, v12, 1);
        httpd_realloc_str(a3 + 232, a3 + 384, 1);
        httpd_realloc_str(a3 + 240, v11, 0);
        httpd_realloc_str(a3 + 248, a3 + 400, 0);
        httpd_realloc_str(a3 + 256, v10, 0);
        httpd_realloc_str(a3 + 264, a3 + 416, 0);
        httpd_realloc_str(a3 + 288, v9, 0);
        httpd_realloc_str(a3 + 296, a3 + 432, 0);
        httpd_realloc_str(a3 + 328, v8, 0);
        httpd_realloc_str(a3 + 344, a3 + 448, 0);
        httpd_realloc_str(a3 + 360, v7, 0);
        httpd_realloc_str(a3 + 368, a3 + 464, 0);
        *(int32_t *)a3 = 1;
        v5 = v13;
    }
    int128_t v14 = v5;
    int32_t addr_len = 128; // bp-244, 0x9fa7
    int64_t addr; // bp-176, 0x9dd0
    uint32_t accepted_sock_fd = accept((int32_t)sock, (struct sockaddr *)&addr, &addr_len); // 0x9fbc
    int32_t * fd = (int32_t *)(a3 + 704); // 0x9fc1
    *fd = accepted_sock_fd;
    if (accepted_sock_fd < 0) {
        // 0xa19a
        switch (*__errno_location()) {
            case 11: {
                // 0xa1f6
                return 2;
            }
            case 103: {
                // 0xa1f6
                return 0;
            }
        }
        // 0xa1ab
        syslog(LOG_ERR, "accept - %m", (int64_t)&addr_len);
        // 0xa1f6
        return 0;
    }
    // 0x9fcf
    int64_t result; // 0x9dd0
    if ((addr & 0xfff7) != 2) {
        // 0xa1c3
        syslog(LOG_ERR, "unknown sockaddr family");
        close(*fd);
        *fd = -1;
        result = 0;
    } else {
        // 0x9fe1
        fcntl(accepted_sock_fd, F_SETFD);
        *(int64_t *)(a3 + 8) = a1;
        int16_t v15 = addr; // 0xa006
        int64_t v16 = v15 != 2 ? v15 != 10 ? 0 : 28 : 16; // 0xa01c
        int64_t v17 = a3 + 16;
        int32_t v18 = v16;
        memset((int64_t *)(v16 + v17), 0, 128 - v18);
        memcpy((int64_t *)v17, &addr, v18);
        int128_t v19 = __asm_xorps(v14, v14); // 0xa04b
        __asm_movups(*(int128_t *)(a3 + 160), v19);
        __asm_movups(*(int128_t *)(a3 + 172), v19);
        __asm_movups(*(int128_t *)(a3 + 192), v19);
        *(int64_t *)(a3 + 208) = (int64_t)&g10;
        *(char *)*(int64_t *)(a3 + 216) = 0;
        *(int64_t *)(a3 + 224) = (int64_t)"UNKNOWN";
        *(char *)*(int64_t *)(a3 + 232) = 0;
        *(char *)*(int64_t *)(a3 + 240) = 0;
        *(char *)*(int64_t *)(a3 + 248) = 0;
        *(char *)*(int64_t *)(a3 + 256) = 0;
        *(char *)*(int64_t *)(a3 + 264) = 0;
        *(int64_t *)(a3 + 272) = (int64_t)&g10;
        *(int64_t *)(a3 + 280) = (int64_t)&g10;
        *(char *)*(int64_t *)(a3 + 288) = 0;
        *(char *)*(int64_t *)(a3 + 296) = 0;
        *(int64_t *)(a3 + 304) = (int64_t)&g10;
        *(int64_t *)(a3 + 312) = (int64_t)&g10;
        *(int64_t *)(a3 + 320) = (int64_t)&g10;
        *(char *)*(int64_t *)(a3 + 328) = 0;
        *(int64_t *)(a3 + 336) = (int64_t)&g10;
        *(char *)*(int64_t *)(a3 + 344) = 0;
        *(int64_t *)(a3 + 352) = (int64_t)&g10;
        *(char *)*(int64_t *)(a3 + 360) = 0;
        *(char *)*(int64_t *)(a3 + 368) = 0;
        *(int64_t *)(a3 + 472) = 0;
        *(int128_t *)(a3 + 480) = (int128_t)__asm_movdqu(__asm_pcmpeqd(v2, v2));
        *(int64_t *)(a3 + 496) = -1;
        *(int64_t *)(a3 + 504) = (int64_t)&g10;
        *(int64_t *)(a3 + 512) = 0;
        *(int32_t *)(a3 + 520) = 1;
        __asm_movups(*(int128_t *)(a3 + 524), v19);
        *(int32_t *)(a3 + 540) = 0;
        *(int64_t *)(a3 + 544) = -1;
        *(int64_t *)(a3 + 552) = 0;
        *(int64_t *)(a3 + 712) = 0;
        result = 1;
    }
    // 0xa1f6
    return result;
}

// Address range: 0xa210 - 0xa40c
int64_t httpd_got_request(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    uint64_t v1 = *(int64_t *)(a1 + 160); // 0xa21a
    int64_t * v2 = (int64_t *)(a1 + 168); // 0xa221
    uint64_t v3 = *v2; // 0xa221
    if (v3 >= v1) {
        // 0xa2aa
        return 0;
    }
    int64_t v4 = v3; // 0xa276
    int64_t result = 2; // 0xa2a8
    while (*(int32_t *)(a1 + 176) >= 12) {
        // 0xa288
        v4++;
        *v2 = v4;
        result = 0;
        if (v4 == v1) {
            // break -> 0xa2aa
            break;
        }
        result = 2;
    }
    // 0xa2aa
    return result;
}

// Address range: 0xa410 - 0xb709
int64_t httpd_parse_request(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t * v1 = (int64_t *)(a1 + 168); // 0xa424
    *v1 = 0;
    int64_t * v2 = (int64_t *)(a1 + 160); // 0xa42f
    int64_t v3 = *v2; // 0xa42f
    int64_t v4 = 0; // 0xa439
    if (v3 != 0) {
        int64_t * v5 = (int64_t *)(a1 + 144); // 0xa43f
        int64_t v6 = 1; // 0xa45b
        char * v7; // 0xa410
        char v8; // 0xa460
        while (true) {
          lab_0xa460:;
            int64_t v9 = v6;
            v7 = (char *)(*v5 - 1 + v9);
            v8 = *v7;
            switch (v8) {
                case 13: {
                    goto lab_0xa48a;
                }
                case 10: {
                    goto lab_0xa48a;
                }
                default: {
                    // 0xa46f
                    *v1 = v9;
                    v6 = v9 + 1;
                    v4 = 0;
                    if (v9 == v3) {
                        goto lab_0xa4d4;
                    }
                    goto lab_0xa460;
                }
            }
        }
      lab_0xa48a:
        // 0xa48a
        *v7 = 0;
        uint64_t v10 = *v1 + 1; // 0xa496
        *v1 = v10;
        if (v8 == 13) {
            // 0xa4a6
            if (v10 < *v2) {
                char * v11 = (char *)(*v5 + v10); // 0xa4b6
                if (*v11 == 10) {
                    // 0xa4bc
                    *v11 = 0;
                    *v1 = *v1 + 1;
                }
            }
        }
        // 0xa4c8
        v4 = *v5;
    }
  lab_0xa4d4:;
    char * str = (char *)v4; // 0xa4de
    char * found_byte_pos = strpbrk(str, " \t\n\r"); // 0xa4de
    int64_t str7; // 0xa410
    if (found_byte_pos == NULL) {
        goto lab_0xb354_2;
    } else {
        int64_t v12 = (int64_t)found_byte_pos; // 0xa4de
        *found_byte_pos = 0;
        int64_t v13 = (int64_t)strspn((char *)(v12 + 1), " \t\n\r") + v12; // 0xa505
        int64_t v14 = v13 + 1; // 0xa509
        char * str2 = (char *)v14; // 0xa513
        char * found_byte_pos2 = strpbrk(str2, " \t\n\r"); // 0xa513
        int64_t v15; // 0xa410
        if (found_byte_pos2 == NULL) {
            // 0xa579
            *(int32_t *)(a1 + 520) = 0;
            v15 = (int64_t)"HTTP/0.9";
        } else {
            int64_t str3 = (int64_t)found_byte_pos2 + 1;
            *found_byte_pos2 = 0;
            int64_t v16 = str3 + (int64_t)strspn((char *)str3, " \t\n\r");
            char * str4 = (char *)v16;
            v15 = v16;
            if (*str4 != 0) {
                char * found_byte_pos3 = strpbrk(str4, " \t\n\r"); // 0xa54c
                if (found_byte_pos3 != NULL) {
                    // 0xa556
                    *found_byte_pos3 = 0;
                }
                // 0xa559
                v15 = v16;
                if (strcasecmp(str4, "HTTP/1.0") != 0) {
                    // 0xa56c
                    *(int32_t *)(a1 + 524) = 1;
                    v15 = v16;
                }
            }
        }
        // 0xa58b
        *(int64_t *)(a1 + 224) = v15;
        if (strncasecmp(str2, "http://", 7) == 0) {
            // 0xa668
            if (*(int32_t *)(a1 + 524) == 0) {
                goto lab_0xb354_2;
            } else {
                char * str5 = (char *)(v13 + 8); // 0xa682
                char * found_char_pos = strchr(str5, 47); // 0xa682
                if (found_char_pos == NULL) {
                    goto lab_0xb354_2;
                } else {
                    // 0xa690
                    *found_char_pos = 0;
                    if (strchr(str5, 47) != NULL) {
                        goto lab_0xb354_2;
                    } else {
                        // 0xa6ac
                        if (*str5 == 46) {
                            goto lab_0xb354_2;
                        } else {
                            int64_t str6 = a1 + 328; // 0xa6b7
                            httpd_realloc_str(str6, a1 + 440, (int64_t)strlen(str5));
                            strcpy((char *)*(int64_t *)str6, str5);
                            *found_char_pos = 47;
                            str7 = (int64_t)found_char_pos;
                            goto lab_0xa5b9;
                        }
                    }
                }
            }
        } else {
            // 0xa5ae
            str7 = v14;
            if (*str2 != 47) {
                goto lab_0xb354_2;
            } else {
                goto lab_0xa5b9;
            }
        }
    }
  lab_0xb354_2:;
    int64_t v17 = *(int64_t *)&g23; // 0xb359
    int64_t v18 = 400; // 0xb359
    int64_t v19 = *(int64_t *)&g24; // 0xb359
    int64_t v20 = (int64_t)&g10; // 0xb359
    goto lab_0xb35c;
  lab_0xac17:;
    // 0xac17
    int64_t * v65; // 0xab89
    int64_t v114 = *v65; // 0xac17
    int64_t v79 = v114; // 0xac21
    if (v114 == 0) {
        // break -> 0xb242
        goto lab_0xb242_4;
    }
    goto lab_0xac27;
  lab_0xac27:;
    // 0xac27
    int64_t v68; // 0xa410
    int64_t v115 = v79 + (0x100000000 * v68 >> 32); // 0xac29
    char * str30 = (char *)v115; // 0xac2c
    if (*str30 == 0) {
        // break -> 0xb242
        goto lab_0xb242_4;
    }
    // 0xac36
    int64_t v116; // 0xa410
    int64_t v117; // 0xa410
    int64_t v60; // 0xab42
    int64_t v61; // 0xab4e
    int64_t v62; // 0xab5a
    int64_t v63; // 0xab63
    int64_t v64; // 0xab6a
    int64_t * str55; // 0xa410
    int64_t * str54; // 0xa410
    int64_t * v66; // 0xa410
    int64_t * v67; // 0xa410
    uint64_t v76; // 0xabe3
    char * str40; // 0xa410
    char * str45; // 0xa410
    if (strncasecmp(str30, "Referer:", 8) == 0) {
        int64_t str31 = v115 + 8;
        // 0xae4b
        *v67 = str31 + (int64_t)strspn((char *)str31, " \t");
        goto lab_0xae57;
    } else {
        // 0xac4e
        if (strncasecmp(str30, "Referrer:", 9) == 0) {
            int64_t str32 = v115 + 9;
            // 0xae4b
            *v67 = str32 + (int64_t)strspn((char *)str32, " \t");
            goto lab_0xae57;
        } else {
            // 0xac6a
            if (strncasecmp(str30, "User-Agent:", 11) == 0) {
                int64_t str33 = v115 + 11;
                *(int64_t *)(a1 + 280) = str33 + (int64_t)strspn((char *)str33, " \t");
                goto lab_0xae57;
            } else {
                // 0xac86
                if (strncasecmp(str30, "Host:", 5) == 0) {
                    int64_t str34 = v115 + 5;
                    int64_t v118 = str34 + (int64_t)strspn((char *)str34, " \t"); // 0xaea4
                    *v66 = v118;
                    char * str35 = (char *)v118;
                    char * found_char_pos4 = strchr(str35, 58); // 0xaebc
                    char * str36 = str35; // 0xaec4
                    if (found_char_pos4 != NULL) {
                        // 0xaec6
                        *found_char_pos4 = 0;
                        str36 = (char *)*v66;
                    }
                    // 0xaed0
                    if (strchr(str36, 47) != NULL) {
                        goto lab_0xb354_2;
                    }
                    // 0xaee6
                    if (*str36 == 46) {
                        goto lab_0xb354_2;
                    }
                    goto lab_0xae57;
                } else {
                    // 0xaca2
                    if (strncasecmp(str30, "Accept:", 7) == 0) {
                        int64_t str37 = v115 + 7;
                        int64_t v119 = str37 + (int64_t)strspn((char *)str37, " \t"); // 0xaf04
                        char * str39 = (char *)*str54; // 0xaf0e
                        if (*str39 == 0) {
                            char * str38 = (char *)v119;
                            httpd_realloc_str(v63, v64, (int64_t)strlen(str38));
                            str40 = str38;
                            goto lab_0xb014;
                        } else {
                            uint64_t len7 = (int64_t)strlen(str39); // 0xaf17
                            if (len7 < (int64_t)&g14) {
                                // 0xafdd
                                str40 = (char *)v119;
                                httpd_realloc_str(v63, v64, len7 + 2 + (int64_t)strlen(str40));
                                int64_t str41 = *str54; // 0xaffd
                                int64_t v120 = str41 + (int64_t)strlen((char *)str41);
                                *(int16_t *)v120 = (int16_t)&g187;
                                *(char *)(v120 + 2) = 0;
                                goto lab_0xb014;
                            } else {
                                // 0xaf28
                                httpd_ntoa(v62, (int64_t)" \t", 7, v76, a5, a6);
                                // 0xaf8c
                                syslog(LOG_ERR, (char *)(int64_t)"%.80s way too much Accept: data", (char *)&g99);
                                goto lab_0xae57;
                            }
                        }
                    } else {
                        // 0xacbe
                        if (strncasecmp(str30, "Accept-Encoding:", 16) == 0) {
                            int64_t str42 = v115 + 16;
                            int64_t v121 = str42 + (int64_t)strspn((char *)str42, " \t"); // 0xaf4f
                            char * str44 = (char *)*str55; // 0xaf5c
                            if (*str44 == 0) {
                                char * str43 = (char *)v121;
                                httpd_realloc_str(v60, v61, (int64_t)strlen(str43));
                                str45 = str43;
                                goto lab_0xb090;
                            } else {
                                uint64_t len8 = (int64_t)strlen(str44); // 0xaf65
                                if (len8 < (int64_t)&g14) {
                                    // 0xb059
                                    str45 = (char *)v121;
                                    httpd_realloc_str(v60, v61, len8 + 2 + (int64_t)strlen(str45));
                                    int64_t str46 = *str55; // 0xb079
                                    int64_t v122 = str46 + (int64_t)strlen((char *)str46);
                                    *(int16_t *)v122 = (int16_t)&g187;
                                    *(char *)(v122 + 2) = 0;
                                    goto lab_0xb090;
                                } else {
                                    // 0xaf76
                                    httpd_ntoa(v62, (int64_t)" \t", 16, v76, a5, a6);
                                    // 0xaf8c
                                    syslog(LOG_ERR, (char *)(int64_t)"%.80s way too much Accept-Encoding: data", (char *)&g99);
                                    goto lab_0xae57;
                                }
                            }
                        } else {
                            // 0xacda
                            if (strncasecmp(str30, "Accept-Language:", 16) == 0) {
                                int64_t str47 = v115 + 16;
                                *(int64_t *)(a1 + 304) = str47 + (int64_t)strspn((char *)str47, " \t");
                                goto lab_0xae57;
                            } else {
                                // 0xacf6
                                if (strncasecmp(str30, "If-Modified-Since:", 18) == 0) {
                                    int64_t v123 = v115 + 18; // 0xb022
                                    int64_t v124 = tdate_parse(v123); // 0xb029
                                    *(int64_t *)(a1 + 480) = v124;
                                    v117 = v124;
                                    v116 = v123;
                                    goto lab_0xb0e2;
                                } else {
                                    // 0xad12
                                    if (strncasecmp(str30, "Cookie:", 7) == 0) {
                                        int64_t str48 = v115 + 7;
                                        *(int64_t *)(a1 + 312) = str48 + (int64_t)strspn((char *)str48, " \t");
                                        goto lab_0xae57;
                                    } else {
                                        // 0xad2e
                                        if (strncasecmp(str30, "Range:", 6) == 0) {
                                            // 0xb107
                                            if (strchr(str30, 44) == NULL) {
                                                char * found_char_pos5 = strchr(str30, 61); // 0xb12a
                                                if (found_char_pos5 != NULL) {
                                                    int64_t v125 = (int64_t)found_char_pos5 + 1; // 0xb13b
                                                    char * str49 = (char *)v125; // 0xb147
                                                    char * found_char_pos6 = strchr(str49, 45); // 0xb147
                                                    int64_t v126 = (int64_t)found_char_pos6; // 0xb147
                                                    if (found_char_pos6 != NULL && v125 != v126) {
                                                        // 0xb161
                                                        *found_char_pos6 = 0;
                                                        *(int32_t *)(a1 + 528) = 1;
                                                        int64_t str_as_ll = strtoll(str49, NULL, 10); // 0xb179
                                                        *(int64_t *)(a1 + 536) = str_as_ll > 0 ? str_as_ll : 0;
                                                        int16_t * v127 = *__ctype_b_loc(); // 0xb196
                                                        char * str50 = (char *)(v126 + 1); // 0xb199
                                                        if ((*(char *)((int64_t)v127 + 1 + 2 * (int64_t)*str50) & 8) != 0) {
                                                            int64_t str_as_ll2 = strtoll(str50, NULL, 10); // 0xb1b7
                                                            *(int64_t *)(a1 + 544) = str_as_ll2 > -1 ? str_as_ll2 : -1;
                                                        }
                                                    }
                                                }
                                            }
                                            goto lab_0xae57;
                                        } else {
                                            // 0xad4a
                                            if (strncasecmp(str30, "Range-If:", 9) == 0) {
                                                goto lab_0xb0ca;
                                            } else {
                                                // 0xad66
                                                if (strncasecmp(str30, "If-Range:", 9) == 0) {
                                                    goto lab_0xb0ca;
                                                } else {
                                                    // 0xad82
                                                    if (strncasecmp(str30, "Content-Type:", 13) == 0) {
                                                        int64_t str51 = v115 + 13;
                                                        *(int64_t *)(a1 + 320) = str51 + (int64_t)strspn((char *)str51, " \t");
                                                    } else {
                                                        // 0xad9e
                                                        if (strncasecmp(str30, "Content-Length:", 15) == 0) {
                                                            // 0xb1fa
                                                            *(int64_t *)(a1 + 496) = (int64_t)strtol((char *)(v115 + 15), NULL, 10);
                                                        } else {
                                                            // 0xadba
                                                            if (strncasecmp(str30, "Authorization:", 14) == 0) {
                                                                int64_t str52 = v115 + 14;
                                                                *(int64_t *)(a1 + 352) = str52 + (int64_t)strspn((char *)str52, " \t");
                                                            } else {
                                                                // 0xadd6
                                                                if (strncasecmp(str30, "Connection:", 11) == 0) {
                                                                    int64_t str53 = v115 + 11;
                                                                    int32_t ini_seg_bytes = strspn((char *)str53, " \t"); // 0xadfa
                                                                    if (strcasecmp((char *)(str53 + (int64_t)ini_seg_bytes), "keep-alive") == 0) {
                                                                        // 0xae17
                                                                        *(int32_t *)(a1 + 552) = 1;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    goto lab_0xae57;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0xae57:;
    uint64_t v128 = *v2; // 0xae57
    uint64_t v129 = *v1; // 0xae5e
    v68 = v129;
    int64_t v69 = v128; // 0xae68
    if (v129 >= v128) {
        // break -> 0xb242
        goto lab_0xb242_4;
    }
    goto lab_0xab84;
  lab_0xb014:
    // 0xb014
    strcat((char *)*str54, str40);
    goto lab_0xae57;
  lab_0xb090:
    // 0xb090
    strcpy((char *)*str55, str45);
    goto lab_0xae57;
  lab_0xb0e2:
    // 0xb0e2
    if (v117 == -1) {
        // 0xb0ec
        syslog(LOG_DEBUG, "unparsable time: %.80s", (char *)v116);
    }
    goto lab_0xae57;
  lab_0xb0ca:;
    int64_t v130 = v115 + 9; // 0xb0ca
    int64_t v131 = tdate_parse(v130); // 0xb0d1
    *(int64_t *)(a1 + 488) = v131;
    v117 = v131;
    v116 = v130;
    goto lab_0xb0e2;
  lab_0xb35c:
    // 0xb35c
    httpd_send_err(a1, v18, v17, (int64_t)&g10, v19, v20);
    // 0xb366
    return 0xffffffff;
  lab_0xa5b9:;
    int32_t v21 = 1; // 0xa5ca
    if (strcasecmp(str, "GET") == 0) {
        goto lab_0xa71e;
    } else {
        // 0xa5d0
        v21 = 2;
        if (strcasecmp(str, "HEAD") == 0) {
            goto lab_0xa71e;
        } else {
            // 0xa5e7
            v21 = 3;
            if (strcasecmp(str, "POST") == 0) {
                goto lab_0xa71e;
            } else {
                // 0xa5fe
                v21 = 4;
                if (strcasecmp(str, "PUT") == 0) {
                    goto lab_0xa71e;
                } else {
                    // 0xa615
                    v21 = 5;
                    if (strcasecmp(str, "DELETE") == 0) {
                        goto lab_0xa71e;
                    } else {
                        // 0xa62c
                        v21 = 6;
                        v17 = (int64_t)"Not Implemented";
                        v18 = 501;
                        v19 = (int64_t)"The requested method '%.80s' is not implemented by this server.\n";
                        v20 = v4;
                        if (strcasecmp(str, "TRACE") == 0) {
                            goto lab_0xa71e;
                        } else {
                            goto lab_0xb35c;
                        }
                    }
                }
            }
        }
    }
  lab_0xa71e:
    // 0xa71e
    *(int32_t *)(a1 + 180) = v21;
    int64_t * str10 = (int64_t *)(a1 + 208); // 0xa725
    *str10 = str7;
    int64_t v22 = a1 + 216; // 0xa72c
    httpd_realloc_str(v22, a1 + 376, (int64_t)strlen((char *)str7));
    int64_t * str8 = (int64_t *)v22; // 0xa757
    int64_t v23 = *str8; // 0xa761
    int64_t v24 = *str10; // 0xa761
    int64_t v25; // 0xa410
    while (true) {
        int64_t v26 = v24;
        v25 = v23;
        unsigned char v27 = *(char *)v26; // 0xa782
        int64_t v28; // 0xa410
        int64_t v29; // 0xa410
        if (v27 != 37) {
            // 0xa770
            v29 = v27;
            v28 = v26;
            if (v27 == 0) {
                // break -> 0xa80a
                break;
            }
        } else {
            int16_t * v30 = *__ctype_b_loc(); // 0xa790
            char v31 = *(char *)(v26 + 1); // 0xa793
            int64_t v32 = v31; // 0xa793
            int64_t v33 = (int64_t)v30 + 1; // 0xa79a
            v29 = 37;
            v28 = v26;
            if ((*(char *)(2 * v32 + v33) & 16) != 0) {
                int64_t v34 = v26 + 2; // 0xa7a1
                char v35 = *(char *)v34; // 0xa7a1
                int64_t v36 = v35; // 0xa7a1
                v29 = 37;
                v28 = v26;
                if ((*(char *)(2 * v36 + v33) & 16) != 0) {
                    int64_t v37 = v32 + 0xffffffd0; // 0xa7ad
                    int64_t v38 = v37 & 0xffffffff; // 0xa7b3
                    if ((char)v37 >= 10) {
                        if (v31 < 103) {
                            // 0xa7bd
                            v38 = (v32 + 169) % 256;
                        } else {
                            // 0xa7c5
                            v38 = v31 >= 71 ? 0 : (v32 + 201) % 256;
                        }
                    }
                    int64_t v39 = v36 + 0xffffffd0; // 0xa7da
                    int64_t v40 = v39 & 0xffffffff; // 0xa7e0
                    if ((char)v39 >= 10) {
                        if (v35 < 103) {
                            // 0xa7ea
                            v40 = (v36 + 169) % 256;
                        } else {
                            // 0xa7f0
                            v40 = v35 >= 71 ? 0 : (v36 + 201) % 256;
                        }
                    }
                    // 0xa7ff
                    v29 = (v40 + 16 * v38) % 256;
                    v28 = v34;
                }
            }
        }
        // 0xa778
        *(char *)v25 = (char)v29;
        v23 = v25 + 1;
        v24 = v28 + 1;
    }
    // 0xa80a
    *(char *)v25 = 0;
    int64_t v41 = a1 + 232; // 0xa80d
    httpd_realloc_str(v41, a1 + 384, (int64_t)strlen((char *)*str8));
    int64_t * str9 = (int64_t *)v41; // 0xa83c
    strcpy((char *)*str9, (char *)(*str8 + 1));
    int64_t v42 = *str9; // 0xa84c
    if (*(char *)v42 == 0) {
        // 0xa858
        *(int16_t *)v42 = 46;
    }
    char * found_char_pos2 = strchr((char *)*str10, 63); // 0xa869
    if (found_char_pos2 != NULL) {
        int64_t str12 = a1 + 264; // 0xa87a
        char * str11 = (char *)((int64_t)found_char_pos2 + 1); // 0xa88b
        httpd_realloc_str(str12, a1 + 416, (int64_t)strlen(str11));
        strcpy((char *)*(int64_t *)str12, str11);
        char * found_char_pos3 = strchr((char *)*str9, 63); // 0xa8b9
        if (found_char_pos3 != NULL) {
            // 0xa8c3
            *found_char_pos3 = 0;
        }
    }
    uint64_t v43 = *str9; // 0xa8cb
    char * str13 = (char *)v43; // 0xa8d9
    char * substr_pos = strstr(str13, "//"); // 0xa8d9
    if (substr_pos != NULL) {
        int64_t v44 = (int64_t)substr_pos + 1; // 0xa8f0
        int64_t v45 = v44 + 1; // 0xa900
        char * str14 = (char *)v45;
        int64_t v46 = v45; // 0xa908
        while (*str14 == 47) {
            // 0xa900
            v45 = v46 + 1;
            str14 = (char *)v45;
            v46 = v45;
        }
        // 0xa90a
        memmove((int64_t *)v44, (int64_t *)v45, strlen(str14) + 1);
        char * substr_pos2 = strstr(str13, "//"); // 0xa92b
        while (substr_pos2 != NULL) {
            // 0xa8f0
            v44 = (int64_t)substr_pos2 + 1;
            v45 = v44 + 1;
            str14 = (char *)v45;
            v46 = v45;
            while (*str14 == 47) {
                // 0xa900
                v45 = v46 + 1;
                str14 = (char *)v45;
                v46 = v45;
            }
            // 0xa90a
            memmove((int64_t *)v44, (int64_t *)v45, strlen(str14) + 1);
            substr_pos2 = strstr(str13, "//");
        }
    }
    // 0xa938
    if (strncmp(str13, "./", 2) == 0) {
        int64_t str15 = v43 + 2; // 0xa950
        memmove((int64_t *)v43, (int64_t *)str15, strlen((char *)str15) + 1);
        while (strncmp(str13, "./", 2) == 0) {
            // 0xa960
            memmove((int64_t *)v43, (int64_t *)str15, strlen((char *)str15) + 1);
        }
    }
    char * substr_pos3 = strstr(str13, "/./"); // 0xa99a
    if (substr_pos3 != NULL) {
        int64_t str16 = (int64_t)substr_pos3 + 2; // 0xa9b0
        memmove((int64_t *)substr_pos3, (int64_t *)str16, strlen((char *)str16) + 1);
        char * substr_pos4 = strstr(str13, "/./"); // 0xa9d1
        char * v47 = substr_pos4; // 0xa9dc
        while (substr_pos4 != NULL) {
            // 0xa9b0
            str16 = (int64_t)v47 + 2;
            memmove((int64_t *)v47, (int64_t *)str16, strlen((char *)str16) + 1);
            substr_pos4 = strstr(str13, "/./");
            v47 = substr_pos4;
        }
    }
    int64_t str17 = v43 + 3; // 0xa9de
    while (true) {
        // 0xaa17
        int64_t v48; // 0xa410
        int32_t len; // 0xa410
        int64_t v49; // 0xa410
        if (strncmp(str13, "../", 3) == 0) {
            // 0xaa00
            len = strlen((char *)str17);
            v48 = v43;
            v49 = str17;
        } else {
            char * substr_pos5 = strstr(str13, "/../"); // 0xaa31
            int64_t v50 = (int64_t)substr_pos5; // 0xaa31
            if (substr_pos5 == NULL) {
                // break -> 0xaa80
                break;
            }
            int64_t v51 = v50;
            int64_t v52 = v51 - 1;
            while (v52 >= v43) {
                // 0xaa58
                if (*(char *)v52 == 47) {
                    // break -> 0xaa64
                    break;
                }
                v51 = v52;
                v52 = v51 - 1;
            }
            int64_t str18 = v50 + 4; // 0xaa64
            len = strlen((char *)str18);
            v48 = v51;
            v49 = str18;
        }
        // 0xaa12
        memmove((int64_t *)v48, (int64_t *)v49, len + 1);
    }
    int32_t len2 = strlen(str13); // 0xaa83
    if (len2 >= 4) {
        int64_t v53 = v43 + (int64_t)len2;
        while (strcmp((char *)(v53 - 3), "/..") == 0) {
            int64_t v54 = v53 - 4; // 0xaab7
            if (v54 < v43) {
                // break (via goto) -> 0xaae2
                goto lab_0xaae2;
            }
            char * v55 = (char *)v54;
            v54--;
            while (*v55 != 47) {
                // 0xaac0
                if (v54 < v43) {
                    // break (via goto) -> 0xaae2
                    goto lab_0xaae2;
                }
                // 0xaac5
                v55 = (char *)v54;
                v54--;
            }
            // 0xaad1
            *v55 = 0;
            int32_t len3 = strlen(str13); // 0xaad8
            if (len3 <= 3) {
                // break -> 0xaae2
                break;
            }
            v53 = v43 + (int64_t)len3;
        }
    }
  lab_0xaae2:;
    int64_t v56 = *str9; // 0xaae7
    char v57 = *(char *)v56; // 0xaaea
    if (v57 == 47) {
        goto lab_0xb354_2;
    } else {
        if (v57 != 46) {
            goto lab_0xab13;
        } else {
            // 0xaafa
            if (*(char *)(v56 + 1) != 46) {
                goto lab_0xab13;
            } else {
                // 0xab00
                switch (*(char *)(v56 + 2)) {
                    case 47: {
                        goto lab_0xb354_2;
                    }
                    case 0: {
                        goto lab_0xb354_2;
                    }
                    default: {
                        goto lab_0xab13;
                    }
                }
            }
        }
    }
  lab_0xab13:
    // 0xab13
    if (*(int32_t *)(a1 + 520) != 0) {
        uint64_t v58 = *v2; // 0xab26
        uint64_t v59 = *v1; // 0xab2d
        if (v59 < v58) {
            // 0xab3d
            v60 = a1 + 296;
            v61 = a1 + 432;
            v62 = a1 + 16;
            v63 = a1 + 288;
            v64 = a1 + 424;
            v65 = (int64_t *)(a1 + 144);
            str55 = (int64_t *)v60;
            str54 = (int64_t *)v63;
            v66 = (int64_t *)(a1 + 336);
            v67 = (int64_t *)(a1 + 272);
            v68 = v59;
            v69 = v58;
            while (true) {
              lab_0xab84:;
                int64_t v70 = -v69; // 0xab94
                int64_t v71 = v68; // 0xab97
                char * v72; // 0xa410
                char v73; // 0xaba0
                while (true) {
                  lab_0xaba0:;
                    int64_t v74 = v71;
                    v72 = (char *)(v74 + *v65);
                    v73 = *v72;
                    switch (v73) {
                        case 13: {
                            goto lab_0xabd2;
                        }
                        case 10: {
                            goto lab_0xabd2;
                        }
                        default: {
                            int64_t v75 = v74 + 1;
                            *v1 = v75;
                            v71 = v75;
                            if (v70 == -1 - v74) {
                                // break (via goto) -> 0xb242
                                goto lab_0xb242_4;
                            }
                            goto lab_0xaba0;
                        }
                    }
                }
              lab_0xabd2:
                // 0xabd2
                *v72 = 0;
                v76 = *v1 + 1;
                *v1 = v76;
                if (v73 != 13) {
                    goto lab_0xac17;
                } else {
                    // 0xabf3
                    if (v76 >= *v2) {
                        goto lab_0xac17;
                    } else {
                        int64_t v77 = *v65; // 0xabfc
                        char * v78 = (char *)(v77 + v76); // 0xac03
                        v79 = v77;
                        if (*v78 != 10) {
                            goto lab_0xac27;
                        } else {
                            // 0xac0a
                            *v78 = 0;
                            *v1 = *v1 + 1;
                            goto lab_0xac17;
                        }
                    }
                }
            }
        }
    }
  lab_0xb242_4:
    // 0xb242
    if (*(int32_t *)(a1 + 524) == 0) {
        goto lab_0xb282;
    } else {
        // 0xb251
        if (*(char *)*(int64_t *)(a1 + 328) != 0) {
            goto lab_0xb26d;
        } else {
            // 0xb25d
            if (*(char *)*(int64_t *)(a1 + 336) == 0) {
                goto lab_0xb354_2;
            } else {
                goto lab_0xb26d;
            }
        }
    }
  lab_0xb282:;
    int64_t v80 = a1 + 240; // 0xb282
    int64_t v81 = a1 + 392; // 0xb289
    httpd_realloc_str(v80, v81, (int64_t)strlen((char *)*str9));
    int64_t * str19 = (int64_t *)v80; // 0xb2b1
    strcpy((char *)*str19, (char *)*str9);
    int64_t * v82 = (int64_t *)(a1 + 8); // 0xb2bd
    int64_t v83 = *v82; // 0xb2bd
    int32_t * v84; // 0xa410
    int64_t v85; // 0xa410
    int64_t v86; // 0xa410
    int64_t v87; // 0xa410
    int64_t v88; // 0xa410
    int64_t v89; // 0xa410
    int64_t v90; // 0xa410
    char * addr; // bp-176, 0xa410
    if (*(int32_t *)(v83 + 100) == 0) {
        // 0xb282
        v84 = (int32_t *)(a1 + 532);
        v89 = v83;
        v86 = a5;
        v88 = a6;
        goto lab_0xb459;
    } else {
        int64_t v91 = *(int64_t *)(a1 + 328); // 0xb2cb
        v90 = v91;
        v85 = a5;
        v87 = a6;
        if (*(char *)v91 != 0) {
            goto lab_0xb2e9;
        } else {
            int64_t v92 = *(int64_t *)(a1 + 336); // 0xb2d8
            v90 = v92;
            v85 = a5;
            v87 = a6;
            if (*(char *)v92 == 0) {
                int32_t addr_len = 128; // bp-220, 0xb5cb
                int32_t sock = *(int32_t *)(a1 + 704); // 0xb5d3
                if (getsockname(sock, (struct sockaddr *)&addr, &addr_len) < 0) {
                    // 0xb644
                    syslog(LOG_ERR, "getsockname - %m", (int64_t)&addr_len);
                    goto lab_0xb657;
                } else {
                    int16_t v93 = (int64_t)addr; // 0xb5f4
                    int32_t salen = v93 != 2 ? v93 != 10 ? 0 : 28 : 16; // 0xb609
                    int32_t v94 = getnameinfo((struct sockaddr *)&addr, salen, (char *)&g99, 200, NULL, 0, 1); // 0xb62d
                    if (v94 == 0) {
                        // 0xb680
                        v90 = (int64_t)&g99;
                        v85 = 0;
                        v87 = 0;
                        int32_t v95; // 0xa410
                        if (v95 == -0x10000 == (v95 || v95) == 0) {
                            // 0xb6a4
                            v90 = (int64_t)&g99;
                            v85 = 0;
                            v87 = 0;
                            if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                                int32_t len4 = strlen((char *)&g101); // 0xb6cc
                                memmove((int64_t *)&g99, (int64_t *)&g101, len4 + 1);
                                v90 = (int64_t)&g99;
                                v85 = 0;
                                v87 = 0;
                            }
                        }
                    } else {
                        // 0xb636
                        *(int16_t *)&g99 = 63;
                        v90 = (int64_t)&g99;
                        v85 = 0;
                        v87 = 0;
                    }
                    goto lab_0xb2e9;
                }
            } else {
                goto lab_0xb2e9;
            }
        }
    }
  lab_0xb26d:
    // 0xb26d
    if (*(int32_t *)(a1 + 552) != 0) {
        // 0xb277
        *(int32_t *)(a1 + 556) = 1;
    }
    goto lab_0xb282;
  lab_0xb459:;
    int32_t v96 = *(int32_t *)(v89 + 96); // 0xb460
    uint32_t v97 = *v84; // 0xb463
    int64_t v98 = expand_symlinks(*str19, (int64_t *)&addr, v96, v97); // 0xb46f
    if (v98 == 0) {
        goto lab_0xb657;
    } else {
        char * str20 = (char *)v98; // 0xb483
        httpd_realloc_str(v80, v81, (int64_t)strlen(str20));
        strcpy((char *)*str19, str20);
        int64_t v99 = a1 + 256; // 0xb4a5
        httpd_realloc_str(v99, a1 + 408, (int64_t)strlen(addr));
        int64_t * str21 = (int64_t *)v99; // 0xb4ce
        strcpy((char *)*str21, addr);
        char * str23 = (char *)*str21; // 0xb4e4
        if (*str23 != 0) {
            int64_t str22 = *str9; // 0xb4ee
            int64_t v100 = (int64_t)strlen((char *)str22) - (int64_t)strlen(str23); // 0xb504
            if ((int32_t)v100 >= 1) {
                // 0xb50b
                if (strcmp((char *)((0x100000000 * v100 >> 32) + str22), str23) == 0) {
                    // 0xb51d
                    *(char *)((v100 + 0xffffffff & 0xffffffff) + str22) = 0;
                }
            }
        }
        int64_t v101 = *str19; // 0xb525
        char * str25 = (char *)v101; // 0xb52a
        if (*str25 != 47) {
            // 0xb366
            return 0;
        }
        int64_t v102 = *(int64_t *)(*v82 + 64); // 0xb538
        char * str24 = (char *)v102; // 0xb53f
        int32_t len5 = strlen(str24); // 0xb53f
        int64_t v103 = len5; // 0xb53f
        if (strncmp(str25, str24, len5) == 0) {
            int64_t str26 = v101 + v103; // 0xb5ac
            memmove((int64_t *)v101, (int64_t *)str26, strlen((char *)str26) + 1);
            // 0xb366
            return 0;
        }
        // 0xb559
        httpd_ntoa(a1 + 16, v102, v103, (int64_t)v97, v86, v88);
        int64_t v104 = *str10; // 0xb562
        syslog(LOG_NOTICE, "%.80s URL \"%.80s\" goes outside the web tree", (char *)&g99, (char *)v104);
        v17 = (int64_t)"Forbidden";
        v18 = 403;
        v19 = (int64_t)"The requested URL '%.80s' resolves to a file outside the permitted web server directory tree.\n";
        v20 = *str10;
        goto lab_0xb35c;
    }
  lab_0xb2e9:;
    int64_t * str27 = (int64_t *)(a1 + 512); // 0xb2e9
    *str27 = v90;
    char v105 = *(char *)v90; // 0xb2f0
    if (v105 != 0) {
        int16_t ** v106 = __ctype_b_loc(); // 0xb2fb
        int64_t v107 = 0x100000000000000 * (int64_t)v105;
        int32_t * v108; // 0xb330
        if (*(char *)((int64_t)*v106 + 1 + (v107 >> 55)) % 2 != 0) {
            // 0xb32b
            v108 = *__ctype_tolower_loc();
            *(char *)v90 = *(char *)((v107 >> 54) + (int64_t)v108);
        }
        int64_t v109 = v90 + 1;
        char v110 = *(char *)v109; // 0xb310
        while (v110 != 0) {
            int64_t v111 = v109;
            v107 = 0x100000000000000 * (int64_t)v110;
            if (*(char *)((int64_t)*v106 + 1 + (v107 >> 55)) % 2 != 0) {
                // 0xb32b
                v108 = *__ctype_tolower_loc();
                *(char *)v111 = *(char *)((v107 >> 54) + (int64_t)v108);
            }
            // 0xb310
            v109 = v111 + 1;
            v110 = *(char *)v109;
        }
    }
    int32_t * v112 = (int32_t *)(a1 + 532);
    if (*v112 == 0) {
        int64_t v113 = a1 + 344; // 0xb388
        httpd_realloc_str(v113, a1 + 448, (int64_t)strlen((char *)*str27));
        int64_t * str28 = (int64_t *)v113; // 0xb3b0
        strcpy((char *)*str28, (char *)*str27);
        int64_t len6 = strlen((char *)*str19); // 0xb3cf
        httpd_realloc_str((int64_t)&g102, (int64_t)&g103, len6);
        strcpy(g102, (char *)*str19);
        httpd_realloc_str(v80, v81, len6 + 1 + (int64_t)strlen((char *)*str28));
        strcpy((char *)*str19, (char *)*str28);
        int64_t str29 = *str19; // 0xb42d
        *(int16_t *)(str29 + (int64_t)strlen((char *)str29)) = 47;
        strcat((char *)*str19, g102);
    }
    // 0xb455
    v84 = v112;
    v89 = *v82;
    v86 = v85;
    v88 = v87;
    goto lab_0xb459;
  lab_0xb657:
    // 0xb657
    v17 = (int64_t)"Internal Error";
    v18 = 500;
    v19 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n";
    v20 = *str10;
    goto lab_0xb35c;
}

// Address range: 0xb710 - 0xbd66
int64_t expand_symlinks(int64_t a1, int64_t * a2, int32_t a3, int32_t a4) {
    char * path = (char *)a1;
    int64_t buf; // bp-5048, 0xb710
    if (a3 != 0) {
        // 0xb731
        if (stat(path, (struct stat *)&buf) != -1) {
            int64_t len = strlen(path); // 0xb74a
            httpd_realloc_str((int64_t)&g104, (int64_t)&g106, len);
            strcpy(g104, path);
            int64_t v1 = (int64_t)g104 + len;
            if (*(char *)(v1 - 1) == 47) {
                int64_t v2 = len; // 0xb79e
                int64_t v3 = len - 2;
                v2--;
                *(char *)(v1 - 1) = 0;
                int64_t v4 = (int64_t)g104; // 0xb7a3
                int64_t v5 = v2 + v4; // 0xb7be
                int64_t v6 = v3 - 1; // 0xb7be
                while (*(char *)(v3 + v4) == 47) {
                    // 0xb7a0
                    v3 = v6;
                    v2--;
                    *(char *)(v5 - 1) = 0;
                    v4 = (int64_t)g104;
                    v5 = v2 + v4;
                    v6 = v3 - 1;
                }
            }
            // 0xb7c0
            httpd_realloc_str((int64_t)&g105, (int64_t)&g107, 0);
            *g105 = 0;
            *a2 = (int64_t)g105;
          lab_0xbd17:
            // 0xbd1e
            return (int64_t)g104;
        }
    }
    // 0xb7ee
    httpd_realloc_str((int64_t)&g104, (int64_t)&g106, 1);
    *g104 = 0;
    int64_t len2 = strlen(path); // 0xb818
    httpd_realloc_str((int64_t)&g105, (int64_t)&g107, len2);
    strcpy(g105, path);
    int64_t v7 = (int64_t)g105;
    char * v8 = (char *)(len2 - 1 + v7);
    int64_t v9 = v7; // 0xb857
    if (*v8 == 47) {
        // 0xb859
        *v8 = 0;
        v9 = (int64_t)g105;
    }
    int64_t v10 = v9; // 0xb86b
    int64_t v11 = len2; // 0xb86b
    if (a4 == 0) {
        // 0xb896
        v10 = v9;
        v11 = len2;
        if (*g105 == 47) {
            int64_t str = v9 + 1; // 0xb870
            memmove((int64_t *)v9, (int64_t *)str, strlen((char *)str) + 1);
            int64_t v12 = len2 - 1; // 0xb88b
            int64_t v13 = (int64_t)g105;
            int64_t v14 = v12; // 0xb89a
            int64_t v15 = v13; // 0xb89a
            v10 = v13;
            v11 = v12;
            while (*g105 == 47) {
                // 0xb870
                str = v15 + 1;
                memmove((int64_t *)v15, (int64_t *)str, strlen((char *)str) + 1);
                v12 = v14 - 1;
                v13 = (int64_t)g105;
                v14 = v12;
                v15 = v13;
                v10 = v13;
                v11 = v12;
            }
        }
    }
    int64_t v16 = v10; // 0xb89f
    char * v17; // 0xb710
    int64_t format; // 0xb710
    if (v11 != 0) {
        int32_t v18 = 0; // 0xb710
        int64_t v19 = 0;
        int64_t v20 = v10; // 0xb710
        int64_t v21 = v11; // 0xb710
        int64_t v22; // 0xb710
        int64_t v23; // 0xb710
        int64_t v24; // 0xb710
        int64_t v25; // 0xb710
        int64_t v26; // 0xb710
        int64_t v27; // 0xb710
        int64_t v28; // 0xb710
        int64_t v29; // 0xb710
        int64_t v30; // 0xb710
        int64_t v31; // 0xb710
        int64_t v32; // 0xb710
        char * str2; // 0xb8d7
        char * found_char_pos; // 0xb8d7
        int64_t v33; // 0xb8e8
        int32_t v34; // 0xb8eb
        int64_t v35; // 0xb710
        int64_t v36; // 0xb9d0
        char * found_char_pos2; // 0xbb01
        int64_t str3; // 0xba7a
        int64_t v37; // 0xb9ab
        int64_t v38; // 0xba52
        int64_t n; // 0xb91b
        int64_t v39; // 0xb710
        int64_t v40; // 0xbaf2
        int64_t v41; // 0xbb12
        int32_t v42; // 0xba97
        char * found_char_pos3; // 0xbacd
        int64_t v43; // 0xb942
        uint32_t v44; // 0xbaab
        int64_t v45; // 0xbade
        while (true) {
            // 0xb8cf
            v28 = v21;
            v27 = v20;
            v22 = v19;
            str2 = (char *)v27;
            found_char_pos = strchr(str2, 47);
            if (found_char_pos == NULL) {
                // 0xb970
                if (strcmp(str2, "..") == 0) {
                    // 0xba12
                    v29 = v28;
                    v30 = 0;
                    v26 = 0;
                    if (v22 != 0) {
                        // 0xbaf2
                        found_char_pos2 = strrchr(g104, 47);
                        if (found_char_pos2 == NULL) {
                            // 0xbc5a
                            *g104 = 0;
                            v29 = v28;
                            v30 = 0;
                            v26 = 0;
                        } else {
                            // 0xbb0f
                            v40 = (int64_t)g104;
                            v41 = (int64_t)found_char_pos2 - v40;
                            v32 = v41 != 0 ? v41 : 1;
                            *(char *)(v32 + v40) = 0;
                            v29 = v28;
                            v30 = 0;
                            v26 = v32;
                        }
                    }
                } else {
                    // 0xb987
                    v35 = v22 + 1;
                    httpd_realloc_str((int64_t)&g104, (int64_t)&g106, v28 + v35);
                    v25 = 0;
                    if (v22 != 0) {
                        // 0xb9ab
                        v37 = (int64_t)g104;
                        v25 = v22;
                        if (*(char *)(v22 - 1 + v37) != 47) {
                            // 0xb9c1
                            *(char *)(v22 + v37) = 47;
                            v25 = v35;
                        }
                    }
                    // 0xba60
                    strcpy((char *)(v25 + (int64_t)g104), str2);
                    v29 = v28;
                    v30 = 0;
                    v26 = v25 + v28;
                }
            } else {
                // 0xb8e5
                v33 = (int64_t)found_char_pos - v27;
                v34 = v33;
                if (v34 == 0) {
                    // 0xb9d0
                    v36 = v22 + 1;
                    httpd_realloc_str((int64_t)&g104, (int64_t)&g106, v36);
                    strncpy((char *)(v22 + (int64_t)g104), str2, 1);
                    v24 = v36;
                } else {
                    // 0xb8f3
                    if (strncmp(str2, "..", v34 < 3 == (2 - v34 & v34) < 0 ? v34 : 2) == 0) {
                        // 0xba04
                        v24 = 0;
                        if (v22 != 0) {
                            // 0xbabb
                            found_char_pos3 = strrchr(g104, 47);
                            v24 = 0;
                            if (found_char_pos3 != NULL) {
                                // 0xbadb
                                v45 = (int64_t)found_char_pos3 - (int64_t)g104;
                                v24 = v45 != 0 ? v45 : 1;
                            }
                        }
                    } else {
                        // 0xb918
                        n = 0x100000000 * v33 >> 32;
                        v39 = v22 + 1;
                        httpd_realloc_str((int64_t)&g104, (int64_t)&g106, n + v39);
                        v23 = 0;
                        if (v22 != 0) {
                            // 0xb942
                            v43 = (int64_t)g104;
                            v23 = v22;
                            if (*(char *)(v22 - 1 + v43) != 47) {
                                // 0xb958
                                *(char *)(v22 + v43) = 47;
                                v23 = v39;
                            }
                        }
                        // 0xba28
                        strncpy((char *)(v23 + (int64_t)g104), str2, (int32_t)n);
                        v24 = v23 + n;
                    }
                }
                // 0xba43
                *(char *)(v24 + (int64_t)g104) = 0;
                v38 = 0x100000000 * v33 + 0x100000000 >> 32;
                v29 = v38;
                v30 = v28 - v38;
                v26 = v24;
            }
            // 0xba7a
            v19 = v26;
            v31 = v30;
            str3 = v29 + v27;
            if (*g104 != 0) {
                // 0xba8d
                v42 = readlink(g104, (char *)&buf, (int32_t)&g12);
                if (v42 != -1) {
                    // break -> 0xbb28
                    break;
                }
                // 0xbaa6
                v44 = *__errno_location();
                if (v44 != 22) {
                    if (v44 < 21) {
                        if ((1 << v44 % 32 & 0x102004) == 0) {
                            goto lab_0xbd33;
                        } else {
                            // 0xbcea
                            *a2 = v31 - v28 + str3;
                            if (v22 == 0) {
                                // 0xbd0b
                                *(int16_t *)g104 = 46;
                                return (int64_t)g104;
                            } else {
                                // 0xbcfd
                                *(char *)(v22 + (int64_t)g104) = 0;
                                return (int64_t)g104;
                            }
                        }
                    } else {
                        goto lab_0xbd33;
                    }
                }
            }
            // 0xb8c0
            v20 = str3;
            v21 = v31;
            v16 = str3;
            if (v31 == 0) {
                // break (via goto) -> 0xbcc0
                goto lab_0xbcc0;
            }
        }
        // 0xbb28
        v17 = path;
        format = (int64_t)"too many symlinks in %.80s";
        if (v18 == 32) {
            goto lab_0xbd48;
        }
        int64_t v46 = v42; // 0xba97
        int64_t v47; // bp-5080, 0xb710
        int64_t v48 = v46 + (int64_t)&v47;
        *(char *)(v48 + 32) = 0;
        char * v49 = (char *)(v48 + 31); // 0xbb3c
        char v50 = *v49; // 0xbb3c
        *v49 = v50 == 47 ? 0 : v50;
        int64_t v51 = (int64_t)(v50 == 47) + v46; // 0xbb50
        int64_t v52; // 0xb710
        int64_t v53; // 0xb710
        int64_t v54; // 0xb710
        int64_t v55; // 0xb710
        int64_t v56; // 0xb710
        int64_t v57; // 0xb710
        int64_t v58; // 0xbbf2
        int64_t v59; // 0xbc04
        int64_t v60; // 0xbc17
        int64_t v61; // 0xb710
        int64_t v62; // 0xbb7f
        int32_t v63; // 0xb710
        int64_t v64; // 0xbba5
        int64_t v65; // 0xbbad
        int64_t v66; // 0xb710
        int64_t v67; // 0xbbd1
        int64_t v68; // 0xbbd5
        int64_t v69; // 0xbbe0
        int64_t v70; // 0xb710
        if (v31 == 0) {
            // 0xbc68
            httpd_realloc_str((int64_t)&g105, (int64_t)&g107, v51);
            strcpy(g105, (char *)&buf);
            v52 = v51;
        } else {
            // 0xbb5d
            memmove((int64_t *)g105, (int64_t *)str3, strlen((char *)str3) + 1);
            v61 = v51 + 1;
            v62 = v61 + v31;
            httpd_realloc_str((int64_t)&g105, (int64_t)&g107, v62);
            v63 = v31;
            if (v63 > -1) {
                // 0xbba5
                v64 = v31 & 0xffffffff;
                v65 = (v31 + 1) % 4;
                v53 = v64;
                v57 = v65;
                v54 = v64;
                if (v65 != 0) {
                    v66 = v53 + (int64_t)g105;
                    *(char *)(v66 + v61) = *(char *)v66;
                    v67 = v53 - 1;
                    v68 = v57 - 1;
                    v53 = v67;
                    v57 = v68;
                    v54 = v67;
                    while (v68 != 0) {
                        // 0xbbc0
                        v66 = v53 + (int64_t)g105;
                        *(char *)(v66 + v61) = *(char *)v66;
                        v67 = v53 - 1;
                        v68 = v57 - 1;
                        v53 = v67;
                        v57 = v68;
                        v54 = v67;
                    }
                }
                // 0xbbdb
                v55 = v54;
                if (v63 >= 3) {
                    v56 = v55;
                    v69 = (int64_t)g105;
                    v70 = v56 + v51;
                    *(char *)(v70 + 1 + v69) = *(char *)(v56 + v69);
                    v58 = (int64_t)g105;
                    *(char *)(v70 + v58) = *(char *)(v56 - 1 + v58);
                    v59 = (int64_t)g105;
                    *(char *)(v70 - 1 + v59) = *(char *)(v56 - 2 + v59);
                    v60 = (int64_t)g105;
                    *(char *)(v70 - 2 + v60) = *(char *)(v56 - 3 + v60);
                    v55 = v56 - 4;
                    while (v56 != 3) {
                        // 0xbbe0
                        v56 = v55;
                        v69 = (int64_t)g105;
                        v70 = v56 + v51;
                        *(char *)(v70 + 1 + v69) = *(char *)(v56 + v69);
                        v58 = (int64_t)g105;
                        *(char *)(v70 + v58) = *(char *)(v56 - 1 + v58);
                        v59 = (int64_t)g105;
                        *(char *)(v70 - 1 + v59) = *(char *)(v56 - 2 + v59);
                        v60 = (int64_t)g105;
                        *(char *)(v70 - 2 + v60) = *(char *)(v56 - 3 + v60);
                        v55 = v56 - 4;
                    }
                }
            }
            // 0xbc34
            strcpy(g105, (char *)&buf);
            *(char *)(v51 + (int64_t)g105) = 47;
            v52 = v62;
        }
        int64_t v71 = v52;
        int64_t v72 = (int64_t)g105;
        int64_t v73 = *g105 == 47 ? 0 : v22; // 0xbcae
        *(char *)(v73 + (int64_t)g104) = 0;
        v18++;
        v16 = v72;
        while (v71 != 0) {
            // 0xb8cf
            v19 = v73;
            v20 = v72;
            v21 = v71;
            while (true) {
                // 0xb8cf
                v28 = v21;
                v27 = v20;
                v22 = v19;
                str2 = (char *)v27;
                found_char_pos = strchr(str2, 47);
                if (found_char_pos == NULL) {
                    // 0xb970
                    if (strcmp(str2, "..") == 0) {
                        // 0xba12
                        v29 = v28;
                        v30 = 0;
                        v26 = 0;
                        if (v22 != 0) {
                            // 0xbaf2
                            found_char_pos2 = strrchr(g104, 47);
                            if (found_char_pos2 == NULL) {
                                // 0xbc5a
                                *g104 = 0;
                                v29 = v28;
                                v30 = 0;
                                v26 = 0;
                            } else {
                                // 0xbb0f
                                v40 = (int64_t)g104;
                                v41 = (int64_t)found_char_pos2 - v40;
                                v32 = v41 != 0 ? v41 : 1;
                                *(char *)(v32 + v40) = 0;
                                v29 = v28;
                                v30 = 0;
                                v26 = v32;
                            }
                        }
                    } else {
                        // 0xb987
                        v35 = v22 + 1;
                        httpd_realloc_str((int64_t)&g104, (int64_t)&g106, v28 + v35);
                        v25 = 0;
                        if (v22 != 0) {
                            // 0xb9ab
                            v37 = (int64_t)g104;
                            v25 = v22;
                            if (*(char *)(v22 - 1 + v37) != 47) {
                                // 0xb9c1
                                *(char *)(v22 + v37) = 47;
                                v25 = v35;
                            }
                        }
                        // 0xba60
                        strcpy((char *)(v25 + (int64_t)g104), str2);
                        v29 = v28;
                        v30 = 0;
                        v26 = v25 + v28;
                    }
                } else {
                    // 0xb8e5
                    v33 = (int64_t)found_char_pos - v27;
                    v34 = v33;
                    if (v34 == 0) {
                        // 0xb9d0
                        v36 = v22 + 1;
                        httpd_realloc_str((int64_t)&g104, (int64_t)&g106, v36);
                        strncpy((char *)(v22 + (int64_t)g104), str2, 1);
                        v24 = v36;
                    } else {
                        // 0xb8f3
                        if (strncmp(str2, "..", v34 < 3 == (2 - v34 & v34) < 0 ? v34 : 2) == 0) {
                            // 0xba04
                            v24 = 0;
                            if (v22 != 0) {
                                // 0xbabb
                                found_char_pos3 = strrchr(g104, 47);
                                v24 = 0;
                                if (found_char_pos3 != NULL) {
                                    // 0xbadb
                                    v45 = (int64_t)found_char_pos3 - (int64_t)g104;
                                    v24 = v45 != 0 ? v45 : 1;
                                }
                            }
                        } else {
                            // 0xb918
                            n = 0x100000000 * v33 >> 32;
                            v39 = v22 + 1;
                            httpd_realloc_str((int64_t)&g104, (int64_t)&g106, n + v39);
                            v23 = 0;
                            if (v22 != 0) {
                                // 0xb942
                                v43 = (int64_t)g104;
                                v23 = v22;
                                if (*(char *)(v22 - 1 + v43) != 47) {
                                    // 0xb958
                                    *(char *)(v22 + v43) = 47;
                                    v23 = v39;
                                }
                            }
                            // 0xba28
                            strncpy((char *)(v23 + (int64_t)g104), str2, (int32_t)n);
                            v24 = v23 + n;
                        }
                    }
                    // 0xba43
                    *(char *)(v24 + (int64_t)g104) = 0;
                    v38 = 0x100000000 * v33 + 0x100000000 >> 32;
                    v29 = v38;
                    v30 = v28 - v38;
                    v26 = v24;
                }
                // 0xba7a
                v19 = v26;
                v31 = v30;
                str3 = v29 + v27;
                if (*g104 != 0) {
                    // 0xba8d
                    v42 = readlink(g104, (char *)&buf, (int32_t)&g12);
                    if (v42 != -1) {
                        // break -> 0xbb28
                        break;
                    }
                    // 0xbaa6
                    v44 = *__errno_location();
                    if (v44 != 22) {
                        if (v44 < 21) {
                            if ((1 << v44 % 32 & 0x102004) == 0) {
                                goto lab_0xbd33;
                            } else {
                                // 0xbcea
                                *a2 = v31 - v28 + str3;
                                if (v22 == 0) {
                                    // 0xbd0b
                                    *(int16_t *)g104 = 46;
                                    return (int64_t)g104;
                                } else {
                                    // 0xbcfd
                                    *(char *)(v22 + (int64_t)g104) = 0;
                                    return (int64_t)g104;
                                }
                            }
                        } else {
                            goto lab_0xbd33;
                        }
                    }
                }
                // 0xb8c0
                v20 = str3;
                v21 = v31;
                v16 = str3;
                if (v31 == 0) {
                    // break (via goto) -> 0xbcc0
                    goto lab_0xbcc0;
                }
            }
            // 0xbb28
            v17 = path;
            format = (int64_t)"too many symlinks in %.80s";
            if (v18 == 32) {
                goto lab_0xbd48;
            }
            // 0xbb33
            v46 = v42;
            v48 = v46 + (int64_t)&v47;
            *(char *)(v48 + 32) = 0;
            v49 = (char *)(v48 + 31);
            v50 = *v49;
            *v49 = v50 == 47 ? 0 : v50;
            v51 = (int64_t)(v50 == 47) + v46;
            if (v31 == 0) {
                // 0xbc68
                httpd_realloc_str((int64_t)&g105, (int64_t)&g107, v51);
                strcpy(g105, (char *)&buf);
                v52 = v51;
            } else {
                // 0xbb5d
                memmove((int64_t *)g105, (int64_t *)str3, strlen((char *)str3) + 1);
                v61 = v51 + 1;
                v62 = v61 + v31;
                httpd_realloc_str((int64_t)&g105, (int64_t)&g107, v62);
                v63 = v31;
                if (v63 > -1) {
                    // 0xbba5
                    v64 = v31 & 0xffffffff;
                    v65 = (v31 + 1) % 4;
                    v53 = v64;
                    v57 = v65;
                    v54 = v64;
                    if (v65 != 0) {
                        v66 = v53 + (int64_t)g105;
                        *(char *)(v66 + v61) = *(char *)v66;
                        v67 = v53 - 1;
                        v68 = v57 - 1;
                        v53 = v67;
                        v57 = v68;
                        v54 = v67;
                        while (v68 != 0) {
                            // 0xbbc0
                            v66 = v53 + (int64_t)g105;
                            *(char *)(v66 + v61) = *(char *)v66;
                            v67 = v53 - 1;
                            v68 = v57 - 1;
                            v53 = v67;
                            v57 = v68;
                            v54 = v67;
                        }
                    }
                    // 0xbbdb
                    v55 = v54;
                    if (v63 >= 3) {
                        v56 = v55;
                        v69 = (int64_t)g105;
                        v70 = v56 + v51;
                        *(char *)(v70 + 1 + v69) = *(char *)(v56 + v69);
                        v58 = (int64_t)g105;
                        *(char *)(v70 + v58) = *(char *)(v56 - 1 + v58);
                        v59 = (int64_t)g105;
                        *(char *)(v70 - 1 + v59) = *(char *)(v56 - 2 + v59);
                        v60 = (int64_t)g105;
                        *(char *)(v70 - 2 + v60) = *(char *)(v56 - 3 + v60);
                        v55 = v56 - 4;
                        while (v56 != 3) {
                            // 0xbbe0
                            v56 = v55;
                            v69 = (int64_t)g105;
                            v70 = v56 + v51;
                            *(char *)(v70 + 1 + v69) = *(char *)(v56 + v69);
                            v58 = (int64_t)g105;
                            *(char *)(v70 + v58) = *(char *)(v56 - 1 + v58);
                            v59 = (int64_t)g105;
                            *(char *)(v70 - 1 + v59) = *(char *)(v56 - 2 + v59);
                            v60 = (int64_t)g105;
                            *(char *)(v70 - 2 + v60) = *(char *)(v56 - 3 + v60);
                            v55 = v56 - 4;
                        }
                    }
                }
                // 0xbc34
                strcpy(g105, (char *)&buf);
                *(char *)(v51 + (int64_t)g105) = 47;
                v52 = v62;
            }
            // 0xbc92
            v71 = v52;
            v72 = (int64_t)g105;
            v73 = *g105 == 47 ? 0 : v22;
            *(char *)(v73 + (int64_t)g104) = 0;
            v18++;
            v16 = v72;
        }
    }
  lab_0xbcc0:
    // 0xbcc0
    *a2 = v16;
    if (*g104 != 0) {
        // 0xbd1e
        return (int64_t)g104;
    }
    // 0xbcd4
    *(int16_t *)g104 = 46;
    // 0xbd1e
    return (int64_t)g104;
  lab_0xbd48:
    // 0xbd48
    syslog(LOG_ERR, (char *)format, v17);
    return 0;
  lab_0xbd33:
    // 0xbd33
    v17 = g104;
    format = (int64_t)"readlink %.80s - %m";
    goto lab_0xbd48;
}

// Address range: 0xbd70 - 0xc198
int64_t httpd_close_conn(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t * v1 = (int64_t *)(a1 + 8); // 0xbd86
    int64_t v2 = *v1; // 0xbd86
    int64_t fflush_rc = v2; // 0xbd8e
    int64_t v3; // 0xbd70
    int64_t v4; // bp-472, 0xbd70
    int64_t v5; // 0xbd94
    if (*(int32_t *)(v2 + 80) != 0) {
        goto lab_0xc148;
    } else {
        // 0xbd94
        v5 = *(int64_t *)(a1 + 360);
        if (*(int32_t *)(v2 + 100) == 0) {
            goto lab_0xbdb8;
        } else {
            // 0xbdaf
            if (*(int32_t *)(a1 + 532) == 0) {
                int64_t v6 = *(int64_t *)(a1 + 512); // 0xbddc
                int64_t v7 = v6; // 0xbde6
                if (v6 == 0) {
                    // 0xbde8
                    v7 = *(int64_t *)(v2 + 8);
                }
                int64_t v8 = *(int64_t *)(a1 + 208); // 0xbdec
                my_snprintf(&v4, (int64_t *)305, "/%.100s%.200s", v7, (char *)v8, a6);
                v3 = v8;
                goto lab_0xbe0e;
            } else {
                goto lab_0xbdb8;
            }
        }
    }
  lab_0xc148:;
    int64_t * v9 = (int64_t *)(a1 + 712); // 0xc148
    int64_t v10 = *v9; // 0xc148
    int64_t v11 = fflush_rc; // 0xc152
    if (v10 != 0) {
        int64_t v12 = mmc_unmap(v10, a1 + 560, (int64_t)a2); // 0xc15e
        *v9 = 0;
        v11 = v12;
    }
    int32_t * v13 = (int32_t *)(a1 + 704); // 0xc16e
    uint32_t fd = *v13; // 0xc16e
    int64_t result = v11; // 0xc176
    if (fd >= 0) {
        int32_t v14 = close(fd); // 0xc178
        *v13 = -1;
        result = v14;
    }
    // 0xc187
    return result;
  lab_0xbdb8:;
    int64_t v15 = *(int64_t *)(a1 + 208); // 0xbdb8
    my_snprintf(&v4, (int64_t *)305, "%.200s", v15, (char *)a5, a6);
    v3 = a5;
    goto lab_0xbe0e;
  lab_0xbe0e:;
    int64_t v16 = *(int64_t *)(a1 + 200); // 0xbe0e
    int64_t v17; // 0xbd70
    int64_t v18; // bp-632, 0xbd70
    if (v16 < 0) {
        // 0xbe34
        v18 = 45;
        v17 = 305;
    } else {
        // 0xbe1a
        my_snprintf(&v18, (int64_t *)40, "%lld", v16, (char *)v3, a6);
        v17 = 40;
    }
    int64_t v19 = *(char *)v5 != 0 ? v5 : (int64_t)"-"; // 0xbda5
    if (*(int64_t *)(*v1 + 88) == 0) {
        int64_t sa = a1 + 16; // 0xbe50
        int16_t v20 = *(int16_t *)sa; // 0xbe54
        int32_t salen = v20 != 2 ? v20 != 10 ? 0 : 28 : 16; // 0xbe6f
        int32_t v21 = getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1); // 0xbe8b
        if (v21 == 0) {
            // 0xc083
            if (*(int32_t *)(a1 + 24) == 0) {
                // 0xc089
                if (*(int32_t *)(a1 + 28) == 0) {
                    // 0xc08f
                    if (*(int32_t *)(a1 + 32) == -0x10000) {
                        // 0xc098
                        if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                            int32_t len = strlen((char *)&g101); // 0xc0bc
                            memmove((int64_t *)&g99, (int64_t *)&g101, len + 1);
                        }
                    }
                }
            }
        } else {
            // 0xbe98
            *(int16_t *)&g99 = 63;
        }
        uint32_t v22 = *(int32_t *)(a1 + 180) - 1; // 0xc0da
        int64_t v23 = (int64_t)"UNKNOWN"; // 0xc0e0
        if (v22 < 6) {
            // 0xc0e2
            v23 = *(int64_t *)((0x100000000 * (int64_t)v22 >> 29) + (int64_t)&g21);
        }
        int64_t v24 = *(int64_t *)(a1 + 224); // 0xc0f8
        int32_t v25 = *(int32_t *)(a1 + 184); // 0xc0ff
        __asm_movups(0, __asm_movups_1(*(int128_t *)(a1 + 272)));
        syslog(LOG_INFO, "%.80s - %.80s \"%.80s %.200s %.80s\" %d %s \"%.200s\" \"%.200s\"", (char *)&g99, (char *)v19, (char *)v23, &v4, (char *)v24, (int64_t)v25, &v18);
        fflush_rc = &g204;
    } else {
        int64_t time_val = v17; // 0xbe49
        if (a2 == NULL) {
            // 0xbea6
            time_val = time(NULL);
        }
        int64_t timep = time_val; // bp-640, 0xbead
        struct tm * time_info = localtime((int32_t *)&timep); // 0xbeb7
        int64_t str; // bp-152, 0xbd70
        strftime((char *)&str, 100, "%d/%b/%Y:%H:%M:%S", time_info);
        int64_t v26; // bp-584, 0xbd70
        my_snprintf(&v26, (int64_t *)100, "%s %c%04d", (int64_t)&str, (char *)43, 0);
        int64_t stream = *(int64_t *)(*v1 + 88); // 0xbf52
        int64_t sa2 = a1 + 16; // 0xbf56
        int16_t v27 = *(int16_t *)sa2; // 0xbf5a
        int32_t salen2 = v27 != 2 ? v27 != 10 ? 0 : 28 : 16; // 0xbf74
        int32_t v28 = getnameinfo((struct sockaddr *)sa2, salen2, (char *)&g99, 200, NULL, 0, 1); // 0xbf90
        if (v28 == 0) {
            // 0xbfa4
            if (*(int32_t *)(a1 + 24) == 0) {
                // 0xbfaa
                if (*(int32_t *)(a1 + 28) == 0) {
                    // 0xbfb0
                    if (*(int32_t *)(a1 + 32) == -0x10000) {
                        // 0xbfb9
                        if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                            int32_t len2 = strlen((char *)&g101); // 0xbfdd
                            memmove((int64_t *)&g99, (int64_t *)&g101, len2 + 1);
                        }
                    }
                }
            }
        } else {
            // 0xbf99
            *(int16_t *)&g99 = 63;
        }
        uint32_t v29 = *(int32_t *)(a1 + 180) - 1; // 0xbffb
        int64_t v30 = (int64_t)"UNKNOWN"; // 0xc001
        if (v29 < 6) {
            // 0xc003
            v30 = *(int64_t *)((0x100000000 * (int64_t)v29 >> 29) + (int64_t)&g21);
        }
        int64_t v31 = *(int64_t *)(a1 + 224); // 0xc019
        int32_t v32 = *(int32_t *)(a1 + 184); // 0xc020
        int128_t v33; // 0xbd70
        __asm_movups(v33, __asm_movups_1(*(int128_t *)(a1 + 272)));
        fprintf((struct _IO_FILE *)stream, "%.80s - %.80s [%s] \"%.80s %.300s %.80s\" %d %s \"%.200s\" \"%.200s\"\n", (char *)&g99, (char *)v19, &v26, (char *)v30, &v4, (char *)v31, (int64_t)v32, &v18);
        fflush_rc = fflush((struct _IO_FILE *)*(int64_t *)(*v1 + 88));
    }
    goto lab_0xc148;
}

// Address range: 0xc1a0 - 0xc251
int64_t httpd_destroy_conn(int64_t a1) {
    int64_t result; // 0xc1a0
    if ((int32_t)a1 != 0) {
        // 0xc1aa
        free((int64_t *)*(int64_t *)(a1 + 144));
        free((int64_t *)*(int64_t *)(a1 + 216));
        free((int64_t *)*(int64_t *)(a1 + 232));
        free((int64_t *)*(int64_t *)(a1 + 240));
        free((int64_t *)*(int64_t *)(a1 + 248));
        free((int64_t *)*(int64_t *)(a1 + 256));
        free((int64_t *)*(int64_t *)(a1 + 264));
        free((int64_t *)*(int64_t *)(a1 + 288));
        free((int64_t *)*(int64_t *)(a1 + 296));
        free((int64_t *)*(int64_t *)(a1 + 328));
        free((int64_t *)*(int64_t *)(a1 + 344));
        free((int64_t *)*(int64_t *)(a1 + 360));
        free((int64_t *)*(int64_t *)(a1 + 368));
        *(int32_t *)a1 = 0;
        result = &g204;
    }
    // 0xc24f
    return result;
}

// Address range: 0xc260 - 0xe841
int64_t httpd_start_request(int64_t a1, int64_t * a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int32_t fds[2]; // 0xdd7c
    int32_t fds2[2]; // 0xdf0b
    char * exec_argv[1]; // 0xdea5
    int64_t v1 = a1 + 240; // 0xc277
    int64_t * str7 = (int64_t *)v1; // 0xc277
    char * str = (char *)*str7; // 0xc281
    int32_t len = strlen(str); // 0xc281
    int64_t v2 = a1 + 560; // 0xc289
    struct stat * buf = (struct stat *)v2; // 0xc293
    int64_t v3 = (int64_t)"Internal Error"; // 0xc29f
    int64_t v4 = 500; // 0xc29f
    int64_t v5 = a1; // 0xc29f
    int64_t v6 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n"; // 0xc29f
    int64_t v7; // 0xc260
    int64_t v8; // 0xc260
    int64_t v9; // 0xc260
    int64_t v10; // 0xc260
    char * v11; // 0xc260
    int64_t result; // 0xc260
    int64_t v12; // 0xc260
    int64_t v13; // bp-4584, 0xc260
    int64_t v14; // 0xc26a
    char * str6; // 0xc44f
    int64_t v15; // 0xc454
    char * str8; // 0xc47d
    int64_t v16; // 0xc47d
    if (stat(str, buf) < 0) {
        goto lab_0xc5cc;
    } else {
        int32_t v17 = *(int32_t *)(a1 + 584); // 0xc2a5
        if ((v17 & 5) == 0) {
            int64_t sa = a1 + 16; // 0xc300
            int16_t v18 = *(int16_t *)sa; // 0xc304
            int32_t salen = v18 != 2 ? v18 != 10 ? 0 : 28 : 16; // 0xc320
            int32_t v19 = getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1); // 0xc33b
            if (v19 == 0) {
                // 0xc353
                if (*(int32_t *)(a1 + 24) == 0) {
                    // 0xc35a
                    if (*(int32_t *)(a1 + 28) == 0) {
                        // 0xc361
                        if (*(int32_t *)(a1 + 32) == -0x10000) {
                            // 0xc36b
                            if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                                int32_t len2 = strlen((char *)&g101); // 0xc38f
                                memmove((int64_t *)&g99, (int64_t *)&g101, len2 + 1);
                            }
                        }
                    }
                }
            } else {
                // 0xc348
                *(int16_t *)&g99 = 63;
            }
            int64_t v20 = *(int64_t *)(a1 + 208); // 0xc3a7
            syslog(LOG_INFO, "%.80s URL \"%.80s\" resolves to a non world-readable file", (char *)&g99, (char *)v20);
            v3 = (int64_t)"Forbidden";
            v4 = 403;
            v5 = a1;
            v6 = (int64_t)"The requested URL '%.80s' resolves to a file that is not world-readable.\n";
            goto lab_0xc5cc;
        } else {
            // 0xc2b0
            v14 = &v13;
            int64_t v21 = len; // 0xc281
            v12 = a4;
            v7 = v21;
            v10 = a1;
            if ((v17 & 0xf000) != 0x4000) {
                goto lab_0xc77e;
            } else {
                // 0xc2c7
                v3 = (int64_t)"Not Found";
                v4 = 404;
                v5 = a1;
                v6 = (int64_t)"The requested URL '%.80s' was not found on this server.\n";
                if (*(char *)*(int64_t *)(a1 + 256) == 0) {
                    int64_t v22 = *(int64_t *)(a1 + 232); // 0xc3f1
                    char * str2 = (char *)v22; // 0xc3f8
                    if (*str2 != 0) {
                        // 0xc3fd
                        if (strcmp(str2, ".") != 0) {
                            // 0xc410
                            if (*(char *)(v22 - 1 + (int64_t)strlen(str2)) != 47) {
                                int64_t * v23 = (int64_t *)(a1 + 208); // 0xc6aa
                                int64_t * v24 = (int64_t *)(a1 + 264); // 0xc6b1
                                char * v25 = (char *)*v24;
                                char * str3 = (char *)*v23;
                                if (*v25 == 0) {
                                    int32_t len3 = strlen(str3); // 0xcd83
                                    httpd_realloc_str((int64_t)&g112, (int64_t)&g114, (int64_t)len3 + 1);
                                    int64_t v26 = *v23; // 0xcdad
                                    my_snprintf((int64_t *)g112, (int64_t *)g114, "%s/", v26, (char *)a5, a6);
                                } else {
                                    char * found_char_pos = strchr(str3, 63); // 0xc6c9
                                    char * str5 = v25; // 0xc6d1
                                    char * str4 = str3; // 0xc6d1
                                    if (found_char_pos != NULL) {
                                        // 0xc6d3
                                        *found_char_pos = 0;
                                        str5 = (char *)*v24;
                                        str4 = (char *)*v23;
                                    }
                                    int32_t len4 = strlen(str4); // 0xc6e7
                                    int32_t len5 = strlen(str5); // 0xc6f2
                                    httpd_realloc_str((int64_t)&g112, (int64_t)&g114, (int64_t)len4 + 2 + (int64_t)len5);
                                    int64_t v27 = *v23; // 0xc720
                                    int64_t v28 = *v24; // 0xc727
                                    my_snprintf((int64_t *)g112, (int64_t *)g114, "%s/?%s", v27, (char *)v28, a6);
                                }
                                int32_t len6 = strlen(g112); // 0xcdc9
                                httpd_realloc_str((int64_t)&g113, (int64_t)&g115, (int64_t)len6 + 11);
                                my_snprintf((int64_t *)g113, (int64_t *)g115, "%s%s\r\n", (int64_t)"Location: ", g112, a6);
                                send_response(a1, 302, (int64_t)"Found", g113, (int64_t)"The actual URL is '%.80s'.\n", (int64_t)g112);
                                result = 0xffffffff;
                              lab_0xc5d6:
                                // 0xc5d6
                                return result;
                            }
                        }
                    }
                    // 0xc423
                    v13 = a1;
                    int64_t v29 = v21 + 1; // 0xc42c
                    v8 = 0;
                    while (true) {
                      lab_0xc440:
                        // 0xc440
                        v9 = v8;
                        str6 = (char *)*(int64_t *)(v9 + (int64_t)&g20);
                        v15 = v29 + (int64_t)strlen(str6);
                        httpd_realloc_str((int64_t)&g108, (int64_t)&g109, v15);
                        strcpy(g108, (char *)*str7);
                        str8 = g108;
                        v16 = (int64_t)str8;
                        int32_t len7 = strlen(str8); // 0xc487
                        if (len7 == 0) {
                            goto lab_0xc499;
                        } else {
                            // 0xc491
                            v11 = str8;
                            if (*(char *)(v16 - 1 + (int64_t)len7) == 47) {
                                goto lab_0xc4af;
                            } else {
                                goto lab_0xc499;
                            }
                        }
                    }
                  lab_0xc564:;
                    int64_t v30 = v13; // 0xc56b
                    int32_t v31 = *(int32_t *)(*(int64_t *)(v30 + 8) + 96); // 0xc573
                    uint32_t v32 = *(int32_t *)(v30 + 532); // 0xc576
                    char * v33; // bp-4296, 0xc260
                    int64_t v34 = expand_symlinks((int64_t)g108, (int64_t *)&v33, v31, v32); // 0xc585
                    v3 = (int64_t)"Internal Error";
                    v4 = 500;
                    v5 = v30;
                    v6 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n";
                    if (v34 == 0) {
                        goto lab_0xc5cc;
                    } else {
                        // 0xc594
                        v3 = (int64_t)"Internal Error";
                        v4 = 500;
                        v5 = v30;
                        v6 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n";
                        if (*v33 == 0) {
                            char * str9 = (char *)v34; // 0xc747
                            int64_t len8 = strlen(str9); // 0xc747
                            httpd_realloc_str(v1, v30 + 392, len8);
                            strcpy((char *)*(int64_t *)(v30 + 240), str9);
                            v12 = v32;
                            v7 = len8;
                            v10 = v30;
                            if ((*(char *)(v30 + 584) & 5) == 0) {
                                int64_t sa2 = v30 + 16; // 0xcfac
                                int16_t v35 = *(int16_t *)sa2; // 0xcfb0
                                int32_t salen2 = v35 != 2 ? v35 != 10 ? 0 : 28 : 16; // 0xcfcc
                                int32_t v36 = getnameinfo((struct sockaddr *)sa2, salen2, (char *)&g99, 200, NULL, 0, 1); // 0xcfe7
                                if (v36 == 0) {
                                    int32_t v37 = *(int32_t *)(v30 + 24); // 0xd122
                                    if (v37 == 0) {
                                        int32_t v38 = *(int32_t *)(v30 + 28); // 0xd129
                                        if (v38 == 0) {
                                            int32_t v39 = *(int32_t *)(v30 + 32); // 0xd130
                                            if (v39 == -0x10000) {
                                                int32_t v40 = *(int32_t *)&g99; // 0xd13f
                                                int32_t v41 = g100; // 0xd14a
                                                if (v40 == 0x66663a3a == v41 == 0x3a666666) {
                                                    int32_t len9 = strlen((char *)&g101); // 0xd15e
                                                    memmove((int64_t *)&g99, (int64_t *)&g101, len9 + 1);
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    // 0xcff8
                                    *(int16_t *)&g99 = 63;
                                }
                                int64_t v42 = *(int64_t *)(v30 + 208); // 0xd176
                                syslog(LOG_INFO, "%.80s URL \"%.80s\" resolves to a non-world-readable index file", (char *)&g99, (char *)v42);
                                v3 = (int64_t)"Forbidden";
                                v4 = 403;
                                v5 = v30;
                                v6 = (int64_t)"The requested URL '%.80s' resolves to an index file that is not world-readable.\n";
                                goto lab_0xc5cc;
                            } else {
                                goto lab_0xc77e;
                            }
                        } else {
                            goto lab_0xc5cc;
                        }
                    }
                } else {
                    goto lab_0xc5cc;
                }
            }
        }
    }
  lab_0xd321:;
    // 0xd321
    int64_t v43; // 0xc260
    char * v44; // 0xc260
    *(int64_t *)(v43 + 504) = (int64_t)v44;
    v13 = v43;
    *(char *)*(int64_t *)(v43 + 248) = 0;
    int64_t v45; // 0xc260
    uint64_t v46; // 0xc260
    int64_t v47; // 0xc260
    if (v46 != 0) {
        int64_t v48 = v13 + 248; // 0xd34a
        int64_t * v49 = (int64_t *)v48;
        int64_t v50 = v45;
        int64_t v51 = 0;
        int32_t v52 = *(int32_t *)((4 * v50 + 0x3fffffff8 & 0x3fffffffc) + v47); // 0xd39d
        int64_t v53 = 32 * (int64_t)v52; // 0xd3a5
        int64_t v54 = v51 + 1; // 0xd3a9
        int64_t v55 = *(int64_t *)((v53 | 24) + (int64_t)&g29); // 0xd3ae
        httpd_realloc_str(v48, v13 + 400, v55 + v54);
        int64_t v56 = *v49; // 0xd3c3
        int64_t v57 = v51; // 0xd3ca
        int64_t v58 = v56; // 0xd3ca
        if (*(char *)v56 != 0) {
            // 0xd368
            *(int16_t *)(v56 + v51) = 44;
            v58 = *v49;
            v57 = v54;
        }
        int64_t str10 = *(int64_t *)((v53 | 16) + (int64_t)&g29); // 0xd37e
        strcpy((char *)(v58 + v57), (char *)str10);
        int64_t v59 = *(int64_t *)(v53 + (int64_t)&g29 + 24); // 0xd388
        int64_t v60 = v50 - 1; // 0xd38c
        while (v50 != 2 && v60 != 0) {
            // 0xd399
            v50 = v60;
            v51 = v59 + v57;
            v52 = *(int32_t *)((4 * v50 + 0x3fffffff8 & 0x3fffffffc) + v47);
            v53 = 32 * (int64_t)v52;
            v54 = v51 + 1;
            v55 = *(int64_t *)((v53 | 24) + (int64_t)&g29);
            httpd_realloc_str(v48, v13 + 400, v55 + v54);
            v56 = *v49;
            v57 = v51;
            v58 = v56;
            if (*(char *)v56 != 0) {
                // 0xd368
                *(int16_t *)(v56 + v51) = 44;
                v58 = *v49;
                v57 = v54;
            }
            // 0xd373
            str10 = *(int64_t *)((v53 | 16) + (int64_t)&g29);
            strcpy((char *)(v58 + v57), (char *)str10);
            v59 = *(int64_t *)(v53 + (int64_t)&g29 + 24);
            v60 = v50 - 1;
        }
    }
    // 0xd3d1
    int64_t v61; // 0xc260
    int64_t v62; // 0xc260
    int64_t v63; // 0xc260
    int64_t v64; // 0xc260
    int64_t v65; // 0xc260
    int64_t v66; // 0xc260
    int64_t v67; // 0xc260
    int64_t v68; // 0xd3de
    if (*(int32_t *)(v13 + 180) == 2) {
        goto lab_0xd41d;
    } else {
        // 0xd3de
        v68 = *(int64_t *)(v13 + 480);
        if (v68 == -1) {
            goto lab_0xd3fb;
        } else {
            int64_t v69 = *(int64_t *)(v13 + 648); // 0xd3eb
            if (v68 < v69) {
                goto lab_0xd3fb;
            } else {
                // 0xd481
                v61 = -1;
                v67 = v69;
                v63 = *(int64_t *)(v13 + 248);
                v65 = (int64_t)"Not Modified";
                v66 = 304;
                v64 = v13;
                v62 = *(int64_t *)(v13 + 504);
                goto lab_0xd44d;
            }
        }
    }
  lab_0xd29d:;
    // 0xd29d
    int32_t v70; // 0xc260
    int32_t n = v70;
    uint64_t v71 = (int64_t)n;
    int64_t str14; // 0xc260
    int64_t str11 = str14; // 0xd2a6
    int64_t v72 = 192; // 0xd2a6
    int64_t v73 = 0; // 0xd2a6
    goto lab_0xd2b7;
  lab_0xcbba:;
    // 0xcbba
    int64_t v86; // 0xc260
    int64_t str13 = v86; // 0xcbc4
    int64_t v87 = str13; // 0xcbc2
    int32_t v88; // 0xc260
    int64_t v89; // 0xcb7d
    if (v89 != (int64_t)(-1 - g34)) {
        goto lab_0xcbdf;
    } else {
        int32_t v90 = strncasecmp((char *)str13, g33, g34); // 0xcbd2
        v87 = v13;
        v88 = 1;
        if (v90 == 0) {
            goto lab_0xcc13;
        } else {
            goto lab_0xcbdf;
        }
    }
  lab_0xcbdf:
    // 0xcbdf
    str14 = v87;
    int64_t v91; // 0xc260
    if (v89 != (int64_t)(-1 - g38)) {
        // 0xd290
        v70 = -(int32_t)v91;
        goto lab_0xd29d;
    }
    int32_t v92 = strncasecmp((char *)str14, g37, g38); // 0xcbf7
    v88 = 2;
    v70 = g38;
    if (v92 != 0) {
        goto lab_0xd29d;
    }
    goto lab_0xcc13;
  lab_0xcc13:;
    // 0xcc13
    int64_t v93; // 0xc260
    int64_t v94 = v89 + v93; // 0xcc13
    v93 = v94;
    if (v46 < 100) {
        // break -> 0xcc2a
        goto lab_0xcc2a;
    }
    goto lab_0xcb66;
  lab_0xc499:
    // 0xc499
    *(int16_t *)((int64_t)strlen(str8) + v16) = 47;
    v11 = g108;
    goto lab_0xc4af;
  lab_0xc4af:;
    char * str16 = v11;
    int32_t strcmp_rc = strcmp(str16, "./"); // 0xc4b5
    char * str17 = str16; // 0xc4bc
    if (strcmp_rc == 0) {
        // 0xc4be
        *str16 = 0;
        str17 = g108;
    }
    // 0xc4c9
    strcat(str17, str6);
    if (stat(g108, buf) >= 0) {
        // break -> 0xc564
        goto lab_0xc564;
    }
    // 0xc4e9
    v8 = v9 + 8;
    int64_t v96; // 0xc260
    int64_t v97; // 0xc4fa
    int64_t * v98; // 0xc5ea
    int64_t * v99; // 0xc5ee
    int64_t v100; // 0xc5ee
    if (v9 == 40) {
        // 0xc4fa
        v97 = v13;
        if ((*(char *)(v97 + 584) & 4) != 0) {
            // 0xc5ea
            v98 = (int64_t *)(v97 + 8);
            int64_t v101 = *v98; // 0xc5ea
            v99 = (int64_t *)(v97 + 240);
            v100 = *v99;
            if (*(int32_t *)(v101 + 104) == 0) {
                goto lab_0xc628;
            } else {
                // 0xc5fb
                if (*(int32_t *)(v101 + 100) == 0) {
                    // 0xc60d
                    v96 = (int64_t)".";
                    goto lab_0xc614;
                } else {
                    int64_t v102 = *(int64_t *)(v97 + 344); // 0xc601
                    v96 = v102;
                    if (*(char *)v102 != 0) {
                        goto lab_0xc614;
                    } else {
                        // 0xc60d
                        v96 = (int64_t)".";
                        goto lab_0xc614;
                    }
                }
            }
        } else {
            int64_t sa3 = v97 + 16; // 0xc50b
            int16_t v103 = *(int16_t *)sa3; // 0xc50f
            int32_t salen3 = v103 != 2 ? v103 != 10 ? 0 : 28 : 16; // 0xc52a
            int32_t v104 = getnameinfo((struct sockaddr *)sa3, salen3, (char *)&g99, 200, NULL, 0, 1); // 0xc545
            if (v104 == 0) {
                // 0xcce5
                if (*(int32_t *)(v97 + 24) != 0) {
                    goto lab_0xcd36;
                } else {
                    // 0xcceb
                    if (*(int32_t *)(v97 + 28) != 0) {
                        goto lab_0xcd36;
                    } else {
                        // 0xccf1
                        if (*(int32_t *)(v97 + 32) != -0x10000) {
                            goto lab_0xcd36;
                        } else {
                            // 0xccfa
                            if (*(int32_t *)&g99 == 0x66663a3a != (g100 == 0x3a666666)) {
                                goto lab_0xcd36;
                            } else {
                                int32_t len10 = strlen((char *)&g101); // 0xcd1e
                                memmove((int64_t *)&g99, (int64_t *)&g101, len10 + 1);
                                goto lab_0xcd36;
                            }
                        }
                    }
                }
            } else {
                // 0xc556
                *(int16_t *)&g99 = 63;
                goto lab_0xcd36;
            }
        }
    }
    goto lab_0xc440;
  lab_0xc5cc:;
    int64_t v105 = *(int64_t *)(v5 + 208);
    httpd_send_err(v5, v4, v3, (int64_t)&g10, v6, v105);
    // 0xc5d6
    return 0xffffffff;
  lab_0xc77e:
    // 0xc77e
    v43 = v10;
    uint64_t v106 = v7;
    int64_t v107 = v12;
    httpd_realloc_str((int64_t)&g110, (int64_t)&g111, v106);
    strcpy(g110, (char *)*str7);
    char * found_char_pos2 = strrchr(g110, 47); // 0xc7b2
    if (found_char_pos2 == NULL) {
        // 0xc7c1
        *(int16_t *)g110 = 46;
    } else {
        // 0xc7bc
        *found_char_pos2 = 0;
    }
    int64_t * v108 = (int64_t *)(v43 + 8); // 0xc7cd
    int64_t v109 = *v108; // 0xc7cd
    int64_t v110; // 0xc260
    if (*(int32_t *)(v109 + 104) == 0) {
        goto lab_0xc808;
    } else {
        // 0xc7d7
        if (*(int32_t *)(v109 + 100) == 0) {
            // 0xc7e9
            v110 = (int64_t)".";
            goto lab_0xc7f0;
        } else {
            int64_t v111 = *(int64_t *)(v43 + 344); // 0xc7dd
            v110 = v111;
            if (*(char *)v111 != 0) {
                goto lab_0xc7f0;
            } else {
                // 0xc7e9
                v110 = (int64_t)".";
                goto lab_0xc7f0;
            }
        }
    }
  lab_0xc808:;
    int64_t v112 = auth_check2(v43, (int64_t *)g110, v106, v107, a5, a6); // 0xc80e
    int64_t v113 = (int64_t)g110; // 0xc816
    if ((int32_t)v112 == -1) {
        // 0xc5d6
        return 0xffffffff;
    }
    goto lab_0xc81c;
  lab_0xc81c:;
    int64_t v114; // 0xc260
    if (v106 != 9) {
        // 0xc88f
        v114 = v113;
        if (v106 < 10) {
            goto lab_0xc8b4;
        } else {
            int64_t v115 = *str7 + v106;
            v114 = (int64_t)".htpasswd";
            if (strcmp((char *)(v115 - 9), ".htpasswd") != 0) {
                goto lab_0xc8b4;
            } else {
                // 0xc8ac
                v114 = (int64_t)".htpasswd";
                if (*(char *)(v115 - 10) == 47) {
                    goto lab_0xc835;
                } else {
                    goto lab_0xc8b4;
                }
            }
        }
    } else {
        // 0xc822
        v114 = (int64_t)".htpasswd";
        if (strcmp((char *)*str7, ".htpasswd") != 0) {
            goto lab_0xc8b4;
        } else {
            goto lab_0xc835;
        }
    }
  lab_0xc7f0:;
    int64_t v116 = auth_check2(v43, (int64_t *)v110, v106, v107, a5, a6); // 0xc7f3
    result = v116 & 0xffffffff;
    v113 = v110;
    switch ((int32_t)v116) {
        case -1: {
            goto lab_0xc5d6;
        }
        case 1: {
            goto lab_0xc81c;
        }
        default: {
            goto lab_0xc808;
        }
    }
  lab_0xc8b4:
    // 0xc8b4
    if ((int32_t)check_referrer(v43, v114, v106, v107, a5, a6) == 0) {
        // 0xc5d6
        return 0xffffffff;
    }
    int64_t v117 = *(int64_t *)(*v108 + 24); // 0xc8cd
    char * v118 = (char *)(v43 + 584);
    char * v119; // 0xc260
    int32_t priority; // 0xc260
    int64_t format; // 0xc260
    int64_t v120; // 0xd55e
    if (v117 == 0) {
        goto lab_0xc934;
    } else {
        // 0xc8d6
        if (*v118 % 2 == 0) {
            goto lab_0xc934;
        } else {
            // 0xc8e0
            if ((int32_t)match(v117, *str7) == 0) {
                goto lab_0xc934;
            } else {
                int64_t v121 = *v108; // 0xc8ec
                int32_t * v122 = (int32_t *)(v121 + 36); // 0xc8f3
                uint32_t v123 = *v122; // 0xc8f3
                if (*(int32_t *)(v121 + 32) - 1 < v123) {
                    int64_t v124 = *(int64_t *)&g27; // 0xc906
                    int64_t v125 = *(int64_t *)&g28; // 0xc90d
                    int64_t v126 = *(int64_t *)(v43 + 208); // 0xc914
                    httpd_send_err(v43, 503, v124, (int64_t)&g10, v125, v126);
                    // 0xc5d6
                    return 0xffffffff;
                }
                // 0xce3d
                *v122 = v123 + 1;
                int32_t fd = *(int32_t *)(v43 + 704); // 0xce43
                int32_t v127 = fcntl(fd, F_GETFL); // 0xce55
                int64_t v128 = 0; // 0xce5d
                if (v127 != -1) {
                    uint32_t v129 = v127 & -2049;
                    int64_t v130 = v129; // 0xce61
                    v128 = v130;
                    if (v129 != v127) {
                        // 0xce6b
                        fcntl(fd, F_SETFL);
                        v128 = v130;
                    }
                }
                int32_t v131 = fork(); // 0xce79
                if (v131 < 0) {
                    // 0xd02a
                    syslog(LOG_ERR, "fork - %m", v128);
                    int64_t v132 = *(int64_t *)(v43 + 208); // 0xd03d
                    httpd_send_err(v43, 500, (int64_t)"Internal Error", (int64_t)&g10, (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n", v132);
                    // 0xc5d6
                    return 0xffffffff;
                }
                if (v131 != 0) {
                    int64_t v133 = v131;
                    syslog(LOG_DEBUG, "spawned CGI process %d for file '%.200s'", v133, (char *)*str7);
                    format = (int64_t)"tmr_create(cgi_kill child) failed";
                    priority = 2;
                    if (tmr_create(0, 0xf7b0, v133, 0x7530, 0) == 0) {
                      lab_0xd668:
                        // 0xd668
                        syslog(priority, (char *)format);
                        exit(1);
                        // UNREACHABLE
                    }
                    // 0xcec9
                    *(int32_t *)(v43 + 184) = 200;
                    *(int64_t *)(v43 + 200) = 0x61a8;
                    *(int32_t *)(v43 + 556) = 0;
                    // 0xc5d6
                    return 0;
                }
                // 0xd4aa
                g95 = 1;
                v13 = v43;
                int64_t v134 = *v108; // 0xd4ba
                int32_t * v135 = (int32_t *)(v134 + 72); // 0xd4be
                int32_t fd2 = *v135; // 0xd4be
                if (fd2 != -1) {
                    // 0xd4c6
                    close(fd2);
                    *v135 = -1;
                }
                int32_t * v136 = (int32_t *)(v134 + 76); // 0xd4d2
                int32_t fd3 = *v136; // 0xd4d2
                if (fd3 != -1) {
                    // 0xd4da
                    close(fd3);
                    *v136 = -1;
                }
                int32_t * fd4 = (int32_t *)(v13 + 704); // 0xd4ea
                fcntl(*fd4, F_SETFD);
                closelog();
                uint32_t fd5 = *fd4; // 0xd503
                if (fd5 < 3) {
                    uint32_t v137 = dup2(fd5, 3); // 0xd513
                    if (v137 >= 0) {
                        // 0xd51c
                        *(int32_t *)(v13 + 704) = v137;
                    }
                }
                // 0xd526
                g138 = (char *)build_env("PATH=%s", "/usr/local/bin:/usr/ucb:/bin:/usr/bin");
                g139 = build_env("SERVER_SOFTWARE=%s", "thttpd/2.29 23May2018");
                v120 = *(int64_t *)(v13 + 8);
                if (*(int32_t *)(v120 + 100) == 0) {
                    goto lab_0xd57d;
                } else {
                    int64_t v138 = *(int64_t *)(v13 + 512); // 0xd56c
                    if (v138 == 0) {
                        goto lab_0xd57d;
                    } else {
                        char * v139 = (char *)v138;
                        v119 = v139;
                        if (*v139 != 0) {
                            goto lab_0xd5b6;
                        } else {
                            goto lab_0xd57d;
                        }
                    }
                }
            }
        }
    }
  lab_0xc835:;
    int64_t sa4 = v43 + 16; // 0xc835
    int16_t v140 = *(int16_t *)sa4; // 0xc839
    int32_t salen4 = v140 != 2 ? v140 != 10 ? 0 : 28 : 16; // 0xc855
    int32_t v141 = getnameinfo((struct sockaddr *)sa4, salen4, (char *)&g99, 200, NULL, 0, 1); // 0xc870
    if (v141 == 0) {
        // 0xca02
        if (*(int32_t *)(v43 + 24) == 0) {
            // 0xca09
            if (*(int32_t *)(v43 + 28) == 0) {
                // 0xca10
                if (*(int32_t *)(v43 + 32) == -0x10000) {
                    // 0xca1a
                    if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                        int32_t len11 = strlen((char *)&g101); // 0xca3e
                        memmove((int64_t *)&g99, (int64_t *)&g101, len11 + 1);
                    }
                }
            }
        }
    } else {
        // 0xc881
        *(int16_t *)&g99 = 63;
    }
    int64_t v142 = *(int64_t *)(v43 + 208); // 0xca56
    syslog(LOG_NOTICE, "%.80s URL \"%.80s\" tried to retrieve an auth file", (char *)&g99, (char *)v142);
    v3 = (int64_t)"Forbidden";
    v4 = 403;
    v5 = v43;
    v6 = (int64_t)"The requested URL '%.80s' is an authorization file, retrieving it is not permitted.\n";
    goto lab_0xc5cc;
  lab_0xc934:;
    // 0xc934
    int64_t v143; // 0xc260
    int64_t v144; // 0xc260
    int64_t v145; // 0xc260
    int64_t v146; // 0xc260
    int64_t * v147; // 0xc260
    if (*v118 % 2 != 0) {
        int64_t sa5 = v43 + 16; // 0xc9a8
        int16_t v148 = *(int16_t *)sa5; // 0xc9ac
        int32_t salen5 = v148 != 2 ? v148 != 10 ? 0 : 28 : 16; // 0xc9c8
        int32_t v149 = getnameinfo((struct sockaddr *)sa5, salen5, (char *)&g99, 200, NULL, 0, 1); // 0xc9e3
        if (v149 == 0) {
            // 0xcc4f
            if (*(int32_t *)(v43 + 24) == 0) {
                // 0xcc56
                if (*(int32_t *)(v43 + 28) == 0) {
                    // 0xcc5d
                    if (*(int32_t *)(v43 + 32) == -0x10000) {
                        // 0xcc67
                        if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                            int32_t len12 = strlen((char *)&g101); // 0xcc8b
                            memmove((int64_t *)&g99, (int64_t *)&g101, len12 + 1);
                        }
                    }
                }
            }
        } else {
            // 0xc9f4
            *(int16_t *)&g99 = 63;
        }
        int64_t * v150 = (int64_t *)(v43 + 208);
        int64_t v151 = *v150; // 0xcca3
        syslog(LOG_NOTICE, "%.80s URL \"%.80s\" is executable but isn't CGI", (char *)&g99, (char *)v151);
        v147 = v150;
        v145 = (int64_t)"The requested URL '%.80s' resolves to a file which is marked executable but is not a CGI file; retrieving it is forbidden.\n";
        goto lab_0xcf80;
    } else {
        // 0xc93e
        if (*(char *)*(int64_t *)(v43 + 256) == 0) {
            int32_t v152 = *(int32_t *)(v43 + 180); // 0xca98
            if (v152 >= 3) {
                uint32_t v153 = v152 - 3; // 0xcf92
                v143 = (int64_t)"UNKNOWN";
                v144 = v43;
                if (v153 < 4) {
                    int32_t v154 = *(int32_t *)((0x100000000 * (int64_t)v153 >> 30) + (int64_t)&g9); // 0xcfa3
                    v143 = (int64_t)v154 + (int64_t)&g9;
                    v144 = v43;
                }
                goto lab_0xd261;
            } else {
                // 0xcaab
                if (*(int32_t *)(v43 + 528) != 0) {
                    int64_t * v155 = (int64_t *)(v43 + 544); // 0xcab5
                    int64_t v156 = *v155; // 0xcab5
                    int64_t v157 = *(int64_t *)(v43 + 608); // 0xcabc
                    if (v156 != -1 != v156 < v157) {
                        // 0xcace
                        *v155 = v157 - 1;
                    }
                }
                // 0xcad9
                v146 = (int64_t)a2;
                uint64_t str18 = *str7; // 0xcad9
                v47 = v14 + 432;
                int64_t v158 = 0; // 0xcb61
                int64_t v159 = str18 + (int64_t)strlen((char *)str18); // 0xcb61
                int64_t v160 = 1; // 0xcb61
                while (true) {
                    // 0xcb66
                    v45 = v160;
                    v46 = v158;
                    v93 = v159;
                    while (true) {
                      lab_0xcb66:
                        // 0xcb66
                        v91 = 0;
                        int64_t str15 = v91 + v93; // 0xcb6c
                        uint64_t v95 = str15 - 1; // 0xcb70
                        v44 = "text/plain; charset=%s";
                        if (v95 < str18) {
                            // break (via goto) -> 0xd321
                            goto lab_0xd321;
                        }
                        // 0xcb7d
                        v89 = v91 - 1;
                        while (*(char *)v95 != 46) {
                            // 0xcb6c
                            v91 = v89;
                            str15 = v91 + v93;
                            v95 = str15 - 1;
                            v44 = "text/plain; charset=%s";
                            if (v95 < str18) {
                                // break (via goto) -> 0xd321
                                goto lab_0xd321;
                            }
                            // 0xcb7d
                            v89 = v91 - 1;
                        }
                        // 0xcb86
                        v13 = str15;
                        v86 = str15;
                        if (v89 != (int64_t)(-1 - g30)) {
                            goto lab_0xcbba;
                        } else {
                            // 0xcb9f
                            v86 = v13;
                            v88 = 0;
                            if (strncasecmp((char *)str15, (char *)g29, g30) == 0) {
                                goto lab_0xcc13;
                            } else {
                                goto lab_0xcbba;
                            }
                        }
                    }
                  lab_0xcc2a:
                    // 0xcc2a
                    *(int32_t *)(4 * v46 + v47) = v88;
                    v158 = v46 + 1 & 0xffffffff;
                    v159 = v94;
                    v160 = v45 + 1;
                }
                goto lab_0xd321;
            }
        } else {
            int64_t sa6 = v43 + 16; // 0xc94e
            int16_t v161 = *(int16_t *)sa6; // 0xc952
            int32_t salen6 = v161 != 2 ? v161 != 10 ? 0 : 28 : 16; // 0xc96e
            int32_t v162 = getnameinfo((struct sockaddr *)sa6, salen6, (char *)&g99, 200, NULL, 0, 1); // 0xc989
            if (v162 == 0) {
                // 0xceef
                if (*(int32_t *)(v43 + 24) == 0) {
                    // 0xcef6
                    if (*(int32_t *)(v43 + 28) == 0) {
                        // 0xcefd
                        if (*(int32_t *)(v43 + 32) == -0x10000) {
                            // 0xcf07
                            if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                                int32_t len13 = strlen((char *)&g101); // 0xcf2b
                                memmove((int64_t *)&g99, (int64_t *)&g101, len13 + 1);
                            }
                        }
                    }
                }
            } else {
                // 0xc99a
                *(int16_t *)&g99 = 63;
            }
            // 0xcf43
            v147 = (int64_t *)(v43 + 208);
            int64_t v163 = *v147; // 0xcf43
            syslog(LOG_INFO, "%.80s URL \"%.80s\" has pathinfo but isn't CGI", (char *)&g99, (char *)v163);
            v145 = (int64_t)"The requested URL '%.80s' resolves to a file plus CGI-style pathinfo, but the file is not a valid CGI file.\n";
            goto lab_0xcf80;
        }
    }
  lab_0xcf80:;
    int64_t v164 = *v147;
    httpd_send_err(v43, 403, (int64_t)"Forbidden", (int64_t)&g10, v145, v164);
    // 0xc5d6
    return 0xffffffff;
  lab_0xd57d:;
    int64_t v165 = *(int64_t *)(v13 + 336); // 0xd581
    if (v165 == 0) {
        goto lab_0xd592;
    } else {
        char * v166 = (char *)v165;
        v119 = v166;
        if (*v166 != 0) {
            goto lab_0xd5b6;
        } else {
            goto lab_0xd592;
        }
    }
  lab_0xd261:
    // 0xd261
    httpd_send_err(v144, 501, (int64_t)"Not Implemented", (int64_t)&g10, (int64_t)"The requested method '%.80s' is not implemented by this server.\n", v143);
    // 0xc5d6
    return 0xffffffff;
  lab_0xd592:;
    int64_t v167 = *(int64_t *)(v13 + 328); // 0xd596
    if (v167 == 0) {
        goto lab_0xd5a7;
    } else {
        char * v168 = (char *)v167;
        v119 = v168;
        if (*v168 != 0) {
            goto lab_0xd5b6;
        } else {
            goto lab_0xd5a7;
        }
    }
  lab_0xd41d:
    // 0xd41d
    v61 = 0x100000000 * *(int64_t *)(v13 + 608) >> 32;
    v67 = *(int64_t *)(v13 + 648);
    v63 = *(int64_t *)(v13 + 248);
    v65 = (int64_t)"OK";
    v66 = 200;
    v64 = v13;
    v62 = *(int64_t *)(v13 + 504);
    goto lab_0xd44d;
  lab_0xd5a7:;
    int64_t v406 = *(int64_t *)(v120 + 8); // 0xd5a7
    if (v406 == 0) {
        goto lab_0xd5cf;
    } else {
        // 0xd5a7
        v119 = (char *)v406;
        goto lab_0xd5b6;
    }
  lab_0xd5b6:
    // 0xd5b6
    g140 = build_env("SERVER_NAME=%s", v119);
    goto lab_0xd5cf;
  lab_0xd44d:
    // 0xd44d
    send_mime(v64, v66, v65, (int64_t *)v63, (int64_t)&g10, (char *)v62, v61, v67);
    // 0xc5d6
    return 0;
  lab_0xd3fb:;
    int64_t v169 = mmc_map(*(int64_t *)(v13 + 240), v2, v146, v68, a5, a6); // 0xd40c
    *(int64_t *)(v13 + 712) = v169;
    v3 = (int64_t)"Internal Error";
    v4 = 500;
    v5 = v13;
    v6 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n";
    if (v169 == 0) {
        goto lab_0xc5cc;
    } else {
        goto lab_0xd41d;
    }
  lab_0xd5cf:;
    int64_t v170 = 3;
    int64_t v171 = 8 * v170; // 0xd5e0
    *(int64_t *)(v171 + (int64_t)&g138) = (int64_t)"GATEWAY_INTERFACE=CGI/1.1";
    int64_t v172 = build_env("SERVER_PROTOCOL=%s", (char *)*(int64_t *)(v13 + 224)); // 0xd5f6
    *(int64_t *)(v171 + (int64_t)&g138 + 8) = v172;
    uint16_t v173 = *(int16_t *)(*(int64_t *)(v13 + 8) + 16); // 0xd604
    int32_t fd6; // bp-4152, 0xc260
    my_snprintf((int64_t *)&fd6, (int64_t *)256, "%d", (int64_t)v173, (char *)a5, a6);
    int64_t v174 = build_env("SERVER_PORT=%s", (char *)&fd6); // 0xd630
    *(int64_t *)(v171 + (int64_t)&g138 + 16) = v174;
    uint32_t v175 = *(int32_t *)(v13 + 180) - 1; // 0xd645
    int64_t v176 = (int64_t)"UNKNOWN"; // 0xd64b
    if (v175 < 6) {
        int64_t v177 = *(int64_t *)((0x100000000 * (int64_t)v175 >> 29) + (int64_t)&g21); // 0xd656
        v176 = v177;
    }
    int64_t v178 = build_env("REQUEST_METHOD=%s", (char *)v176); // 0xd687
    int64_t v179 = v170 | 4; // 0xd68c
    *(int64_t *)(v171 + (int64_t)&g138 + 24) = v178;
    char * v180 = (char *)*(int64_t *)(v13 + 256); // 0xd6aa
    int64_t v181 = v179; // 0xd6ad
    if (*v180 != 0) {
        int64_t v182 = build_env("PATH_INFO=/%s", v180); // 0xd6ba
        uint64_t v183 = 0x100000000 * v170 + 0x500000000;
        *(int64_t *)(8 * v179 + (int64_t)&g138) = v182;
        int64_t str19 = *(int64_t *)(*(int64_t *)(v13 + 8) + 64); // 0xd6dd
        int32_t len14 = strlen((char *)str19); // 0xd6e4
        char * str20 = (char *)*(int64_t *)(v13 + 256); // 0xd6f6
        int64_t size = (int64_t)len14 + 1 + (int64_t)strlen(str20); // 0xd6ff
        int64_t * mem = malloc((int32_t)size); // 0xd706
        if (mem != NULL) {
            // 0xd718
            my_snprintf(mem, (int64_t *)size, "%s%s", str19, str20, a6);
            int64_t v184 = build_env("PATH_TRANSLATED=%s", (char *)mem); // 0xd73f
            *(int64_t *)(v183 / 0x20000000 + (int64_t)&g138) = v184;
            v181 = v170 + 6;
        } else {
            // 0xd710
            v181 = v183 / 0x100000000;
        }
    }
    char * str21 = (char *)*(int64_t *)(v13 + 232); // 0xd76f
    char * v185 = strcmp(str21, ".") != 0 ? str21 : (char *)&g10; // 0xd788
    int64_t v186 = build_env("SCRIPT_NAME=/%s", v185); // 0xd788
    int64_t v187 = v181 + 1 & 0xffffffff; // 0xd78d
    *(int64_t *)((8 * v181 & 0x7fffffff8) + (int64_t)&g138) = v186;
    char * v188 = (char *)*(int64_t *)(v13 + 264); // 0xd7a4
    int64_t v189 = v187; // 0xd7a7
    if (*v188 != 0) {
        int64_t v190 = build_env("QUERY_STRING=%s", v188); // 0xd7b0
        *(int64_t *)(8 * v187 + (int64_t)&g138) = v190;
        v189 = v181 + 2 & 0xffffffff;
    }
    int64_t sa7 = v13 + 16; // 0xd7cb
    int16_t v191 = *(int16_t *)sa7; // 0xd7cf
    int32_t salen7 = v191 != 2 ? v191 != 10 ? 0 : 28 : 16; // 0xd7ea
    int32_t v192 = getnameinfo((struct sockaddr *)sa7, salen7, (char *)&g99, 200, NULL, 0, 1); // 0xd805
    if (v192 != 0) {
        // 0xd871
        *(int16_t *)&g99 = 63;
    } else {
        // 0xd812
        if (*(int32_t *)(v13 + 24) == 0) {
            // 0xd81c
            if (*(int32_t *)(v13 + 28) == 0) {
                // 0xd826
                if (*(int32_t *)(v13 + 32) == -0x10000) {
                    // 0xd833
                    if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                        int32_t len15 = strlen((char *)&g101); // 0xd857
                        memmove((int64_t *)&g99, (int64_t *)&g101, len15 + 1);
                    }
                }
            }
        }
    }
    int64_t v193 = build_env("REMOTE_ADDR=%s", (char *)&g99); // 0xd888
    int64_t v194 = v189 + 1; // 0xd88d
    int64_t v195 = 8 * v189; // 0xd890
    *(int64_t *)(v195 + (int64_t)&g138) = v193;
    char * v196 = (char *)*(int64_t *)(v13 + 272); // 0xd8a8
    int64_t v197 = v13; // 0xd8ab
    int64_t v198 = v194; // 0xd8ab
    if (*v196 != 0) {
        int64_t v199 = build_env("HTTP_REFERER=%s", v196); // 0xd8b4
        *(int64_t *)((8 * v194 & 0x7fffffff8) + (int64_t)&g138) = v199;
        int64_t v200 = build_env("HTTP_REFERRER=%s", (char *)*(int64_t *)(v13 + 272)); // 0xd8dd
        *(int64_t *)((v195 + 16 & 0x7fffffff8) + (int64_t)&g138) = v200;
        v197 = v13;
        v198 = v189 + 3;
    }
    int64_t v201 = v198 & 0xffffffff;
    char * v202 = (char *)*(int64_t *)(v197 + 280); // 0xd8f7
    int64_t v203 = v197; // 0xd8fa
    int64_t v204 = v201; // 0xd8fa
    if (*v202 != 0) {
        int64_t v205 = build_env("HTTP_USER_AGENT=%s", v202); // 0xd903
        *(int64_t *)(8 * v201 + (int64_t)&g138) = v205;
        v203 = v13;
        v204 = v198 + 1 & 0xffffffff;
    }
    char * v206 = (char *)*(int64_t *)(v203 + 288); // 0xd923
    int64_t v207 = v203; // 0xd926
    int64_t v208 = v204; // 0xd926
    if (*v206 != 0) {
        int64_t v209 = build_env("HTTP_ACCEPT=%s", v206); // 0xd92f
        *(int64_t *)(8 * v204 + (int64_t)&g138) = v209;
        v207 = v13;
        v208 = v204 + 1 & 0xffffffff;
    }
    char * v210 = (char *)*(int64_t *)(v207 + 296); // 0xd94f
    int64_t v211 = v207; // 0xd952
    int64_t v212 = v208; // 0xd952
    if (*v210 != 0) {
        int64_t v213 = build_env("HTTP_ACCEPT_ENCODING=%s", v210); // 0xd95b
        *(int64_t *)((8 * v208 & 0x7fffffff8) + (int64_t)&g138) = v213;
        v211 = v13;
        v212 = v208 + 1 & 0xffffffff;
    }
    char * v214 = (char *)*(int64_t *)(v211 + 304); // 0xd97b
    int64_t v215 = v211; // 0xd97e
    int64_t v216 = v212; // 0xd97e
    if (*v214 != 0) {
        int64_t v217 = build_env("HTTP_ACCEPT_LANGUAGE=%s", v214); // 0xd987
        *(int64_t *)((8 * v212 & 0x7fffffff8) + (int64_t)&g138) = v217;
        v215 = v13;
        v216 = v212 + 1 & 0xffffffff;
    }
    char * v218 = (char *)*(int64_t *)(v215 + 312); // 0xd9a7
    int64_t v219 = v215; // 0xd9aa
    int64_t v220 = v216; // 0xd9aa
    if (*v218 != 0) {
        int64_t v221 = build_env("HTTP_COOKIE=%s", v218); // 0xd9b3
        *(int64_t *)((8 * v216 & 0x7fffffff8) + (int64_t)&g138) = v221;
        v219 = v13;
        v220 = v216 + 1 & 0xffffffff;
    }
    char * v222 = (char *)*(int64_t *)(v219 + 320); // 0xd9d3
    int64_t v223 = v219; // 0xd9d6
    int64_t v224 = v220; // 0xd9d6
    if (*v222 != 0) {
        int64_t v225 = build_env("CONTENT_TYPE=%s", v222); // 0xd9df
        *(int64_t *)((8 * v220 & 0x7fffffff8) + (int64_t)&g138) = v225;
        v223 = v13;
        v224 = v220 + 1 & 0xffffffff;
    }
    char * v226 = (char *)*(int64_t *)(v223 + 336); // 0xd9ff
    int64_t v227 = v223; // 0xda02
    int64_t v228 = v224; // 0xda02
    if (*v226 != 0) {
        int64_t v229 = build_env("HTTP_HOST=%s", v226); // 0xda0b
        *(int64_t *)((8 * v224 & 0x7fffffff8) + (int64_t)&g138) = v229;
        v227 = v13;
        v228 = v224 + 1 & 0xffffffff;
    }
    int64_t v230 = *(int64_t *)(v227 + 496); // 0xda24
    int64_t v231 = v227; // 0xda2f
    int64_t v232 = v228; // 0xda2f
    if (v230 != -1) {
        // 0xda31
        my_snprintf((int64_t *)&fd6, (int64_t *)256, "%lu", v230, NULL, 0);
        int64_t v233 = build_env("CONTENT_LENGTH=%s", (char *)&fd6); // 0xda59
        *(int64_t *)((8 * v228 & 0x7fffffff8) + (int64_t)&g138) = v233;
        v231 = v13;
        v232 = v228 + 1 & 0xffffffff;
    }
    char * v234 = (char *)*(int64_t *)(v231 + 360); // 0xda79
    int64_t v235 = v231; // 0xda7c
    int64_t v236 = v232; // 0xda7c
    if (*v234 != 0) {
        int64_t v237 = build_env("REMOTE_USER=%s", v234); // 0xda85
        *(int64_t *)((8 * v232 & 0x7fffffff8) + (int64_t)&g138) = v237;
        v235 = v13;
        v236 = v232 + 1 & 0xffffffff;
    }
    int64_t v238 = v236; // 0xdaa8
    if (*(char *)*(int64_t *)(v235 + 352) != 0) {
        int64_t v239 = build_env("AUTH_TYPE=%s", "Basic"); // 0xdab8
        *(int64_t *)((8 * v236 & 0x7fffffff8) + (int64_t)&g138) = v239;
        v238 = v236 + 1 & 0xffffffff;
    }
    char * env_val = getenv("TZ"); // 0xdad4
    int64_t v240 = v238; // 0xdadc
    if (env_val != NULL) {
        int64_t v241 = build_env("TZ=%s", env_val); // 0xdae8
        *(int64_t *)((8 * v238 & 0x7fffffff8) + (int64_t)&g138) = v241;
        v240 = v238 + 1 & 0xffffffff;
    }
    int64_t v242 = *(int64_t *)(*(int64_t *)(v13 + 8) + 24); // 0xdb05
    int64_t v243 = build_env("CGI_PATTERN=%s", (char *)v242); // 0xdb10
    int64_t v244 = 8 * v240; // 0xdb15
    *(int64_t *)((v244 & 0x7fffffff8) + (int64_t)&g138) = v243;
    *(int64_t *)((v244 + 8 & 0x7fffffff8) + (int64_t)&g138) = 0;
    int64_t v245 = *(int64_t *)(v13 + 264); // 0xdb2d
    char * str22 = (char *)v245; // 0xdb37
    int64_t * mem2 = malloc(8 * strlen(str22) + 16); // 0xdb44
    int64_t v246; // 0xc260
    int64_t v247; // 0xc260
    struct stat * str24; // 0xc260
    if (mem2 != NULL) {
        int64_t str23 = *str7; // 0xdb67
        char * found_char_pos3 = strrchr((char *)str23, 47); // 0xdb72
        *mem2 = found_char_pos3 == NULL ? str23 : (int64_t)found_char_pos3 + 1;
        char * found_char_pos4 = strchr(str22, 61); // 0xdb92
        int64_t v248 = (int64_t)mem2;
        int64_t v249 = (int64_t)&g138; // 0xdba0
        int64_t v250 = 1; // 0xdba0
        int64_t v251 = v245; // 0xdba0
        int64_t v252 = v245; // 0xdba0
        int64_t v253 = (int64_t)&g138; // 0xdba0
        int64_t v254 = 1; // 0xdba0
        if (found_char_pos4 == NULL) {
            int64_t v255; // 0xc260
            int64_t v256; // 0xc260
            int64_t v257; // 0xc260
            int64_t v258; // 0xc260
            while (true) {
                // 0xdbcf
                v258 = v252;
                v256 = v251;
                v255 = v250;
                char * v259 = (char *)v258; // 0xdbcf
                char v260 = *v259; // 0xdbcf
                int64_t v261; // 0xc260
                int64_t v262; // 0xc260
                int64_t v263; // 0xc260
                int64_t v264; // 0xc260
                if (v260 == 43) {
                    // 0xdbdf
                    *v259 = 0;
                    int64_t v265 = v256; // 0xdbe9
                    int64_t v266 = v256; // 0xdbe9
                    int64_t v267; // 0xc260
                    while (true) {
                        int64_t v268 = v266;
                        v267 = v265;
                        unsigned char v269 = *(char *)v268; // 0xdbf9
                        int64_t v270; // 0xc260
                        int64_t v271; // 0xc260
                        if (v269 != 37) {
                            // 0xdbeb
                            v271 = v269;
                            v270 = v268;
                            if (v269 == 0) {
                                // break -> 0xdbb4
                                break;
                            }
                        } else {
                            int16_t * v272 = *__ctype_b_loc(); // 0xdc08
                            char v273 = *(char *)(v268 + 1); // 0xdc0b
                            int64_t v274 = v273; // 0xdc0b
                            int64_t v275 = (int64_t)v272 + 1; // 0xdc12
                            v271 = 37;
                            v270 = v268;
                            if ((*(char *)(2 * v274 + v275) & 16) != 0) {
                                int64_t v276 = v268 + 2; // 0xdc19
                                char v277 = *(char *)v276; // 0xdc19
                                int64_t v278 = v277; // 0xdc19
                                v271 = 37;
                                v270 = v268;
                                if ((*(char *)(2 * v278 + v275) & 16) != 0) {
                                    int64_t v279 = v274 + 0xffffffd0; // 0xdc25
                                    int64_t v280 = v279 & 0xffffffff; // 0xdc2b
                                    if ((char)v279 >= 10) {
                                        if (v273 < 103) {
                                            // 0xdc35
                                            v280 = (v274 + 169) % 256;
                                        } else {
                                            // 0xdc3d
                                            v280 = v273 >= 71 ? 0 : (v274 + 201) % 256;
                                        }
                                    }
                                    int64_t v281 = v278 + 0xffffffd0; // 0xdc52
                                    int64_t v282 = v281 & 0xffffffff; // 0xdc58
                                    if ((char)v281 >= 10) {
                                        if (v277 < 103) {
                                            // 0xdc62
                                            v282 = (v278 + 169) % 256;
                                        } else {
                                            // 0xdc68
                                            v282 = v277 >= 71 ? 0 : (v278 + 201) % 256;
                                        }
                                    }
                                    // 0xdc77
                                    v271 = (v282 + 16 * v280) % 256;
                                    v270 = v276;
                                }
                            }
                        }
                        // 0xdbef
                        *(char *)v267 = (char)v271;
                        v265 = v267 + 1;
                        v266 = v270 + 1;
                    }
                    // 0xdbb4
                    *(char *)v267 = 0;
                    *(int64_t *)((0x100000000 * v255 >> 29) + v248) = v256;
                    int64_t v283 = v258 + 1;
                    v261 = v283;
                    v264 = 0;
                    v262 = v255 + 1 & 0xffffffff;
                    v263 = v283;
                } else {
                    // 0xdbd6
                    v257 = v249;
                    if (v260 == 0) {
                        // break -> 0xdc82
                        break;
                    }
                    // 0xdbd6
                    v261 = v258 + 1;
                    v264 = v257;
                    v262 = v255;
                    v263 = v256;
                }
                // 0xdbcb
                v249 = v264;
                v250 = v262;
                v251 = v263;
                v252 = v261;
            }
            int64_t v284 = v256; // 0xdc85
            int64_t v285 = v256; // 0xdc85
            v253 = v257;
            v254 = v255;
            if (v258 != v256) {
                int64_t v286; // 0xc260
                while (true) {
                    int64_t v287 = v285;
                    v286 = v284;
                    unsigned char v288 = *(char *)v287; // 0xdca8
                    int64_t v289; // 0xc260
                    int64_t v290; // 0xc260
                    if (v288 != 37) {
                        // 0xdc96
                        v290 = v288;
                        v289 = v287;
                        if (v288 == 0) {
                            // break -> 0xdd30
                            break;
                        }
                    } else {
                        int16_t * v291 = *__ctype_b_loc(); // 0xdcb6
                        char v292 = *(char *)(v287 + 1); // 0xdcb9
                        int64_t v293 = v292; // 0xdcb9
                        int64_t v294 = (int64_t)v291 + 1; // 0xdcc0
                        v290 = 37;
                        v289 = v287;
                        if ((*(char *)(2 * v293 + v294) & 16) != 0) {
                            int64_t v295 = v287 + 2; // 0xdcc7
                            char v296 = *(char *)v295; // 0xdcc7
                            int64_t v297 = v296; // 0xdcc7
                            v290 = 37;
                            v289 = v287;
                            if ((*(char *)(2 * v297 + v294) & 16) != 0) {
                                int64_t v298 = v293 + 0xffffffd0; // 0xdcd3
                                int64_t v299 = v298 & 0xffffffff; // 0xdcd9
                                if ((char)v298 >= 10) {
                                    if (v292 < 103) {
                                        // 0xdce3
                                        v299 = (v293 + 169) % 256;
                                    } else {
                                        // 0xdceb
                                        v299 = v292 >= 71 ? 0 : (v293 + 201) % 256;
                                    }
                                }
                                int64_t v300 = v297 + 0xffffffd0; // 0xdd00
                                int64_t v301 = v300 & 0xffffffff; // 0xdd06
                                if ((char)v300 >= 10) {
                                    if (v296 < 103) {
                                        // 0xdd10
                                        v301 = (v297 + 169) % 256;
                                    } else {
                                        // 0xdd16
                                        v301 = v296 >= 71 ? 0 : (v297 + 201) % 256;
                                    }
                                }
                                // 0xdd25
                                v290 = (v301 + 16 * v299) % 256;
                                v289 = v295;
                            }
                        }
                    }
                    // 0xdc9e
                    *(char *)v286 = (char)v290;
                    v284 = v286 + 1;
                    v285 = v289 + 1;
                }
                // 0xdd30
                *(char *)v286 = 0;
                *(int64_t *)((0x100000000 * v255 >> 29) + v248) = v256;
                v253 = 0;
                v254 = v255 + 1 & 0xffffffff;
            }
        }
        // 0xdd43
        *(int64_t *)((0x100000000 * v254 >> 29) + v248) = 0;
        str24 = (struct stat *)mem2;
        v246 = v248;
        v247 = v253;
    } else {
        // 0xdb56
        str24 = NULL;
        v246 = (int64_t)mem2;
        v247 = (int64_t)&g138;
    }
    int64_t v302 = v13; // 0xdd53
    int64_t v303 = v246; // 0xdd5e
    int64_t v304; // 0xc260
    int64_t v305; // 0xc260
    int64_t format2; // 0xc260
    int32_t fd7; // 0xc260
    if (*(int32_t *)(v302 + 180) != 3) {
        goto lab_0xddc6;
    } else {
        // 0xdd60
        v303 = v302;
        if (*(int64_t *)(v302 + 160) > *(int64_t *)(v302 + 168)) {
            // 0xdd74
            fds[0] = &fd6;
            v305 = v247;
            format2 = (int64_t)"pipe - %m";
            if (pipe(fds) < 0) {
                goto lab_0xe038;
            } else {
                int32_t v306 = fork(); // 0xdd89
                v305 = v247;
                format2 = (int64_t)"fork - %m";
                if (v306 < 0) {
                    goto lab_0xe038;
                } else {
                    if (v306 == 0) {
                        // 0xdd9c
                        g95 = 1;
                        close(fd6);
                        cgi_interpose_input(v13, fd7);
                        exit(0);
                        // UNREACHABLE
                    }
                    // 0xe143
                    close(fd7);
                    v304 = v302;
                    if (fd6 != 0) {
                        // 0xe15e
                        dup2(fd6, 0);
                        close(fd6);
                        v304 = v302;
                    }
                    goto lab_0xdddb;
                }
            }
        } else {
            goto lab_0xddc6;
        }
    }
  lab_0xddc6:;
    int32_t fd8 = *(int32_t *)(v302 + 704); // 0xddca
    v304 = v303;
    if (fd8 != 0) {
        // 0xddd4
        dup2(fd8, 0);
        v304 = v303;
    }
    goto lab_0xdddb;
  lab_0xdddb:
    // 0xdddb
    if (strncmp((char *)*(int64_t *)str24, "nph-", 4) == 0) {
        goto lab_0xde09;
    } else {
        // 0xddf8
        if (*(int32_t *)(v13 + 520) != 0) {
            // 0xdf03
            fds2[0] = &fd6;
            v305 = 4;
            format2 = (int64_t)"pipe - %m";
            if (pipe(fds2) >= 0) {
                int32_t v307 = fork(); // 0xe024
                v305 = 4;
                format2 = (int64_t)"fork - %m";
                if (v307 >= 0) {
                    if (v307 == 0) {
                        // 0xe119
                        g95 = 1;
                        close(fd7);
                        cgi_interpose_output(v13, (int64_t)fd6, 4);
                        exit(0);
                        // UNREACHABLE
                    }
                    // 0xe32c
                    close(fd6);
                    if (fd7 == 1) {
                        // 0xe365
                        dup2(1, 2);
                    } else {
                        // 0xe349
                        dup2(fd7, 1);
                        if (fd7 != 2) {
                            // 0xe382
                            dup2(fd7, 2);
                            close(fd7);
                        }
                    }
                    goto lab_0xde42;
                } else {
                    goto lab_0xe038;
                }
            } else {
                goto lab_0xe038;
            }
        } else {
            goto lab_0xde09;
        }
    }
  lab_0xde09:;
    int32_t fd9 = *(int32_t *)(v13 + 704); // 0xde0d
    if (fd9 == 1) {
        // 0xde38
        dup2(1, 2);
        goto lab_0xde42;
    } else {
        // 0xde1d
        dup2(fd9, 1);
        int32_t fd10 = *(int32_t *)(v13 + 704); // 0xde2d
        if (fd10 == 2) {
            goto lab_0xde42;
        } else {
            // 0xde38
            dup2(fd10, 2);
            goto lab_0xde42;
        }
    }
  lab_0xe038:
    // 0xe038
    syslog(LOG_ERR, (char *)format2, v305);
    int64_t v308 = *(int64_t *)(v13 + 208); // 0xe048
    httpd_send_err(v13, 500, (int64_t)"Internal Error", (int64_t)&g10, (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n", v308);
    httpd_write_response(v13, 500, (int64_t)"Internal Error");
    exit(1);
    // UNREACHABLE
  lab_0xde42:
    // 0xde42
    nice(10);
    char * str25 = (char *)*str7;
    char * str26 = strdup(str25); // 0xde57
    char * path = str25; // 0xde5f
    if (str26 != NULL) {
        char * found_char_pos5 = strrchr(str26, 47); // 0xde6c
        path = str25;
        if (found_char_pos5 != NULL) {
            // 0xde76
            *found_char_pos5 = 0;
            chdir(str26);
            path = (char *)((int64_t)found_char_pos5 + 1);
        }
    }
    // 0xde88
    sigset(13, NULL);
    exec_argv[0] = (char *)str24;
    execve(path, exec_argv, {(char *)&g138});
    int64_t v309 = *(int64_t *)(v13 + 240); // 0xdeae
    syslog(LOG_ERR, "execve %.80s - %m", (char *)v309, v304);
    int64_t v310 = *(int64_t *)(v13 + 208); // 0xdec8
    httpd_send_err(v13, 500, (int64_t)"Internal Error", (int64_t)&g10, (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n", v310);
    httpd_write_response(v13, 500, (int64_t)"Internal Error");
    _exit(1);
    // UNREACHABLE
  lab_0xc628:;
    int64_t v311 = auth_check2(v97, (int64_t *)v100, v15, a4, a5, a6); // 0xc62e
    result = 0xffffffff;
    int64_t v312 = v100; // 0xc636
    if ((int32_t)v311 == -1) {
        goto lab_0xc5d6;
    } else {
        goto lab_0xc638;
    }
  lab_0xc638:
    // 0xc638
    result = 0xffffffff;
    struct __dirstream * dirp; // 0xc64c
    int64_t v313; // 0xdf2b
    if ((int32_t)check_referrer(v97, v312, v15, a4, a5, a6) == 0) {
        goto lab_0xc5d6;
    } else {
        // 0xc649
        dirp = opendir((char *)*str7);
        if (dirp == NULL) {
            // 0xd06b
            syslog(LOG_ERR, "opendir %.80s - %m", (char *)*v99, a4);
            v3 = (int64_t)"Not Found";
            v4 = 404;
            v5 = v97;
            v6 = (int64_t)"The requested URL '%.80s' was not found on this server.\n";
            goto lab_0xc5cc;
        } else {
            int32_t * v314 = (int32_t *)(v97 + 180); // 0xc65d
            int32_t v315 = *v314; // 0xc65d
            if (v315 == 1) {
                int64_t v316 = *v98; // 0xd0ae
                uint32_t v317 = *(int32_t *)(v316 + 32); // 0xd0b2
                int32_t * v318 = (int32_t *)(v316 + 36); // 0xd0b5
                uint32_t v319 = *v318; // 0xd0b5
                if (v317 - 1 < v319) {
                    // 0xd0c8
                    closedir(dirp);
                    v3 = *(int64_t *)&g27;
                    v4 = 503;
                    v5 = v97;
                    v6 = *(int64_t *)&g28;
                    goto lab_0xc5cc;
                } else {
                    // 0xd1b8
                    *v318 = v319 + 1;
                    int32_t v320 = fork(); // 0xd1be
                    if (v320 < 0) {
                        // 0xd270
                        syslog(LOG_ERR, "fork - %m", (int64_t)v317);
                        closedir(dirp);
                        v3 = (int64_t)"Internal Error";
                        v4 = 500;
                        v5 = v97;
                        v6 = (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n";
                        goto lab_0xc5cc;
                    } else {
                        if (v320 == 0) {
                            // 0xdf24
                            g95 = 1;
                            v313 = *v98;
                            int32_t * v321 = (int32_t *)(v313 + 72); // 0xdf2f
                            int32_t fd11 = *v321; // 0xdf2f
                            if (fd11 == -1) {
                                goto lab_0xdf43;
                            } else {
                                // 0xdf37
                                close(fd11);
                                *v321 = -1;
                                goto lab_0xdf43;
                            }
                        } else {
                            int64_t v322 = v320;
                            closedir(dirp);
                            syslog(LOG_DEBUG, "spawned indexing process %d for directory '%.200s'", v322, (char *)*str7);
                            format = (int64_t)"tmr_create(cgi_kill ls) failed";
                            priority = 2;
                            if (tmr_create(0, 0xf7b0, v322, 0x7530, 0) == 0) {
                                goto lab_0xd668;
                            } else {
                                // 0xd219
                                *(int32_t *)(v97 + 184) = 200;
                                *(int64_t *)(v97 + 200) = 0x61a8;
                                *(int32_t *)(v97 + 556) = 0;
                                result = 0;
                                goto lab_0xc5d6;
                            }
                        }
                    }
                }
            } else {
                // 0xc66c
                closedir(dirp);
                if (v315 != 2) {
                    uint32_t v323 = *v314 - 1; // 0xd104
                    v143 = (int64_t)"UNKNOWN";
                    v144 = v97;
                    if (v323 < 6) {
                        int64_t v324 = *(int64_t *)((0x100000000 * (int64_t)v323 >> 29) + (int64_t)&g21); // 0xd119
                        v143 = v324;
                        v144 = v97;
                        goto lab_0xd261;
                    } else {
                        goto lab_0xd261;
                    }
                } else {
                    // 0xc678
                    v61 = -1;
                    v67 = *(int64_t *)(v97 + 648);
                    v63 = (int64_t)&g10;
                    v65 = (int64_t)"OK";
                    v66 = 200;
                    v64 = v97;
                    v62 = (int64_t)"text/html; charset=%s";
                    goto lab_0xd44d;
                }
            }
        }
    }
  lab_0xcd36:;
    int64_t v325 = *(int64_t *)(v97 + 208); // 0xcd36
    syslog(LOG_INFO, "%.80s URL \"%.80s\" tried to index a directory with indexing disabled", (char *)&g99, (char *)v325);
    v3 = (int64_t)"Forbidden";
    v4 = 403;
    v5 = v97;
    v6 = (int64_t)"The requested URL '%.80s' resolves to a directory that has indexing disabled.\n";
    goto lab_0xc5cc;
  lab_0xc614:;
    int64_t v326 = auth_check2(v97, (int64_t *)v96, v15, a4, a5, a6); // 0xc617
    result = v326 & 0xffffffff;
    v312 = v96;
    switch ((int32_t)v326) {
        case -1: {
            goto lab_0xc5d6;
        }
        case 1: {
            goto lab_0xc638;
        }
        default: {
            goto lab_0xc628;
        }
    }
  lab_0xdf43:;
    int32_t * v327 = (int32_t *)(v313 + 76); // 0xdf43
    int32_t fd12 = *v327; // 0xdf43
    if (fd12 == -1) {
        goto lab_0xdf57;
    } else {
        // 0xdf4b
        close(fd12);
        *v327 = -1;
        goto lab_0xdf57;
    }
  lab_0xdf57:;
    int64_t v328 = *(int64_t *)(v13 + 648); // 0xdf7b
    send_mime(v13, 200, (int64_t)"OK", (int64_t *)&g10, (int64_t)&g10, "text/html; charset=%s", -1, v328);
    httpd_write_response(v13, 200, (int64_t)"OK");
    nice(10);
    struct _IO_FILE * stream = fdopen(*(int32_t *)(v13 + 704), "w"); // 0xdfab
    if (stream == NULL) {
        // 0xdfbe
        syslog(LOG_ERR, "fdopen - %m", (int64_t)"OK");
        int64_t v329 = *(int64_t *)(v13 + 208); // 0xdfd5
        httpd_send_err(v13, 500, (int64_t)"Internal Error", (int64_t)&g10, (int64_t)"There was an unusual problem serving the requested URL '%.80s'.\n", v329);
        httpd_write_response(v13, 500, (int64_t)"Internal Error");
        closedir(dirp);
        exit(1);
        // UNREACHABLE
    }
    char * v330 = (char *)*(int64_t *)(v13 + 208); // 0xe0a1
    fprintf(stream, "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<html>\n\n  <head>\n    <meta http-equiv=\"Content-type\" content=\"text/html;charset=UTF-8\">\n    <title>Index of %.80s</title>\n  </head>\n\n  <body bgcolor=\"#99cc99\" text=\"#000000\" link=\"#2020ff\" vlink=\"#4040cc\">\n\n    <h2>Index of %.80s</h2>\n\n    <pre>\nmode  links    bytes  last-changed  name\n    <hr>", v330, v330);
    struct dirent * v331 = readdir(dirp); // 0xe0a9
    int32_t nmemb = 0; // 0xe0b1
    int64_t v332 = 0; // 0xe0b1
    struct dirent * v333 = v331; // 0xe0b1
    if (v331 != NULL) {
        goto lab_0xe1c2;
    } else {
        goto lab_0xe0b7;
    }
  lab_0xe1c2:;
    int32_t v334 = g129; // 0xe1c2
    int64_t v335 = v334; // 0xe1c2
    int64_t v336; // 0xc260
    int64_t v337; // 0xc260
    int64_t v338; // 0xc260
    struct stat * v339; // 0xc260
    if (v332 < v335) {
        // 0xe17d
        v336 = g131;
        goto lab_0xe184;
    } else {
        if (v334 == 0) {
            // 0xe23c
            g129 = 100;
            int64_t * mem3 = malloc(0x64064); // 0xe24b
            int64_t v340 = (int64_t)mem3; // 0xe24b
            g130 = v340;
            int64_t * mem4 = malloc((int32_t)&g189); // 0xe25f
            int64_t v341 = (int64_t)mem4; // 0xe25f
            g131 = v341;
            format = (int64_t)"out of memory reallocating directory names";
            priority = 3;
            v339 = (struct stat *)100;
            v338 = v340;
            v337 = v341;
            if (mem3 == NULL || mem4 == NULL) {
                goto lab_0xd668;
            } else {
                goto lab_0xe288;
            }
        } else {
            // 0xe1d3
            g129 = 2 * v334;
            int64_t * mem5 = realloc((int64_t *)g130, 0x2002 * v334); // 0xe1f4
            int64_t v342 = (int64_t)mem5; // 0xe1f4
            g130 = v342;
            int64_t * mem6 = realloc((int64_t *)g131, 16 * v334); // 0xe211
            int64_t v343 = (int64_t)mem6; // 0xe211
            g131 = v343;
            format = (int64_t)"out of memory reallocating directory names";
            priority = 3;
            if (mem5 == NULL || mem6 == NULL) {
                goto lab_0xd668;
            } else {
                // 0xe232
                v336 = v343;
                v339 = (struct stat *)(0x200000000 * v335 >> 32);
                v338 = v342;
                v337 = v343;
                if (v334 >= 0) {
                    goto lab_0xe288;
                } else {
                    goto lab_0xe184;
                }
            }
        }
    }
  lab_0xe0b7:
    // 0xe0b7
    closedir(dirp);
    qsort((int64_t *)g131, nmemb, 8, (int32_t (*)(int64_t *, int64_t *))0xf7a0);
    int64_t * v344; // 0xc260
    int64_t v345; // 0xc260
    int64_t v346; // 0xc260
    int64_t * v347; // 0xc260
    int64_t v348; // 0xc260
    int32_t * v349; // 0xc260
    char * v350; // 0xc260
    int64_t timep; // 0xc260
    int64_t * v351; // 0xc260
    if (nmemb != 0) {
        // 0xe426
        v347 = (int64_t *)(v14 + 8);
        v348 = v14 + 432;
        v349 = (int32_t *)(v14 + 168);
        v350 = (char *)(v14 + 32);
        timep = v14 + 232;
        v351 = (int64_t *)(v14 + 16);
        v346 = 0;
        v345 = (int64_t)"text/html; charset=%s";
        goto lab_0xe426_2;
    } else {
        // 0xe0b7
        v344 = (int64_t *)(v14 + 16);
        goto lab_0xe0e6;
    }
  lab_0xe184:;
    char * str27 = (char *)((int64_t)v333 + 19); // 0xe18b
    int32_t len16 = strlen(str27); // 0xe18b
    int64_t * str28 = (int64_t *)(v336 + 8 * v332); // 0xe190
    strncpy((char *)*str28, str27, len16);
    *(char *)(*str28 + (int64_t)len16) = 0;
    int64_t v352 = v332 + 1; // 0xe1aa
    struct dirent * v353 = readdir(dirp); // 0xe1b1
    v332 = v352;
    v333 = v353;
    if (v353 == NULL) {
        // 0xe0b7
        nmemb = v352;
        goto lab_0xe0b7;
    } else {
        goto lab_0xe1c2;
    }
  lab_0xe426_2:;
    int64_t v354 = v345;
    int64_t * str29 = (int64_t *)(v13 + 240); // 0xe42a
    int32_t len17 = strlen((char *)*str29); // 0xe431
    int64_t v355 = 8 * v346; // 0xe440
    int32_t len18 = strlen((char *)*(int64_t *)(g131 + v355)); // 0xe444
    httpd_realloc_str((int64_t)&g132, (int64_t)&g133, (int64_t)len17 + 1 + (int64_t)len18);
    int32_t len19 = strlen((char *)*(int64_t *)(v13 + 232)); // 0xe46b
    int32_t len20 = strlen((char *)*(int64_t *)(g131 + v355)); // 0xe47e
    httpd_realloc_str((int64_t)&g134, (int64_t)&g135, (int64_t)len19 + 1 + (int64_t)len20);
    int64_t v356 = *str29; // 0xe49e
    char * str30 = (char *)v356; // 0xe4a5
    *v347 = v346;
    if (*str30 == 0) {
        goto lab_0xe53f;
    } else {
        // 0xe4b4
        if (strcmp(str30, ".") == 0) {
            goto lab_0xe53f;
        } else {
            int64_t v357 = *(int64_t *)(g131 + v355); // 0xe4dc
            my_snprintf((int64_t *)g132, (int64_t *)g133, "%s/%s", v356, (char *)v357, v354);
            int64_t str31 = *(int64_t *)(v13 + 232); // 0xe4f5
            int32_t strcmp_rc2 = strcmp((char *)str31, "."); // 0xe506
            char * v358 = (char *)*(int64_t *)(g131 + v355);
            if (strcmp_rc2 == 0) {
                // 0xe6b9
                char * v359; // 0xe50b
                int64_t v360; // 0xe520
                int64_t * v361; // 0xc260
                my_snprintf((int64_t *)v359, v361, "%s", v360, v358, v354);
                goto lab_0xe568;
            } else {
                // 0xe52c
                my_snprintf((int64_t *)g134, (int64_t *)g135, "%s%s", str31, v358, v354);
                goto lab_0xe568;
            }
        }
    }
  lab_0xe0e6:;
    struct _IO_FILE * stream2 = (struct _IO_FILE *)*v344; // 0xe0ff
    fwrite((int64_t *)"    </pre>\n  </body>\n</html>\n", 29, 1, stream2);
    fclose(stream2);
    exit(0);
    // UNREACHABLE
  lab_0xe288:;
    int64_t v362 = v337;
    int64_t v363 = v338;
    int64_t v364 = (int64_t)v339; // 0xe288
    int64_t v365 = 0; // 0xe299
    int64_t v366; // 0xc260
    int64_t v367; // 0xc260
    if ((v364 & 0xffffffff) >= 4) {
        // 0xe29f
        v366 = 0;
        v367 = &g186;
        goto lab_0xe2a9;
    } else {
        goto lab_0xe2f5;
    }
  lab_0xe53f:;
    int64_t * str32 = (int64_t *)(g131 + v355); // 0xe54d
    strcpy(g132, (char *)*str32);
    strcpy(g134, (char *)*str32);
    goto lab_0xe568;
  lab_0xe2f5:;
    int64_t v388 = v364 & 2; // 0xe292
    v336 = v362;
    int64_t v385; // 0xc260
    int64_t v386; // 0xc260
    if (v388 == 0) {
        goto lab_0xe184;
    } else {
        // 0xe2fe
        v385 = 0;
        v386 = 0x1001 * v365;
        goto lab_0xe30e;
    }
  lab_0xe568:;
    int32_t len21 = strlen(g134); // 0xe56f
    httpd_realloc_str((int64_t)&g136, (int64_t)&g137, 3 * (int64_t)len21 + 1);
    int64_t v368 = (int64_t)g136; // 0xe58f
    int64_t v369 = v368; // 0xe59f
    int64_t v370; // 0xc260
    int64_t v371; // 0xc260
    char v372; // 0xc260
    int64_t v373; // 0xc260
    int16_t ** v374; // 0xe5b9
    if (g137 < 5) {
        goto lab_0xe643;
    } else {
        char v375 = *g134; // 0xe5ac
        v369 = v368;
        if (v375 == 0) {
            goto lab_0xe643;
        } else {
            // 0xe5b9
            v374 = __ctype_b_loc();
            v373 = v368;
            v370 = (int64_t)g134;
            v371 = 0;
            v372 = v375;
            goto lab_0xe5c8;
        }
    }
  lab_0xe2a9:;
    int64_t v376 = 8 * v366 + v362;
    *(int64_t *)v376 = (v367 + 0xffffdffe & 0xfffffffc) + v363;
    *(int64_t *)(v376 + 8) = (v367 + 0xffffefff & 0xfffffffd) + v363;
    *(int64_t *)(v376 + 16) = (v367 & 0xfffffffc) + v363;
    *(int64_t *)(v376 + 24) = (v367 + (int64_t)(int32_t)&g2 & 0xfffffffc) + v363;
    int64_t v377 = v366 + 4; // 0xe2e5
    v366 = v377;
    v367 += (int64_t)&g196;
    v365 = v377;
    if ((v364 & 0xfffffffc) != v377) {
        goto lab_0xe2a9;
    } else {
        goto lab_0xe2f5;
    }
  lab_0xe643:
    // 0xe643
    *(char *)v369 = 0;
    int64_t v378 = v354; // 0xe65d
    char * time_str; // 0xe788
    int64_t v379; // 0xe788
    if (stat(g132, (struct stat *)(v14 + 288)) < 0) {
        goto lab_0xe412;
    } else {
        // 0xe663
        v378 = v354;
        if (lstat(g132, (struct stat *)(v14 + 144)) < 0) {
            goto lab_0xe412;
        } else {
            // 0xe67f
            *(char *)v348 = 0;
            uint32_t v380 = (*v349 & 0xf000) - 0x1000; // 0xe695
            if (v380 < 0xb001) {
                int32_t v381 = *(int32_t *)((int64_t)(v380 / 1024) + (int64_t)&g5); // 0xe6a9
                return (int64_t)v381 + (int64_t)&g5;
            }
            // 0xe6d6
            *v350 = 63;
            uint32_t v382 = *v349; // 0xe73b
            *(char *)(v14 + 33) = (v382 & 4) == 0 ? 45 : 114;
            *(char *)(v14 + 34) = (v382 & 2) == 0 ? 45 : 119;
            *(char *)(v14 + 35) = v382 % 2 == 0 ? 45 : 120;
            *(char *)(v14 + 36) = 0;
            int32_t time_val = time(NULL); // 0xe778
            time_str = ctime((int32_t *)timep);
            v379 = (int64_t)time_str;
            int64_t v383 = v379 + 4; // 0xe78d
            *time_str = *(char *)v383;
            *(int16_t *)(v379 + 1) = *(int16_t *)(v379 + 5);
            *(char *)(v379 + 3) = 32;
            int64_t v384 = v379 + 8; // 0xe79e
            *(int16_t *)v383 = *(int16_t *)v384;
            *(char *)(v379 + 6) = 32;
            if ((int64_t)time_val - *(int64_t *)timep < 0xeff101) {
                // 0xe7c7
                *(int16_t *)(v379 + 7) = *(int16_t *)(v379 + 11);
                *(char *)(v379 + 9) = 58;
                *(int16_t *)(v379 + 10) = *(int16_t *)(v379 + 14);
                goto lab_0xe7db;
            } else {
                // 0xe7bb
                *(char *)(v379 + 7) = 32;
                *(int32_t *)v384 = *(int32_t *)(v379 + 20);
                goto lab_0xe7db;
            }
        }
    }
  lab_0xe30e:
    // 0xe30e
    *(int64_t *)(8 * (v385 + v365) + v362) = (v386 & 0xffffffff) + v363;
    int64_t v387 = v385 + 1; // 0xe317
    v336 = v362;
    v385 = v387;
    v386 += (int64_t)&g2;
    if (v388 != v387) {
        goto lab_0xe30e;
    } else {
        goto lab_0xe184;
    }
  lab_0xe412:;
    int64_t v389 = *v347 + 1; // 0xe417
    v344 = v351;
    v346 = v389;
    v345 = v378;
    if (v389 == *(int64_t *)(v14 + 24)) {
        goto lab_0xe0e6;
    } else {
        goto lab_0xe426_2;
    }
  lab_0xe5c8:;
    unsigned char c = v372;
    int64_t v390 = v371;
    int64_t str33 = v373;
    int16_t * v391 = *v374;
    char v392 = *(char *)((0x100000000000000 * (int64_t)c >> 55) + (int64_t)v391); // 0xe5d0
    int64_t v393; // 0xc260
    if ((v392 & 8) != 0) {
        // 0xe5f0
        *(char *)str33 = c;
        v393 = 1;
        goto lab_0xe5fe;
    } else {
        // 0xe5d6
        if (memchr((int64_t *)"/_.-~", (int32_t)c, 6) == NULL) {
            // 0xe622
            sprintf((char *)str33, "%%%02x", (int32_t)c);
            v393 = 3;
            goto lab_0xe5fe;
        } else {
            // 0xe5f0
            *(char *)str33 = c;
            v393 = 1;
            goto lab_0xe5fe;
        }
    }
  lab_0xe5fe:;
    int64_t v394 = v370 + 1;
    int64_t v395 = v393;
    int64_t v396 = v395 + str33; // 0xe5fe
    char v397 = *(char *)v394; // 0xe601
    v369 = v396;
    if (v397 == 0) {
        goto lab_0xe643;
    } else {
        int64_t v398 = v395 + v390; // 0xe60b
        v373 = v396;
        v370 = v394;
        v371 = v398 & 0xffffffff;
        v372 = v397;
        v369 = v396;
        if ((v398 + 4 & 0xffffffff) < (int64_t)g137) {
            goto lab_0xe5c8;
        } else {
            goto lab_0xe643;
        }
    }
  lab_0xe7db:
    // 0xe7db
    *(char *)(v379 + 12) = 0;
    uint32_t v399 = *(int32_t *)(v14 + 312); // 0xe7df
    int32_t v400 = v399 & 0xf000; // 0xe7e8
    int64_t v401 = (int64_t)"/"; // 0xc260
    switch ((int16_t)v400) {
        case -0x6000: {
            // 0xe824
            v401 = &g16;
            goto lab_0xe3a8;
        }
        case 0x4000: {
            goto lab_0xe3a8;
        }
        default: {
            // 0xe80c
            v401 = &g11;
            if (v400 != 0xc000) {
                int64_t v402 = v399 % 2 == 0 ? (int64_t)&g10 : (int64_t)&g15; // 0xe3a4
                v401 = v402;
                goto lab_0xe3a8;
            } else {
                goto lab_0xe3a8;
            }
        }
    }
  lab_0xe3a8:;
    int64_t v403 = *(int64_t *)(v14 + 160); // 0xe3a8
    int64_t v404 = *(int64_t *)(v14 + 192); // 0xe3b0
    int64_t v405 = v400 == 0x4000 ? (int64_t)"/" : (int64_t)&g10; // 0xe3cc
    int64_t stream3 = *v351; // 0xe3d7
    *(int64_t *)(v14 - 8) = v401;
    *(int64_t *)(v14 - 16) = v348;
    *(int64_t *)(v14 - 24) = (int64_t)&g10;
    *(int64_t *)(v14 - 32) = *(int64_t *)(8 * *v347 + g131);
    *(int64_t *)(v14 - 40) = v405;
    *(int64_t *)(v14 - 48) = (int64_t)g136;
    fprintf((struct _IO_FILE *)stream3, "%s %3ld  %10lld  %s  <a href=\"/%.500s%s\">%.80s</a>%s%s%s\n", v350, (int32_t)v403, v404, time_str);
    v378 = v379;
    goto lab_0xe412;
  lab_0xd2b7:;
    int64_t v74 = v73;
    int64_t v75 = v72;
    int32_t v76 = v74 + v75; // 0xd2bb
    int32_t v77 = (int32_t)(v76 < 0) + v76 >> 1; // 0xd2c2
    int64_t v78 = 32 * (int64_t)v77; // 0xd2c7
    int64_t str12 = *(int64_t *)(v78 + (int64_t)&g41); // 0xd2d2
    int32_t v79 = strncasecmp((char *)str11, (char *)str12, n); // 0xd2dc
    int64_t v80; // 0xc260
    int64_t v81; // 0xc260
    int64_t v82; // 0xc260
    int64_t v83; // 0xd2e5
    if (v79 < 0) {
        // 0xd2a8
        v82 = v13;
        v80 = v77 - 1;
        v81 = v74;
        goto lab_0xd2b2;
    } else {
        // 0xd2e5
        v83 = v13;
        if (v79 != 0) {
            goto lab_0xd308;
        } else {
            uint64_t v84 = *(int64_t *)(v78 + (int64_t)&g41 + 8); // 0xd2f7
            if (v84 <= v71) {
                if (v84 < v71) {
                    goto lab_0xd308;
                } else {
                    int64_t v85 = *(int64_t *)(v78 + (int64_t)&g41 + 16); // 0xd317
                    v44 = (char *)v85;
                    goto lab_0xd321;
                }
            } else {
                // 0xd2fe
                v82 = v83;
                v80 = v77 - 1;
                v81 = v74;
                goto lab_0xd2b2;
            }
        }
    }
  lab_0xd2b2:
    // 0xd2b2
    str11 = v82;
    v72 = v80;
    v73 = v81;
    v44 = "text/plain; charset=%s";
    if (v80 < v81) {
        goto lab_0xd321;
    } else {
        goto lab_0xd2b7;
    }
  lab_0xd308:
    // 0xd308
    v82 = v83;
    v80 = v75;
    v81 = v77 + 1;
    goto lab_0xd2b2;
}

// Address range: 0xe850 - 0xe8d2
int64_t httpd_read_fully(int64_t fd, int64_t a2, uint64_t a3) {
    // 0xe850
    if (a3 == 0) {
        // 0xe8c7
        return 0;
    }
    int64_t v1 = 0; // 0xe87a
    int64_t v2 = 0;
    int64_t v3; // 0xe850
    int64_t v4; // 0xe850
    int64_t v5; // 0xe88f
    while (true) {
      lab_0xe882:;
        int64_t v6 = v2;
        int64_t v7 = v1;
        int32_t v8 = read((int32_t)fd, (int64_t *)(v7 + a2), (int32_t)(a3 - v7)); // 0xe88f
        v5 = v8;
        if (v8 < 0) {
            // 0xe8b0
            switch (*__errno_location()) {
                case 11: {
                    // 0xe870
                    sleep(1);
                    v3 = v6;
                    goto lab_0xe87a;
                }
                case 4: {
                    // 0xe870
                    sleep(1);
                    v3 = v6;
                    goto lab_0xe87a;
                }
                default: {
                    return v5 & 0xffffffff & 0xffffffff;
                }
            }
        } else {
            int64_t v9 = v6 + v5 & 0xffffffff; // 0xe89b
            v3 = v9;
            v4 = v9;
            if (v8 == 0) {
                // 0xe8c7
                return v4 & 0xffffffff;
            }
            goto lab_0xe87a;
        }
    }
    // 0xe8c7
    return v5 & 0xffffffff & 0xffffffff;
  lab_0xe87a:
    // 0xe87a
    v2 = v3;
    v1 = 0x100000000 * v2 >> 32;
    v4 = v2;
    if (v1 >= a3) {
        // 0xe8c7
        return v4 & 0xffffffff;
    }
    goto lab_0xe882;
}

// Address range: 0xe8e0 - 0xe934
int64_t httpd_logstats(void) {
    // 0xe8e0
    if (g96 < 1) {
        // 0xe8fd
        int64_t result; // 0xe8e0
        return result;
    }
    uint64_t v1 = (int64_t)g98; // 0xe8ea
    int128_t v2; // 0xe8e0
    if (g98 < 0) {
        int128_t v3 = __asm_cvtsi2ss(v1 % 2 | v1 / 2); // 0xe90c
        v2 = __asm_addss(v3, v3);
    } else {
        // 0xe8f6
        v2 = __asm_cvtsi2ss(v1);
    }
    int128_t v4 = __asm_divss(v2, __asm_cvtsi2ss_2(g96)); // 0xe919
    syslog(LOG_NOTICE, "  libhttpd - %d strings allocated, %lu bytes (%g bytes/str)", (int64_t)g96, g98, (float64_t)(int64_t)__asm_cvtss2sd(v4));
    return &g204;
}

// Address range: 0xe940 - 0xee52
int64_t send_mime(int64_t a1, int64_t a2, int64_t a3, int64_t * a4, int64_t str5, char * a6, int64_t a7, int64_t a8) {
    int64_t v1 = str5;
    int64_t timep2 = a8;
    int32_t v2 = a2; // 0xe969
    int32_t * v3 = (int32_t *)(a1 + 184); // 0xe969
    *v3 = v2;
    *(int64_t *)(a1 + 192) = a7;
    if (*(int32_t *)(a1 + 520) == 0) {
        // 0xee40
        int64_t result; // 0xe940
        return result;
    }
    int32_t * v4 = (int32_t *)(a1 + 528);
    if (v2 != 200) {
        goto lab_0xe9fe;
    } else {
        // 0xe998
        if (*v4 == 0) {
            goto lab_0xe9fe;
        } else {
            int64_t v5 = *(int64_t *)(a1 + 536); // 0xe9a1
            int64_t v6 = *(int64_t *)(a1 + 544); // 0xe9a8
            if (v6 < v5) {
                goto lab_0xe9fe;
            } else {
                if (v5 == 0 == v6 == a7 - 1) {
                    goto lab_0xe9fe;
                } else {
                    int64_t v7 = *(int64_t *)(a1 + 488); // 0xe9c2
                    if (v7 == -1) {
                        goto lab_0xe9d8;
                    } else {
                        // 0xe9cf
                        if (v7 != *(int64_t *)(a1 + 648)) {
                            goto lab_0xe9fe;
                        } else {
                            goto lab_0xe9d8;
                        }
                    }
                }
            }
        }
    }
  lab_0xe9fe:
    // 0xe9fe
    *v4 = 0;
    char * v8 = (char *)a3; // 0xea0f
    int64_t v9 = a2 & 0xffffffff; // 0xea0f
    char v10 = 1; // 0xea0f
    goto lab_0xea13;
  lab_0xea13:;
    int64_t time_val = time(NULL); // 0xea15
    int64_t timep = time_val; // bp-1928, 0xea1a
    if (a8 == 0) {
        // 0xea24
        timep2 = time_val;
    }
    struct tm * time_info = gmtime((int32_t *)&timep); // 0xea31
    int64_t str; // bp-1896, 0xe940
    strftime((char *)&str, 100, "%a, %d %b %Y %H:%M:%S GMT", time_info);
    struct tm * time_info2 = gmtime((int32_t *)&timep2); // 0xea5a
    int64_t str2; // bp-1672, 0xe940
    strftime((char *)&str2, 100, "%a, %d %b %Y %H:%M:%S GMT", time_info2);
    int64_t * v11 = (int64_t *)(a1 + 8); // 0xea7a
    int64_t v12 = *(int64_t *)(*v11 + 40); // 0xea7e
    int64_t v13; // bp-552, 0xe940
    my_snprintf(&v13, (int64_t *)500, a6, v12, (char *)v1, (int64_t)a6);
    int64_t v14 = *(int64_t *)(a1 + 224); // 0xea9c
    v1 = v9;
    int64_t v15 = (int64_t)v8; // 0xeac4
    int64_t str3; // bp-1560, 0xe940
    my_snprintf(&str3, &g192, "%.20s %d %s\r\nServer: %s\r\nContent-Type: %s\r\nDate: %s\r\nLast-Modified: %s\r\nAccept-Ranges: bytes\r\nConnection: close\r\n", v14, (char *)v9, v15);
    int32_t len = strlen((char *)&str3); // 0xeae3
    int64_t v16 = len; // 0xeae3
    int64_t v17 = a1 + 368; // 0xeaeb
    int64_t v18 = a1 + 464; // 0xeaf2
    int64_t * v19 = (int64_t *)(a1 + 472); // 0xeb00
    httpd_realloc_str(v17, v18, *v19 + v16);
    int64_t * v20 = (int64_t *)v17; // 0xeb15
    memmove((int64_t *)(*v19 + *v20), &str3, len);
    int64_t v21 = *v19 + v16; // 0xeb33
    *v19 = v21;
    int64_t v22 = v21; // 0xeb52
    if ((int32_t)v9 < 200) {
        // 0xeb54
        my_snprintf(&str3, &g192, "Cache-Control: no-cache,no-store\r\n", v14, (char *)v1, v15);
        int32_t len2 = strlen((char *)&str3); // 0xeb75
        int64_t v23 = len2; // 0xeb75
        httpd_realloc_str(v17, v18, *v19 + v23);
        memmove((int64_t *)(*v19 + *v20), &str3, len2);
        int64_t v24 = *v19 + v23; // 0xeb9f
        *v19 = v24;
        v22 = v24;
    }
    int64_t v25 = (int64_t)a4;
    int64_t v26 = v22; // 0xebad
    if ((char)v25 != 0) {
        // 0xebaf
        my_snprintf(&str3, &g192, "Content-Encoding: %s\r\n", v25, (char *)v1, v15);
        int32_t len3 = strlen((char *)&str3); // 0xebd0
        int64_t v27 = len3; // 0xebd0
        httpd_realloc_str(v17, v18, *v19 + v27);
        memmove((int64_t *)(*v19 + *v20), &str3, len3);
        int64_t v28 = *v19 + v27; // 0xebfa
        *v19 = v28;
        v26 = v28;
    }
    int64_t v29; // 0xe940
    int64_t v30; // 0xe940
    int64_t v31; // 0xe940
    if (v10 == 0) {
        int64_t v32 = *(int64_t *)(a1 + 536); // 0xec35
        int64_t v33 = *(int64_t *)(a1 + 544); // 0xec3c
        v1 = v33;
        my_snprintf(&str3, &g192, "Content-Range: bytes %lld-%lld/%lld\r\nContent-Length: %lld\r\n", v32, (char *)v33, a7);
        v30 = a7;
        goto lab_0xec79;
    } else {
        // 0xec07
        v31 = v15;
        v29 = v26;
        if (a7 < 0) {
            goto lab_0xecb4;
        } else {
            // 0xec18
            my_snprintf(&str3, &g192, "Content-Length: %lld\r\n", a7, (char *)v1, v15);
            v30 = v15;
            goto lab_0xec79;
        }
    }
  lab_0xec79:;
    int32_t len4 = strlen((char *)&str3); // 0xec84
    int64_t v34 = len4; // 0xec84
    httpd_realloc_str(v17, v18, *v19 + v34);
    memmove((int64_t *)(*v19 + *v20), &str3, len4);
    int64_t v35 = *v19 + v34; // 0xecae
    *v19 = v35;
    v31 = v30;
    v29 = v35;
    goto lab_0xecb4;
  lab_0xecb4:;
    int64_t v36 = *v11; // 0xecb4
    int64_t v37 = *(int64_t *)(v36 + 48); // 0xecb8
    int64_t v38 = v36; // 0xecbf
    int64_t v39 = v29; // 0xecbf
    if (*(char *)v37 != 0) {
        // 0xecc1
        my_snprintf(&str3, &g192, "P3P: %s\r\n", v37, (char *)v1, v31);
        int32_t len5 = strlen((char *)&str3); // 0xece2
        int64_t v40 = len5; // 0xece2
        httpd_realloc_str(v17, v18, *v19 + v40);
        memmove((int64_t *)(*v19 + *v20), &str3, len5);
        int64_t v41 = *v19 + v40; // 0xed18
        *v19 = v41;
        v38 = *v11;
        v39 = v41;
    }
    uint32_t v42 = *(int32_t *)(v38 + 56); // 0xed2a
    int64_t v43 = v39; // 0xed2f
    if (v42 >= 0) {
        int64_t timep3 = timep + (int64_t)v42; // bp-1904, 0xed3a
        struct tm * time_info3 = gmtime((int32_t *)&timep3); // 0xed44
        int64_t str4; // bp-1784, 0xe940
        strftime((char *)&str4, 100, "%a, %d %b %Y %H:%M:%S GMT", time_info3);
        uint32_t v44 = *(int32_t *)(*v11 + 56); // 0xed6f
        my_snprintf(&str3, &g192, "Cache-Control: max-age=%d\r\nExpires: %s\r\n", (int64_t)v44, (char *)&str4, v31);
        int32_t len6 = strlen((char *)&str3); // 0xed99
        int64_t v45 = len6; // 0xed99
        httpd_realloc_str(v17, v18, *v19 + v45);
        memmove((int64_t *)(*v19 + *v20), &str3, len6);
        int64_t v46 = *v19 + v45; // 0xedcf
        *v19 = v46;
        v43 = v46;
    }
    int64_t v47 = v43; // 0xede6
    if (*(char *)&v1 != 0) {
        int32_t len7 = strlen((char *)str5); // 0xedeb
        int64_t v48 = len7; // 0xedeb
        httpd_realloc_str(v17, v18, v43 + v48);
        memmove((int64_t *)(*v19 + *v20), (int64_t *)str5, len7);
        int64_t v49 = *v19 + v48; // 0xee15
        *v19 = v49;
        v47 = v49;
    }
    // 0xee1e
    httpd_realloc_str(v17, v18, v47 + 2);
    int64_t result2 = *v20; // 0xee30
    *(int16_t *)(*v19 + result2) = (int16_t)&g203;
    *v19 = *v19 + 2;
    // 0xee40
    return result2;
  lab_0xe9d8:
    // 0xe9d8
    *v3 = 206;
    v8 = "Partial Content";
    v9 = 206;
    v10 = 0;
    goto lab_0xea13;
}

// Address range: 0xee60 - 0xee6b
int64_t ext_compare(int64_t str, int64_t str2) {
    // 0xee60
    return strcmp((char *)str, (char *)str2);
}

// Address range: 0xee70 - 0xf125
int64_t check_referrer(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t * v1 = (int64_t *)(a1 + 8); // 0xee7e
    int64_t v2 = *v1; // 0xee7e
    int64_t * v3 = (int64_t *)(v2 + 112); // 0xee82
    int64_t v4 = *v3; // 0xee82
    if (v4 == 0) {
        // 0xf104
        return 1;
    }
    int64_t * v5 = (int64_t *)(a1 + 272); // 0xee97
    int64_t v6 = *v5; // 0xee97
    int64_t v7; // 0xee70
    if (v6 == 0) {
        goto lab_0xef64;
    } else {
        char * str = (char *)v6; // 0xeea7
        if (*str == 0) {
            goto lab_0xef64;
        } else {
            char * substr_pos = strstr(str, "//"); // 0xeeb7
            int64_t v8 = (int64_t)substr_pos; // 0xeeb7
            int64_t v9 = 2; // 0xeebf
            if (substr_pos == NULL) {
                goto lab_0xef64;
            } else {
                uint64_t v10; // 0xee70
                uint64_t v11; // 0xeee4
                while (true) {
                    // 0xeee4
                    v10 = v9;
                    v11 = v10 + v8;
                    unsigned char v12 = *(char *)v11; // 0xeee4
                    if (v12 < 59) {
                        if ((1 << (int64_t)(v12 % 64)) % 0x400800000000002 != 0) {
                            // break -> 0xeef5
                            break;
                        }
                    }
                    // 0xeee0
                    v9 = v10 + 1;
                }
                // 0xeef5
                httpd_realloc_str((int64_t)&g127, (int64_t)&g128, v10 - 2);
                int64_t v13 = (int64_t)g127; // 0xef0c
                int64_t v14 = v13; // 0xef1c
                if (v10 >= 3) {
                    int16_t ** v15 = __ctype_b_loc(); // 0xef25
                    int64_t v16 = v8 + 2; // 0xef2d
                    int64_t v17 = v13; // 0xef2d
                    char v18 = *(char *)v16; // 0xef48
                    int64_t v19 = v18; // 0xef4b
                    char v20 = v18; // 0xef54
                    if (*(char *)((int64_t)*v15 + 1 + 2 * v19) % 2 != 0) {
                        // 0xef56
                        v20 = *(char *)(4 * v19 + (int64_t)*__ctype_tolower_loc());
                    }
                    // 0xef30
                    *(char *)v17 = v20;
                    v16++;
                    v17++;
                    v14 = v17;
                    while (v16 < v11) {
                        // 0xef44
                        v18 = *(char *)v16;
                        v19 = v18;
                        v20 = v18;
                        if (*(char *)((int64_t)*v15 + 1 + 2 * v19) % 2 != 0) {
                            // 0xef56
                            v20 = *(char *)(4 * v19 + (int64_t)*__ctype_tolower_loc());
                        }
                        // 0xef30
                        *(char *)v17 = v20;
                        v16++;
                        v17++;
                        v14 = v17;
                    }
                }
                // 0xf004
                *(char *)v14 = 0;
                int64_t v21 = *(int64_t *)(v2 + 120); // 0xf008
                int64_t v22 = v21; // 0xf019
                if (v21 == 0) {
                    // 0xf01f
                    if (*(int32_t *)(v2 + 100) == 0) {
                        int64_t v23 = *(int64_t *)(v2 + 8); // 0xf0eb
                        v22 = v23;
                        if (v23 == 0) {
                            // 0xf104
                            return 1;
                        }
                    } else {
                        int64_t v24 = *(int64_t *)(a1 + 512); // 0xf02a
                        v22 = v24;
                        if (v24 == 0) {
                            // 0xf104
                            return 1;
                        }
                    }
                }
                // 0xf0f4
                if ((int32_t)match(v22, (int64_t)g127) != 0) {
                    // 0xf104
                    return 1;
                }
                // 0xf115
                v7 = *v3;
                goto lab_0xef7c;
            }
        }
    }
  lab_0xef64:
    // 0xef64
    v7 = v4;
    if (*(int32_t *)(v2 + 128) == 0) {
        // 0xf104
        return 1;
    }
    goto lab_0xef7c;
  lab_0xef7c:
    // 0xef7c
    if ((int32_t)match(v7, *(int64_t *)(a1 + 232)) == 0) {
        // 0xf104
        return 1;
    }
    int64_t v25 = *v1; // 0xef89
    int64_t v26; // 0xee70
    if (*(int32_t *)(v25 + 100) == 0) {
        // 0xef9f
        v26 = *(int64_t *)(v25 + 8);
        goto lab_0xefa3;
    } else {
        int64_t v27 = *(int64_t *)(a1 + 512); // 0xef93
        v26 = v27;
        if (v27 != 0) {
            goto lab_0xefa3;
        } else {
            // 0xef9f
            v26 = *(int64_t *)(v25 + 8);
            goto lab_0xefa3;
        }
    }
  lab_0xefa3:;
    int64_t v28 = v26;
    int64_t sa = a1 + 16; // 0xefb1
    int16_t v29 = *(int16_t *)sa; // 0xefb5
    int32_t salen = v29 != 2 ? v29 != 10 ? 0 : 28 : 16; // 0xefd1
    int32_t v30 = getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1); // 0xefed
    if (v30 == 0) {
        // 0xf03f
        if (*(int32_t *)(a1 + 24) == 0) {
            // 0xf046
            if (*(int32_t *)(a1 + 28) == 0) {
                // 0xf04d
                if (*(int32_t *)(a1 + 32) == -0x10000) {
                    // 0xf057
                    if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                        int32_t len = strlen((char *)&g101); // 0xf07b
                        memmove((int64_t *)&g99, (int64_t *)&g101, len + 1);
                    }
                }
            }
        }
    } else {
        // 0xeff6
        *(int16_t *)&g99 = 63;
    }
    int64_t * v31 = (int64_t *)(a1 + 208); // 0xf093
    int64_t v32 = *v31; // 0xf093
    int64_t v33 = *v5; // 0xf09a
    char * v34 = v28 != 0 ? (char *)v28 : (char *)&g10; // 0xf0bb
    syslog(LOG_INFO, "%.80s non-local referrer \"%.80s%.80s\" \"%.80s\"", (char *)&g99, v34, (char *)v32, (char *)v33);
    int64_t v35 = *v31; // 0xf0c0
    httpd_send_err(a1, 403, (int64_t)"Forbidden", (int64_t)&g10, (int64_t)"You must supply a local referrer to get URL '%.80s' from this server.\n", v35);
    // 0xf104
    return 0;
}

// Address range: 0xf130 - 0xf6f5
int64_t auth_check2(int64_t a1, int64_t * str, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t v1 = (int64_t)str;
    int32_t len = strlen((char *)str); // 0xf14a
    httpd_realloc_str((int64_t)&g116, (int64_t)&g117, (int64_t)len + 11);
    my_snprintf((int64_t *)g116, (int64_t *)g117, "%s/%s", v1, ".htpasswd", a6);
    int64_t buf; // bp-1208, 0xf130
    if (stat(g116, (struct stat *)&buf) < 0) {
        // 0xf257
        return 0;
    }
    int64_t v2 = *(int64_t *)(a1 + 352); // 0xf1a7
    char * str2 = (char *)v2; // 0xf1ae
    char * str9; // 0xf130
    int64_t str8; // 0xf130
    int64_t str3; // bp-1064, 0xf130
    int32_t v3; // bp-1224, 0xf130
    int64_t v4; // 0xf13a
    char * str4; // 0xf369
    if (*str2 == 0) {
        goto lab_0xf1cf;
    } else {
        // 0xf1b3
        if (strncmp(str2, "Basic ", 6) == 0) {
            char v5 = *(char *)(v2 + 6); // 0xf26b
            if (v5 != 0) {
                char v6 = v5; // 0xf28e
                int64_t v7 = v2 + 7; // 0xf28e
                while (*(int32_t *)(4 * (int64_t)v6 + (int64_t)&g8) == -1) {
                    // 0xf292
                    v6 = *(char *)v7;
                    v7++;
                    if (v6 == 0) {
                        goto lab_0xf331;
                    }
                }
                // 0xf257
                return (int64_t)&g6 - 0x3ae1;
            }
          lab_0xf331:
            // 0xf331
            v4 = &v3;
            *(char *)(v4 + 160) = 0;
            char * found_char_pos = strchr((char *)&str3, 58); // 0xf349
            if (found_char_pos == NULL) {
                goto lab_0xf1cf;
            } else {
                // 0xf357
                *found_char_pos = 0;
                str4 = (char *)((int64_t)found_char_pos + 1);
                char * found_char_pos2 = strchr(str4, 58); // 0xf369
                if (found_char_pos2 != NULL) {
                    // 0xf373
                    *found_char_pos2 = 0;
                }
                // 0xf376
                if (g119 == 0) {
                    goto lab_0xf3c4;
                } else {
                    // 0xf387
                    if (strcmp(g116, g118) != 0) {
                        goto lab_0xf3c4;
                    } else {
                        // 0xf39a
                        int64_t v8; // 0xf130
                        if (v8 != g120) {
                            goto lab_0xf3c4;
                        } else {
                            // 0xf3a8
                            if (strcmp((char *)&str3, g121) == 0) {
                                // 0xf679
                                if (strcmp(crypt(str4, g123), g123) != 0) {
                                  lab_0xf69b:
                                    // 0xf69b
                                    send_authenticate(a1, v1);
                                    // 0xf257
                                    return 0xffffffff;
                                }
                                int64_t v9 = a1 + 360; // 0xf6b0
                                int32_t len2 = strlen((char *)&str3); // 0xf6c9
                                httpd_realloc_str(v9, a1 + 456, (int64_t)len2);
                                str9 = (char *)&str3;
                                str8 = *(int64_t *)v9;
                                goto lab_0xf6e6;
                            } else {
                                goto lab_0xf3c4;
                            }
                        }
                    }
                }
            }
        } else {
            goto lab_0xf1cf;
        }
    }
  lab_0xf1cf:;
    int32_t len3 = strlen((char *)str); // 0xf1d2
    httpd_realloc_str((int64_t)&g125, (int64_t)&g126, (int64_t)len3 + 35);
    my_snprintf((int64_t *)g125, (int64_t *)g126, "%s%s\"\r\n", (int64_t)"WWW-Authenticate: Basic realm=\"", (char *)str, a6);
    int64_t v10 = *(int64_t *)(a1 + 208); // 0xf21b
    httpd_send_err(a1, 401, (int64_t)"Unauthorized", g125, (int64_t)"Authorization required for the URL '%.80s'.\n", v10);
    if (*(int32_t *)(a1 + 180) == 3) {
        // 0xf24c
        *(int32_t *)(a1 + 556) = 1;
    }
    // 0xf257
    return 0xffffffff;
  lab_0xf3c4:;
    struct _IO_FILE * file = fopen(g116, "r"); // 0xf3ce
    if (file == NULL) {
        int64_t sa = a1 + 16; // 0xf589
        int16_t v11 = *(int16_t *)sa; // 0xf58d
        int32_t salen = v11 != 2 ? v11 != 10 ? 0 : 28 : 16; // 0xf5a9
        v3 = 1;
        int32_t v12 = getnameinfo((struct sockaddr *)sa, salen, (char *)&g99, 200, NULL, 0, 1); // 0xf5c5
        if (v12 == 0) {
            // 0xf5d9
            if (*(int32_t *)(a1 + 24) == 0) {
                // 0xf5e0
                if (*(int32_t *)(a1 + 28) == 0) {
                    // 0xf5e7
                    if (*(int32_t *)(a1 + 32) == -0x10000) {
                        // 0xf5f1
                        if (*(int32_t *)&g99 == 0x66663a3a == g100 == 0x3a666666) {
                            int32_t len4 = strlen((char *)&g101); // 0xf615
                            memmove((int64_t *)&g99, (int64_t *)&g101, len4 + 1);
                        }
                    }
                }
            }
        } else {
            // 0xf5ce
            *(int16_t *)&g99 = 63;
        }
        // 0xf62d
        syslog(LOG_ERR, "%.80s auth file %.80s could not be opened - %m", (char *)&g99, g116, 0);
        int64_t v13 = *(int64_t *)(a1 + 208); // 0xf64e
        httpd_send_err(a1, 403, (int64_t)"Forbidden", (int64_t)&g10, (int64_t)"The requested URL '%.80s' is protected by an authentication file, but the authentication file cannot be opened.\n", v13);
        // 0xf257
        return 0xffffffff;
    }
    // 0xf3dc
    int64_t str5; // bp-552, 0xf130
    if (fgets((char *)&str5, 500, file) != NULL) {
        int32_t len5 = strlen((char *)&str5); // 0xf42c
        char * v14 = (char *)(v4 + 672 + (int64_t)(len5 - 1)); // 0xf436
        if (*v14 == 10) {
            // 0xf440
            *v14 = 0;
        }
        char * found_char_pos3 = strchr((char *)&str5, 58); // 0xf450
        char * str6; // 0xf130
        int64_t str7; // 0xf49e
        int32_t len6; // 0xf4b7
        int32_t len7; // 0xf4e0
        int32_t len8; // 0xf525
        int32_t len9; // 0xf552
        if (found_char_pos3 != NULL) {
            // 0xf45a
            *found_char_pos3 = 0;
            if (strcmp((char *)&str5, (char *)&str3) == 0) {
                // 0xf474
                fclose(file);
                str6 = (char *)((int64_t)found_char_pos3 + 1);
                if (strcmp(crypt(str4, str6), str6) != 0) {
                    goto lab_0xf69b;
                } else {
                    // 0xf49e
                    str7 = a1 + 360;
                    len6 = strlen((char *)&str5);
                    httpd_realloc_str(str7, a1 + 456, (int64_t)len6);
                    strcpy((char *)*(int64_t *)str7, (char *)&str5);
                    len7 = strlen(g116);
                    httpd_realloc_str((int64_t)&g118, (int64_t)&g119, (int64_t)len7);
                    strcpy(g118, g116);
                    len8 = strlen((char *)&str3);
                    httpd_realloc_str((int64_t)&g121, (int64_t)&g122, (int64_t)len8);
                    strcpy(g121, (char *)&str3);
                    len9 = strlen(str6);
                    httpd_realloc_str((int64_t)&g123, (int64_t)&g124, (int64_t)len9);
                    str9 = str6;
                    str8 = (int64_t)g123;
                    goto lab_0xf6e6;
                }
            }
        }
        // 0xf429
        while (fgets((char *)&str5, 500, file) != NULL) {
            // 0xf429
            len5 = strlen((char *)&str5);
            v14 = (char *)(v4 + 672 + (int64_t)(len5 - 1));
            if (*v14 == 10) {
                // 0xf440
                *v14 = 0;
            }
            // 0xf448
            found_char_pos3 = strchr((char *)&str5, 58);
            if (found_char_pos3 != NULL) {
                // 0xf45a
                *found_char_pos3 = 0;
                if (strcmp((char *)&str5, (char *)&str3) == 0) {
                    // 0xf474
                    fclose(file);
                    str6 = (char *)((int64_t)found_char_pos3 + 1);
                    if (strcmp(crypt(str4, str6), str6) != 0) {
                        goto lab_0xf69b;
                    } else {
                        // 0xf49e
                        str7 = a1 + 360;
                        len6 = strlen((char *)&str5);
                        httpd_realloc_str(str7, a1 + 456, (int64_t)len6);
                        strcpy((char *)*(int64_t *)str7, (char *)&str5);
                        len7 = strlen(g116);
                        httpd_realloc_str((int64_t)&g118, (int64_t)&g119, (int64_t)len7);
                        strcpy(g118, g116);
                        len8 = strlen((char *)&str3);
                        httpd_realloc_str((int64_t)&g121, (int64_t)&g122, (int64_t)len8);
                        strcpy(g121, (char *)&str3);
                        len9 = strlen(str6);
                        httpd_realloc_str((int64_t)&g123, (int64_t)&g124, (int64_t)len9);
                        str9 = str6;
                        str8 = (int64_t)g123;
                        goto lab_0xf6e6;
                    }
                }
            }
        }
    }
    // 0xf57c
    fclose(file);
    goto lab_0xf1cf;
  lab_0xf6e6:
    // 0xf6e6
    strcpy((char *)str8, str9);
    // 0xf257
    return 1;
}

// Address range: 0xf700 - 0xf793
int64_t send_authenticate(int64_t a1, int64_t a2) {
    char * str = (char *)a2; // 0xf70d
    int32_t len = strlen(str); // 0xf70d
    httpd_realloc_str((int64_t)&g125, (int64_t)&g126, (int64_t)len + 35);
    int64_t v1; // 0xf700
    my_snprintf((int64_t *)g125, (int64_t *)g126, "%s%s\"\r\n", (int64_t)"WWW-Authenticate: Basic realm=\"", str, v1);
    int64_t v2 = *(int64_t *)(a1 + 208); // 0xf756
    int64_t result = httpd_send_err(a1, 401, (int64_t)"Unauthorized", g125, (int64_t)"Authorization required for the URL '%.80s'.\n", v2); // 0xf773
    if (*(int32_t *)(a1 + 180) == 3) {
        // 0xf781
        *(int32_t *)(a1 + 556) = 1;
    }
    // 0xf78b
    return result;
}

// Address range: 0xf7a0 - 0xf7ab
int64_t name_compare(int64_t str, int64_t str2) {
    // 0xf7a0
    return strcmp((char *)str, (char *)str2);
}

// Address range: 0xf7b0 - 0xf821
int64_t cgi_kill(int64_t pid, int64_t a2, int64_t a3, int64_t a4, int64_t a5) {
    int32_t result = kill((int32_t)pid, SIGINT); // 0xf7bf
    if (result != 0) {
        // 0xf7fc
        return result;
    }
    // 0xf7c8
    syslog(LOG_WARNING, "killed CGI process %d", pid & 0xffffffff);
    int64_t result2 = tmr_create((int32_t)a2, 0xf830, pid, (int64_t)&g13, 0); // 0xf7f2
    if (result2 != 0) {
        // 0xf7fc
        return result2;
    }
    // 0xf804
    syslog(LOG_CRIT, "tmr_create(cgi_kill2) failed");
    exit(1);
    // UNREACHABLE
}

// Address range: 0xf830 - 0xf85a
int64_t cgi_kill2(int64_t pid) {
    int32_t result = kill((int32_t)pid, SIGKILL); // 0xf839
    if (result != 0) {
        // 0xf842
        return result;
    }
    // 0xf844
    syslog(LOG_WARNING, "hard-killed CGI process %d", pid & 0xffffffff);
    return &g204;
}

// Address range: 0xf860 - 0xfa68
int64_t cgi_interpose_input(int64_t a1, int32_t fd) {
    int64_t v1 = *(int64_t *)(a1 + 168); // 0xf87e
    uint64_t v2 = *(int64_t *)(a1 + 160) - v1; // 0xf885
    int64_t v3; // 0xf860
    int64_t result; // 0xf860
    int64_t v4; // 0xf860
    int64_t v5; // 0xf860
    int64_t v6; // 0xf860
    if (v2 != 0) {
        int64_t v7 = *(int64_t *)(a1 + 144) + v1; // 0xf88a
        v3 = 0;
        v5 = 0;
        int64_t v8; // 0xf8bf
        while (true) {
          lab_0xf8b2:;
            int64_t v9 = v5;
            int64_t v10 = v3;
            int32_t v11 = write(fd, (int64_t *)(v7 + v10), (int32_t)(v2 - v10)); // 0xf8bf
            v8 = v11;
            if (v11 < 0) {
                // 0xf8e0
                switch (*__errno_location()) {
                    case 11: {
                        // 0xf8a0
                        sleep(1);
                        v4 = v9;
                        goto lab_0xf8aa;
                    }
                    case 4: {
                        // 0xf8a0
                        sleep(1);
                        v4 = v9;
                        goto lab_0xf8aa;
                    }
                    default: {
                        goto lab_0xf8f1;
                    }
                }
            } else {
                int64_t v12 = v9 + v8 & 0xffffffff; // 0xf8cb
                v4 = v12;
                v6 = v12;
                if (v11 == 0) {
                    goto lab_0xf8f3_2;
                }
                goto lab_0xf8aa;
            }
        }
      lab_0xf8f1:
        // 0xf8f1
        v6 = v8 & 0xffffffff;
      lab_0xf8f3_2:;
        int64_t v13 = 0x100000000 * v6 >> 32; // 0xf8f3
        result = v13;
        if (v2 != v13) {
            // 0xfa56
            return result;
        }
    }
    int64_t * v14 = (int64_t *)(a1 + 496); // 0xf8ff
    uint64_t v15 = *v14; // 0xf8ff
    int32_t * fd2 = (int32_t *)(a1 + 704);
    int64_t v16; // 0xf860
    int64_t v17; // 0xf860
    int64_t v18; // 0xf860
    uint64_t v19; // 0xf939
    if (v15 > v2) {
        // 0xf920
        int64_t v20; // bp-1096, 0xf860
        int64_t v21 = (int64_t)&v20 + 16;
        uint64_t v22 = v15; // 0xf962
        int64_t v23 = v2;
        while (true) {
            int64_t v24 = v23;
            uint64_t v25 = v22 - v24; // 0xf928
            int32_t nbyte = v25 >= (int64_t)&g195 ? (int32_t)&g195 : (int32_t)v25; // 0xf939
            int64_t buf; // bp-1080, 0xf860
            int32_t v26 = read(*fd2, &buf, nbyte); // 0xf939
            int64_t v27; // 0xf860
            if (v26 >= 0) {
                // 0xf974
                v19 = (int64_t)v26;
                v18 = 0;
                v17 = 0;
                result = 0;
                if (v26 == 0) {
                    // break -> 0xfa56
                    break;
                }
                int64_t v28; // 0xf860
                int64_t v29; // 0xf9b3
                while (true) {
                  lab_0xf9a2:;
                    int64_t v30 = v17;
                    int64_t v31 = v18;
                    int32_t v32 = write(fd, (int64_t *)(v21 + v31), v26 - (int32_t)v31); // 0xf9b3
                    v29 = v32;
                    if (v32 < 0) {
                        // 0xf9d0
                        switch (*__errno_location()) {
                            case 11: {
                                // 0xf990
                                sleep(1);
                                v16 = v30;
                                goto lab_0xf99a;
                            }
                            case 4: {
                                // 0xf990
                                sleep(1);
                                v16 = v30;
                                goto lab_0xf99a;
                            }
                            default: {
                                goto lab_0xf9e1;
                            }
                        }
                    } else {
                        int64_t v33 = v30 + v29 & 0xffffffff; // 0xf9bf
                        v16 = v33;
                        v28 = v33;
                        if (v32 == 0) {
                            goto lab_0xf9e4_2;
                        }
                        goto lab_0xf99a;
                    }
                }
              lab_0xf9e1:
                // 0xf9e1
                v28 = v29 & 0xffffffff;
              lab_0xf9e4_2:;
                int64_t v34 = 0x100000000 * v28 >> 32; // 0xf9e4
                result = v34;
                if (v34 != v19) {
                    // break -> 0xfa56
                    break;
                }
                // 0xf9f7
                v27 = v24 + v19;
            } else {
                uint32_t v35 = *__errno_location(); // 0xf948
                if (v35 != 11 == (v35 != 4)) {
                    // 0xfa56
                    result = v35;
                    return result;
                }
                // 0xf958
                sleep(1);
                v27 = v24;
            }
            // 0xf962
            v23 = v27;
            v22 = *v14;
            if (v22 <= v23) {
                goto lab_0xf9ff;
            }
        }
      lab_0xfa56_2:
        // 0xfa56
        return result;
    }
  lab_0xf9ff:
    // 0xf9ff
    if (g95 == 1) {
        int32_t fd3 = *fd2; // 0xfa08
        int32_t v36 = fcntl(fd3, F_GETFL); // 0xfa1b
        if (v36 != -1 && (v36 || (int32_t)&g202) != v36) {
            // 0xfa31
            fcntl(fd3, F_SETFL);
        }
    }
    // 0xfa56
    int64_t buf2; // bp-1082, 0xf860
    return read(*fd2, &buf2, 2);
  lab_0xf99a:;
    int64_t v37 = 0x100000000 * v16 >> 32; // 0xf99a
    v18 = v37;
    v17 = v16;
    if (v37 >= v19) {
        goto lab_0xf9e4_2;
    }
    goto lab_0xf9a2;
  lab_0xf8aa:;
    int64_t v38 = 0x100000000 * v4 >> 32; // 0xf8aa
    v3 = v38;
    v5 = v4;
    v6 = v4;
    if (v2 <= v38) {
        goto lab_0xf8f3_2;
    }
    goto lab_0xf8b2;
}

// Address range: 0xfa70 - 0x10003
int64_t cgi_interpose_output(int64_t a1, int64_t a2, int64_t a3) {
    int32_t * sock = (int32_t *)(a1 + 704); // 0xfa89
    int32_t fd = *sock; // 0xfa89
    int32_t v1 = fcntl(fd, F_GETFL); // 0xfa9a
    if (v1 != -1 && (v1 & -2049) != v1) {
        // 0xfab0
        fcntl(fd, F_SETFL);
    }
    int64_t v2 = 600; // bp-1088, 0xfabe
    int64_t * mem = malloc(601); // 0xfacc
    char * str = (char *)mem; // bp-1096, 0xfad1
    g96 = &g97;
    g98 += 600;
    if (mem == NULL) {
        // 0xffe1
        syslog(LOG_ERR, "out of memory reallocating a string to %ld bytes", 600);
        exit(1);
        // UNREACHABLE
    }
    // 0xfaf1
    int64_t v3; // bp-1112, 0xfa70
    int64_t v4 = &v3; // 0xfa7a
    int32_t fd2 = a2;
    int64_t v5 = 0; // 0xfaf7
    int64_t v6 = (int64_t)mem; // 0xfaf7
    int64_t v7; // 0xfa70
    int64_t v8; // 0xfa70
    int32_t v9; // 0xfa70
    int64_t v10; // 0xfa70
    char * v11; // 0xfa70
    int64_t buf; // bp-1080, 0xfa70
    int64_t v12; // 0xfb1e
    int64_t v13; // 0xfa70
    while (true) {
        // 0xfafc
        v8 = v6;
        v7 = v5;
        int32_t v14 = read(fd2, &buf, (int32_t)&g195); // 0xfb07
        v9 = v14;
        if (v14 <= -1) {
            int32_t * v15 = __errno_location(); // 0xfb90
            while (true) {
              lab_0xfbc5:;
                uint32_t v16 = *v15; // 0xfbc5
                switch (v16) {
                    case 11: {
                        goto lab_0xfba0;
                    }
                    case 4: {
                        goto lab_0xfba0;
                    }
                    default: {
                        // 0xfbd1
                        v10 = v16;
                        goto lab_0xfbd1_2;
                    }
                }
            }
        }
      lab_0xfb13:;
        int32_t v17 = v9;
        v10 = 0;
        if (v17 == 0) {
            // break -> 0xfbd1
            break;
        }
        // 0xfb1b
        v12 = v7 + (int64_t)v17;
        httpd_realloc_str((int64_t)&str, (int64_t)&v2, v12);
        v13 = (int64_t)str;
        memcpy((int64_t *)(v7 + v13), &buf, v17);
        *(char *)(v12 + v13) = 0;
        char * substr_pos = strstr(str, "\r\n\r\n"); // 0xfb59
        v11 = substr_pos;
        if (substr_pos != NULL) {
            goto lab_0xfcdc_2;
        }
        char * substr_pos2 = strstr(str, "\n\n"); // 0xfb71
        v5 = v12;
        v6 = v13;
        v11 = substr_pos2;
        if (substr_pos2 != NULL) {
            goto lab_0xfcdc_2;
        }
    }
    goto lab_0xfbd1_2;
  lab_0xfcdc_2:;
    int64_t v63 = (int64_t)v11;
    char * v19 = str; // 0xfce6
    int64_t v20 = v63; // 0xfce6
    int64_t v21 = v12; // 0xfce6
    int64_t v22 = v13; // 0xfce6
    int64_t result = v63; // 0xfce6
    if (*str == 0) {
        // 0xfcec
        return result;
    }
    goto lab_0xfbdf;
  lab_0xff2a:;
    // 0xff2a
    int64_t v60; // 0xfa70
    int64_t v64 = 0x100000000 * v60 >> 32; // 0xff2a
    int64_t v52 = v64; // 0xff30
    int64_t v53 = v60; // 0xff30
    uint64_t v51; // 0xfee7
    if (v64 >= v51) {
        goto lab_0xff80_2;
    }
    goto lab_0xff32;
  lab_0xfe8a:;
    // 0xfe8a
    int64_t v49; // 0xfa70
    int64_t v65 = 0x100000000 * v49 >> 32; // 0xfe8a
    int64_t v44 = v65; // 0xfe90
    int64_t v45 = v49; // 0xfe90
    uint64_t v24; // 0xfa70
    if (v24 <= v65) {
        // break -> 0xfeda
        goto lab_0xfeda_4;
    }
    goto lab_0xfe92;
  lab_0xfe1a:;
    // 0xfe1a
    int64_t v43; // 0xfa70
    int64_t v66 = 0x100000000 * v43 >> 32; // 0xfe1a
    int64_t v38 = v66; // 0xfe20
    int64_t v39 = v43; // 0xfe20
    uint64_t v36; // 0xfdfd
    if (v66 >= v36) {
        // break -> 0xfe61
        goto lab_0xfe61_2;
    }
    goto lab_0xfe22;
  lab_0xfba0:
    // 0xfba0
    sleep(1);
    int32_t v67 = read(fd2, &buf, (int32_t)&g195); // 0xfbb5
    v9 = v67;
    if (v67 > -1) {
        // break -> 0xfb13
        goto lab_0xfb13;
    }
    goto lab_0xfbc5;
  lab_0xfbd1_2:;
    char * v18 = (char *)v8;
    v19 = v18;
    v20 = v8 + v7;
    v21 = v7;
    v22 = v8;
    result = v10;
    if (*v18 == 0) {
        // 0xfcec
        return result;
    }
    goto lab_0xfbdf;
  lab_0xfbdf:;
    int64_t v23 = v22;
    v24 = v21;
    char * str2 = v19;
    int64_t str_as_l = 200; // 0xfbfb
    if (strncmp(str2, "HTTP/", 5) == 0) {
        int32_t ini_seg_bytes = strcspn(str2, " \t"); // 0xfc07
        str_as_l = strtol((char *)(v23 + (int64_t)ini_seg_bytes), (char **)((int32_t)" \t" ^ (int32_t)" \t"), 10);
    }
    char * substr_pos3 = strstr(str2, "Location:"); // 0xfc29
    uint64_t v25 = (int64_t)substr_pos3; // 0xfc29
    int64_t v26 = str_as_l; // 0xfc31
    if (substr_pos3 == NULL || v20 <= v25) {
        goto lab_0xfc49;
    } else {
        if (v23 == v25) {
            // 0xfc43
            v26 = 302;
            goto lab_0xfc49;
        } else {
            // 0xfc3d
            if (*(char *)(v25 - 1) != 10) {
                goto lab_0xfc49;
            } else {
                // 0xfc43
                v26 = 302;
                goto lab_0xfc49;
            }
        }
    }
  lab_0xfc49:;
    int64_t v27 = v26;
    char * substr_pos4 = strstr(str2, "Status:"); // 0xfc53
    uint64_t v28 = (int64_t)substr_pos4; // 0xfc53
    int64_t str_as_l2 = v27; // 0xfc5b
    if (substr_pos4 == NULL || v20 <= v28) {
        goto lab_0xfc97;
    } else {
        if (v23 == v28) {
            goto lab_0xfc70;
        } else {
            // 0xfc6a
            str_as_l2 = v27;
            if (*(char *)(v28 - 1) != 10) {
                goto lab_0xfc97;
            } else {
                goto lab_0xfc70;
            }
        }
    }
  lab_0xfc97:;
    int64_t v29 = str_as_l2;
    int32_t v30 = v29; // 0xfc9e
    int64_t v31; // 0xfa70
    if (v30 < 400) {
        // 0xfcfe
        v31 = (int64_t)"OK";
        switch (v30) {
            case 200: {
                goto lab_0xfdd1;
            }
            case 302: {
                // 0xfda3
                v31 = (int64_t)"Found";
                goto lab_0xfdd1;
            }
            default: {
                // 0xfd18
                v31 = (int64_t)"Not Modified";
                if (v30 != 304) {
                    // 0xfdc7
                    v31 = (int64_t)"Something";
                    goto lab_0xfdd1;
                } else {
                    goto lab_0xfdd1;
                }
            }
        }
    } else {
        if (v30 > 499) {
            // 0xfd34
            v31 = (int64_t)"Internal Error";
            switch (v30) {
                case 500: {
                    goto lab_0xfdd1;
                }
                case 501: {
                    // 0xfdbb
                    v31 = (int64_t)"Not Implemented";
                    goto lab_0xfdd1;
                }
                default: {
                    if (v30 != 503) {
                        // 0xfdc7
                        v31 = (int64_t)"Something";
                        goto lab_0xfdd1;
                    } else {
                        // 0xfd4f
                        v31 = *(int64_t *)&g27;
                        goto lab_0xfdd1;
                    }
                }
            }
        } else {
            int64_t v32 = v29 + 0xfffffe70; // 0xfcad
            if ((int32_t)v32 < 52) {
                int32_t v33 = *(int32_t *)((4 * v32 & 0x3fffffffc) + (int64_t)&g7); // 0xfcc4
                return (int64_t)v33 + (int64_t)&g7;
            }
            // 0xfdc7
            v31 = (int64_t)"Something";
            goto lab_0xfdd1;
        }
    }
  lab_0xfc70:;
    int64_t str3 = v28 + 7;
    int32_t ini_seg_bytes2 = strspn((char *)str3, " \t"); // 0xfc7b
    str_as_l2 = strtol((char *)(str3 + (int64_t)ini_seg_bytes2), (char **)((int32_t)" \t" ^ (int32_t)" \t"), 10);
    goto lab_0xfc97;
  lab_0xfdd1:;
    // 0xfdd1
    int64_t v34; // 0xfa70
    my_snprintf(&buf, (int64_t *)&g195, "HTTP/1.0 %d %s\r\n", v29, (char *)v31, v34);
    int32_t fd3 = *sock; // 0xfdf4
    int32_t len = strlen((char *)&buf); // 0xfdfd
    int32_t v35 = fd3; // 0xfe05
    if (len != 0) {
        // 0xfe22
        v36 = (int64_t)len;
        int64_t v37 = v4 + 32; // 0xfe22
        v38 = 0;
        v39 = 0;
        while (true) {
          lab_0xfe22:;
            int64_t v40 = v39;
            int64_t v41 = v38;
            int32_t v42 = write(fd3, (int64_t *)(v37 + v41), len - (int32_t)v41); // 0xfe32
            if (v42 < 0) {
                // 0xfe50
                switch (*__errno_location()) {
                    case 11: {
                        // 0xfe10
                        sleep(1);
                        v43 = v40;
                        goto lab_0xfe1a;
                    }
                    case 4: {
                        // 0xfe10
                        sleep(1);
                        v43 = v40;
                        goto lab_0xfe1a;
                    }
                    default: {
                        goto lab_0xfe61_2;
                    }
                }
            } else {
                if (v42 == 0) {
                    // break -> 0xfe61
                    break;
                }
                // 0xfe3d
                v43 = v40 + (int64_t)v42 & 0xffffffff;
                goto lab_0xfe1a;
            }
        }
      lab_0xfe61_2:
        // 0xfe61
        v35 = *sock;
    }
    int32_t fd4 = v35;
    v44 = 0;
    v45 = 0;
    if (v24 != 0) {
        while (true) {
          lab_0xfe92:;
            int64_t v46 = v45;
            int64_t v47 = v44;
            int32_t v48 = write(fd4, (int64_t *)(v47 + v23), (int32_t)(v24 - v47)); // 0xfe9e
            if (v48 < 0) {
                // 0xfeb0
                switch (*__errno_location()) {
                    case 11: {
                        // 0xfe80
                        sleep(1);
                        v49 = v46;
                        goto lab_0xfe8a;
                    }
                    case 4: {
                        // 0xfe80
                        sleep(1);
                        v49 = v46;
                        goto lab_0xfe8a;
                    }
                    default: {
                        goto lab_0xfeda_4;
                    }
                }
            } else {
                if (v48 == 0) {
                    // break -> 0xfeda
                    break;
                }
                // 0xfea9
                v49 = v46 + (int64_t)v48 & 0xffffffff;
                goto lab_0xfe8a;
            }
        }
    }
  lab_0xfeda_4:
    // 0xfeda
    while (true) {
      lab_0xfeda_2:;
        int32_t v50 = read(fd2, &buf, (int32_t)&g195); // 0xfee7
        if (v50 < 0) {
            // 0xff90
            switch (*__errno_location()) {
                case 11: {
                    // 0xfed0
                    sleep(1);
                    goto lab_0xfeda_2;
                }
                case 4: {
                    // 0xfed0
                    sleep(1);
                    goto lab_0xfeda_2;
                }
                default: {
                    goto lab_0xffbb;
                }
            }
        } else {
            // 0xfef8
            v51 = (int64_t)v50;
            if (v50 == 0 || (v51 & 0xffffffff) == 0) {
                // break -> 0xffbb
                break;
            }
            int32_t fd5 = *sock; // 0xff10
            v52 = 0;
            v53 = 0;
            int64_t v54; // 0xfa70
            while (true) {
              lab_0xff32:;
                int64_t v55 = v52;
                int32_t v56 = write(fd5, (int64_t *)(v4 + 32 + v55), v50 - (int32_t)v55); // 0xff43
                if (v56 < 0) {
                    int32_t * v57 = __errno_location(); // 0xff60
                    int32_t v58 = *v57; // 0xff65
                    int64_t v59; // 0xfa70
                    switch (v58) {
                        case 11: {
                            // 0xff20
                            sleep(1);
                            v60 = v59;
                            goto lab_0xff2a;
                        }
                        case 4: {
                            // 0xff20
                            sleep(1);
                            v60 = v59;
                            goto lab_0xff2a;
                        }
                        default: {
                            goto lab_0xff71;
                        }
                    }
                } else {
                    int64_t v61 = v53 + (int64_t)v56 & 0xffffffff; // 0xff4f
                    v60 = v61;
                    v54 = v61;
                    if (v56 == 0) {
                        goto lab_0xff80_2;
                    }
                    goto lab_0xff2a;
                }
            }
          lab_0xff71:;
            // 0xff71
            int64_t v62; // 0xff43
            v54 = v62 & 0xffffffff;
          lab_0xff80_2:
            // 0xff80
            if (v50 != (int32_t)v54) {
                // break -> 0xffbb
                break;
            }
            goto lab_0xfeda_2;
        }
    }
  lab_0xffbb:
    // 0xffbb
    return shutdown(*sock, SHUT_WR);
}

// Address range: 0x10010 - 0x1009f
int64_t build_env(char * str2, char * str) {
    uint64_t v1 = (int64_t)strlen(str) + (int64_t)strlen(str2); // 0x1002b
    int64_t v2 = g142; // 0x10038
    if (v1 > g142) {
        // 0x1003a
        httpd_realloc_str((int64_t)&g141, (int64_t)&g142, v1);
        v2 = g142;
    }
    // 0x10057
    int64_t v3; // 0x10010
    my_snprintf((int64_t *)g141, (int64_t *)v2, str2, (int64_t)str, (char *)v3, v3);
    char * v4 = strdup(g141); // 0x10072
    if (v4 != NULL) {
        // 0x1007c
        return (int64_t)v4;
    }
    // 0x10082
    syslog(LOG_ERR, "out of memory copying environment variable");
    exit(1);
    // UNREACHABLE
}

// Address range: 0x100a0 - 0x102a0
int64_t fdwatch_get_nfiles(void) {
    // 0x100a0
    int64_t v1; // 0x100a0
    uint64_t v2 = v1;
    g143 = getdtablesize();
    int64_t result; // 0x100a0
    char (**rlp)[4]; // bp-56, 0x100a0
    if (getrlimit(7, (struct rlimit *)&rlp) != 0) {
        // 0x10105
        result = g143;
        goto lab_0x1010c;
    } else {
        uint64_t v3 = (int64_t)rlp; // 0x100c8
        g143 = v3;
        if (v2 == -1) {
            // 0x100e8
            rlp = (char (**)[4])&g185;
        } else {
            if (v2 > v3) {
                // 0x100e2
                rlp = (char (**)[4])v2;
            }
        }
        // 0x100f0
        if (setrlimit(7, (struct rlimit *)&rlp) == 0) {
            int64_t v4 = (int64_t)rlp; // 0x10207
            g143 = v4;
            result = v4 & 0xffffffff;
            goto lab_0x1010c;
        } else {
            // 0x10105
            result = g143;
            goto lab_0x1010c;
        }
    }
  lab_0x1010c:
    // 0x1010c
    g144 = 0;
    int32_t v5 = result;
    int32_t size = 4 * v5;
    int64_t * mem = malloc(size); // 0x10125
    g145 = (int64_t)mem;
    int32_t size2 = 8 * v5; // 0x1013b
    int64_t * mem2 = malloc(size2); // 0x1013b
    g146 = (int64_t)mem2;
    if (mem == NULL || mem2 == NULL) {
        // 0x10293
        return 0xffffffff;
    }
    if (v5 >= 1) {
        // 0x10169
        memset(mem, 255, size);
    }
    int64_t * mem3 = malloc(size2); // 0x10181
    g150 = (struct pollfd *)mem3;
    int64_t * mem4 = malloc(size); // 0x10193
    g151 = (int64_t)mem4;
    int64_t * mem5 = malloc(size); // 0x101a5
    g152 = (int64_t)mem5;
    if (v5 < 1 || mem3 == NULL || mem4 == NULL || mem5 == NULL) {
        // 0x10293
        return !((mem3 == NULL | mem4 == NULL | mem5 == NULL)) ? result : 0xffffffff;
    }
    int64_t v6 = (int64_t)mem3; // 0x10181
    memset(mem4, 255, size);
    int64_t v7 = 0; // 0x10201
    if (result >= 8) {
        int64_t v8 = 0; // 0x1021c
        int64_t v9 = 8 * v8 + v6;
        *(int32_t *)v9 = -1;
        *(int32_t *)(v9 + 8) = -1;
        *(int32_t *)(v9 + 16) = -1;
        *(int32_t *)(v9 + 24) = -1;
        *(int32_t *)(v9 + 32) = -1;
        *(int32_t *)(v9 + 40) = -1;
        *(int32_t *)(v9 + 48) = -1;
        *(int32_t *)(v9 + 56) = -1;
        v8 += 8;
        v7 = v8;
        while ((result & 0xfffffff8) != v8) {
            // 0x10220
            v9 = 8 * v8 + v6;
            *(int32_t *)v9 = -1;
            *(int32_t *)(v9 + 8) = -1;
            *(int32_t *)(v9 + 16) = -1;
            *(int32_t *)(v9 + 24) = -1;
            *(int32_t *)(v9 + 32) = -1;
            *(int32_t *)(v9 + 40) = -1;
            *(int32_t *)(v9 + 48) = -1;
            *(int32_t *)(v9 + 56) = -1;
            v8 += 8;
            v7 = v8;
        }
    }
    uint64_t v10 = result % 8; // 0x101fa
    if (v10 == 0) {
        // 0x10293
        return result;
    }
    int64_t v11 = 0; // 0x1026b
    *(int32_t *)(8 * (v11 + v7) + v6) = -1;
    int64_t v12 = v11 + 1; // 0x10287
    v11 = v12;
    while (v10 != v12) {
        // 0x10280
        *(int32_t *)(8 * (v11 + v7) + v6) = -1;
        v12 = v11 + 1;
        v11 = v12;
    }
    // 0x10293
    return result;
}

// Address range: 0x102a0 - 0x10350
int64_t fdwatch_add_fd(uint32_t a1, uint32_t a2, int32_t a3) {
    int64_t v1 = a1; // 0x102a6
    if (a1 < 0 || g143 <= a1) {
        // 0x102c8
        syslog(LOG_ERR, "bad fd (%d) passed to fdwatch_add_fd!", v1);
        return &g204;
    }
    int64_t v2 = 4 * v1; // 0x102c2
    int32_t * v3 = (int32_t *)(g145 + v2);
    if (*v3 != -1) {
        // 0x102c8
        syslog(LOG_ERR, "bad fd (%d) passed to fdwatch_add_fd!", v1);
        return &g204;
    }
    uint32_t v4 = g154; // 0x102df
    if (g143 <= v4) {
        // 0x10305
        syslog(LOG_ERR, "too many fds in poll_add_fd!");
        // 0x1033d
        *(int32_t *)(g145 + v2) = a3;
        *(int64_t *)(g146 + 8 * v1) = (int64_t)a2;
        return g146;
    }
    int64_t v5 = (int64_t)g150; // 0x102ec
    *(int32_t *)((0x100000000 * (int64_t)v4 >> 29) + v5) = a1;
    if (a3 == 0) {
        // 0x10325
        *(int16_t *)((8 * (int64_t)v4 | 4) + v5) = 1;
        goto lab_0x1032a;
    } else {
        // 0x102fa
        if (a3 != 1) {
            goto lab_0x1032a;
        } else {
            // 0x10325
            *(int16_t *)((8 * (int64_t)v4 | 4) + v5) = 4;
            goto lab_0x1032a;
        }
    }
  lab_0x1032a:
    // 0x1032a
    *(int32_t *)(g151 + v2) = v4;
    g154 = &g155;
    // 0x1033d
    *v3 = a3;
    *(int64_t *)(g146 + 8 * v1) = (int64_t)a2;
    return g146;
}

// Address range: 0x10350 - 0x10401
int64_t fdwatch_del_fd(uint32_t a1) {
    int64_t v1 = a1; // 0x10351
    if (a1 < 0 || g143 <= a1) {
        // 0x103bb
        syslog(LOG_ERR, "bad fd (%d) passed to fdwatch_del_fd!", v1);
        return &g204;
    }
    int64_t v2 = 4 * v1; // 0x1036a
    int32_t * v3 = (int32_t *)(g145 + v2);
    if (*v3 == -1) {
        // 0x103bb
        syslog(LOG_ERR, "bad fd (%d) passed to fdwatch_del_fd!", v1);
        return &g204;
    }
    int32_t * v4 = (int32_t *)(g151 + v2); // 0x10377
    uint32_t v5 = *v4; // 0x10377
    int64_t v6 = v5; // 0x10377
    int32_t * v7; // 0x10350
    if (v5 > -1 == v5 < g143) {
        int32_t v8 = g154; // 0x10382
        g154 = &g153;
        int64_t v9 = (int64_t)g150; // 0x10393
        int64_t v10 = 8 * (int64_t)v8 - 8 + v9; // 0x1039a
        int64_t v11 = *(int64_t *)v10; // 0x1039a
        *(int64_t *)(8 * v6 + v9) = v11;
        *(int32_t *)((0x100000000 * v11 >> 30) + g151) = v5;
        *(int32_t *)v10 = -1;
        *v4 = -1;
        v7 = v3;
    } else {
        // 0x103cf
        syslog(LOG_ERR, "bad idx (%d) in poll_del_fd!", v6);
        v7 = (int32_t *)(g145 + v2);
    }
    // 0x103e9
    *v7 = -1;
    *(int64_t *)(g146 + 8 * v1) = 0;
    return g146;
}

// Address range: 0x10410 - 0x1049d
int64_t fdwatch(int64_t timeout, int64_t a2, int64_t a3, int64_t a4) {
    // 0x10410
    g144++;
    int32_t v1 = poll(g150, g154, (int32_t)timeout); // 0x1042a
    int64_t v2 = v1;
    if (v1 < 1) {
        // 0x10489
        g147 = v2;
        g148 = 0;
        return v2 & 0xffffffff;
    }
    // 0x10433
    if (g154 < 1) {
        int64_t v3 = 0;
        g147 = v3;
        g148 = 0;
        return v3 & 0xffffffff;
    }
    int64_t v4 = 0; // 0x10451
    int64_t v5 = 0;
    int64_t v6 = 8 * v4 + (int64_t)g150;
    int64_t v7 = v5; // 0x1046f
    int64_t v8; // 0x10478
    if ((*(char *)(v6 + 6) & 61) != 0) {
        // 0x10471
        v8 = v5 + 1;
        *(int32_t *)((0x100000000 * v5 >> 30) + g152) = *(int32_t *)v6;
        v7 = v8 & 0xffffffff;
        if (v1 == (int32_t)v8) {
            // break -> 0x10489
            break;
        }
    }
    int64_t v9 = v7;
    v4++;
    int64_t v10 = v9; // 0x10467
    while (v4 != (int64_t)g154) {
        // 0x10469
        v5 = v9;
        v6 = 8 * v4 + (int64_t)g150;
        v7 = v5;
        if ((*(char *)(v6 + 6) & 61) != 0) {
            // 0x10471
            v8 = v5 + 1;
            *(int32_t *)((0x100000000 * v5 >> 30) + g152) = *(int32_t *)v6;
            v7 = v8 & 0xffffffff;
            v10 = v2;
            if (v1 == (int32_t)v8) {
                // break -> 0x10489
                break;
            }
        }
        // 0x10460
        v9 = v7;
        v4++;
        v10 = v9;
    }
    // 0x10489
    g147 = v10;
    g148 = 0;
    return v10 & 0xffffffff;
}

// Address range: 0x104a0 - 0x10525
int64_t fdwatch_check_fd(uint32_t a1) {
    int64_t v1 = a1; // 0x104a1
    int64_t v2 = v1; // 0x104a5
    int64_t format = (int64_t)"bad fd (%d) passed to fdwatch_check_fd!"; // 0x104a5
    if (a1 >= 0) {
        // 0x104a7
        v2 = v1;
        format = (int64_t)"bad fd (%d) passed to fdwatch_check_fd!";
        if (g143 > a1) {
            int64_t v3 = 4 * v1; // 0x104ba
            int32_t v4 = *(int32_t *)(g145 + v3); // 0x104ba
            v2 = v1;
            format = (int64_t)"bad fd (%d) passed to fdwatch_check_fd!";
            if (v4 != -1) {
                uint32_t v5 = *(int32_t *)(g151 + v3); // 0x104c9
                int64_t v6 = v5; // 0x104c9
                v2 = v6;
                format = (int64_t)"bad fdidx (%d) in poll_check_fd!";
                if (v5 > -1 == v5 < g143) {
                    uint16_t v7 = *(int16_t *)((8 * v6 | 6) + (int64_t)g150); // 0x104db
                    if ((v7 & 8) != 0) {
                        // 0x1050a
                        return 0;
                    }
                    int64_t v8 = v7; // 0x104db
                    int64_t v9; // 0x104a0
                    if (v4 == 1) {
                        // 0x1051e
                        v9 = v8 & 52;
                    } else {
                        // 0x104ec
                        v9 = v4 != 0 ? 0 : v8 & 49;
                    }
                    // 0x1050a
                    return v9 & 0xffffffff;
                }
            }
        }
    }
    // 0x10503
    syslog(LOG_ERR, (char *)format, v2);
    // 0x1050a
    return 0;
}

// Address range: 0x10530 - 0x10598
int64_t fdwatch_get_next_client_data(void) {
    uint32_t v1 = g148; // 0x10531
    if (v1 >= g147) {
        // 0x10593
        return -1;
    }
    int64_t v2 = v1; // 0x10531
    g148 = &g149;
    if (v1 < 0 || v1 >= g143) {
        // 0x1057e
        syslog(LOG_ERR, "bad ridx (%d) in poll_get_fd!", v2);
        // 0x10593
        return 0;
    }
    uint32_t v3 = *(int32_t *)(g152 + 4 * v2); // 0x10564
    int64_t result = 0; // 0x1056b
    if (v3 > -1 == v3 < g143) {
        // 0x10571
        result = *(int64_t *)(g146 + 8 * (int64_t)v3);
    }
    // 0x10593
    return result;
}

// Address range: 0x105a0 - 0x105e6
int64_t fdwatch_logstats(uint64_t a1) {
    // 0x105a0
    if (a1 >= 1) {
        int128_t v1 = __asm_divss(__asm_cvtsi2ss((int64_t)g144), __asm_cvtsi2ss(a1)); // 0x105b7
        syslog(LOG_NOTICE, "  fdwatch - %ld %ss (%g/sec)", g144, "poll", (float64_t)(int64_t)__asm_cvtss2sd(v1));
    }
    // 0x105d9
    g144 = 0;
    int64_t result; // 0x105a0
    return result;
}

// Address range: 0x105f0 - 0x10a5c
int64_t mmc_map(int64_t path, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    // 0x105f0
    int64_t v1; // 0x105f0
    int64_t buf; // bp-192, 0x105f0
    if (a2 == 0) {
        int32_t v2 = stat((char *)path, (struct stat *)&buf); // 0x1062d
        v1 = a3;
        if (v2 != 0) {
            // 0x10867
            syslog(LOG_ERR, (char *)(int64_t)"stat - %m");
            // 0x10875
            return 0;
        }
    } else {
        // 0x1060c
        memcpy(&buf, (int64_t *)a2, 144);
        v1 = 144;
    }
    int64_t time_val = v1; // 0x1061e
    if (a3 == 0) {
        // 0x10642
        time_val = time(NULL);
    }
    int64_t v3 = g167; // 0x10649
    int32_t v4; // 0x105f0
    int64_t v5; // 0x105f0
    int64_t v6; // 0x105f0
    int64_t v7; // 0x105f0
    int64_t v8; // 0x105f0
    int64_t v9; // 0x105f0
    if (v3 == 0) {
        // 0x106a2
        g166 = &g195;
        v7 = &g195;
        v5 = &g194;
        goto lab_0x106b7;
    } else {
        int64_t v10 = g166; // 0x1065f
        int32_t v11 = g163; // 0x10665
        if (g166 < 3 * v11) {
            // 0x10678
            free((int64_t *)v3);
            int64_t v12 = 2 * v10; // 0x10690
            int64_t v13 = v12 & 0xfffffffe; // 0x10690
            while (v13 < (int64_t)(6 * v11)) {
                // 0x10690
                v12 = 2 * v13;
                v13 = v12 & 0xfffffffe;
            }
            // 0x10696
            g166 = v12;
            v7 = v13;
            v5 = v12 + 0xffffffff & 0xffffffff;
            goto lab_0x106b7;
        } else {
            // 0x10781
            v4 = g168;
            v9 = v3;
            v8 = v10;
            v6 = g168;
            goto lab_0x10788;
        }
    }
  lab_0x106b7:;
    int32_t v14 = v5;
    g168 = v14;
    uint32_t v15 = (int32_t)v7;
    int32_t size = 8 * v15; // 0x106c5
    int64_t * mem = malloc(size); // 0x106c5
    int64_t v16 = (int64_t)mem; // 0x106c5
    g167 = v16;
    if (mem == NULL) {
        // 0x10867
        syslog(LOG_ERR, (char *)(int64_t)"check_hash_size() failure");
        // 0x10875
        return 0;
    }
    if (v15 >= 1) {
        // 0x106e1
        memset(mem, 0, size);
    }
    int64_t v17 = g161; // 0x106f1
    v4 = v14;
    v9 = v16;
    v8 = v7;
    v6 = v5;
    if (v17 != 0) {
        int64_t v18 = v5 & 0xffffffff;
        int64_t v19 = v17; // 0x1070a
        int32_t v20 = *(int32_t *)(v19 + 8); // 0x1072f
        int32_t v21 = *(int32_t *)(v19 + 16); // 0x10739
        int32_t v22 = *(int32_t *)(v19 + 24); // 0x10743
        uint32_t v23 = (33 * (33 * (33 * (*(int32_t *)v19 ^ 0x2b5a5) ^ v20) ^ v21) ^ v22) & v14; // 0x10746
        int64_t v24 = v23; // 0x10746
        int64_t * v25 = (int64_t *)(8 * v24 + v16);
        int64_t * v26 = v25; // 0x10753
        int64_t v27 = v24; // 0x10753
        int64_t v28; // 0x10767
        int64_t * v29; // 0x105f0
        if (*v25 != 0) {
            // 0x10755
            v28 = v24;
            if (v28 == (v18 & v7 + 0xffffffff + v24)) {
                // 0x10867
                syslog(LOG_ERR, (char *)(int64_t)"check_hash_size() failure");
                // 0x10875
                return 0;
            }
            // 0x10764
            v28 = v18 & v28 + 1;
            v29 = (int64_t *)(8 * v28 + v16);
            v26 = v29;
            v27 = v28;
            while (*v29 != 0) {
                // 0x10760
                if (v28 == (v18 & v7 + 0xffffffff + v24)) {
                    // 0x10867
                    syslog(LOG_ERR, (char *)(int64_t)"check_hash_size() failure");
                    // 0x10875
                    return 0;
                }
                // 0x10764
                v28 = v18 & v28 + 1;
                v29 = (int64_t *)(8 * v28 + v16);
                v26 = v29;
                v27 = v28;
            }
        }
        // 0x10710
        *v26 = v19;
        *(int32_t *)(v19 + 56) = v23;
        *(int32_t *)(v19 + 60) = (int32_t)v27;
        v19 += 64;
        v4 = v14;
        v9 = v16;
        v8 = v7;
        v6 = v5;
        while (v19 != 0) {
            // 0x10723
            v20 = *(int32_t *)(v19 + 8);
            v21 = *(int32_t *)(v19 + 16);
            v22 = *(int32_t *)(v19 + 24);
            v23 = (33 * (33 * (33 * (*(int32_t *)v19 ^ 0x2b5a5) ^ v20) ^ v21) ^ v22) & v14;
            v24 = v23;
            v25 = (int64_t *)(8 * v24 + v16);
            v26 = v25;
            v27 = v24;
            if (*v25 != 0) {
                // 0x10755
                v28 = v24;
                if (v28 == (v18 & v7 + 0xffffffff + v24)) {
                    // 0x10867
                    syslog(LOG_ERR, (char *)(int64_t)"check_hash_size() failure");
                    // 0x10875
                    return 0;
                }
                // 0x10764
                v28 = v18 & v28 + 1;
                v29 = (int64_t *)(8 * v28 + v16);
                v26 = v29;
                v27 = v28;
                while (*v29 != 0) {
                    // 0x10760
                    if (v28 == (v18 & v7 + 0xffffffff + v24)) {
                        // 0x10867
                        syslog(LOG_ERR, (char *)(int64_t)"check_hash_size() failure");
                        // 0x10875
                        return 0;
                    }
                    // 0x10764
                    v28 = v18 & v28 + 1;
                    v29 = (int64_t *)(8 * v28 + v16);
                    v26 = v29;
                    v27 = v28;
                }
            }
            // 0x10710
            *v26 = v19;
            *(int32_t *)(v19 + 56) = v23;
            *(int32_t *)(v19 + 60) = (int32_t)v27;
            v19 += 64;
            v4 = v14;
            v9 = v16;
            v8 = v7;
            v6 = v5;
        }
    }
    goto lab_0x10788;
  lab_0x10788:;
    // 0x10788
    int32_t v30; // 0x105f0
    int64_t v31 = v30; // 0x1078d
    int64_t v32 = v30; // 0x10792
    int64_t v33 = v30; // 0x10797
    uint32_t v34 = (33 * (33 * (33 * (v30 ^ 0x2b5a5) ^ (int32_t)buf) ^ v30) ^ v30) & v4; // 0x107ca
    int64_t v35 = v34; // 0x107ca
    int64_t v36 = *(int64_t *)(8 * v35 + v9); // 0x107cd
    int64_t result; // 0x105f0
    if (v36 != 0) {
        int64_t v37 = v6 & 0xffffffff;
        int64_t v38 = v35; // 0x107eb
        int32_t * v39; // 0x10a46
        if (*(int32_t *)(v36 + 56) == v34) {
            // 0x107f5
            if (*(int64_t *)v36 == v31) {
                // 0x107fa
                if (*(int64_t *)(v36 + 8) == buf) {
                    // 0x10800
                    if (*(int64_t *)(v36 + 16) == v32) {
                        // 0x10806
                        if (*(int64_t *)(v36 + 24) == v33) {
                            // 0x10a46
                            v39 = (int32_t *)(v36 + 32);
                            *v39 = *v39 + 1;
                            *(int64_t *)(v36 + 40) = time_val;
                            result = *(int64_t *)(v36 + 48);
                            goto lab_0x10875;
                        }
                    }
                }
            }
        }
        while (v38 != (v37 & v8 + 0xffffffff + v35)) {
            // 0x10814
            v38 = v37 & v38 + 1;
            int64_t v40 = *(int64_t *)(8 * v38 + v9); // 0x1081a
            if (v40 == 0) {
                // break -> 0x10823
                break;
            }
            int64_t v41 = v40;
            if (*(int32_t *)(v41 + 56) == v34) {
                // 0x107f5
                if (*(int64_t *)v41 == v31) {
                    // 0x107fa
                    if (*(int64_t *)(v41 + 8) == buf) {
                        // 0x10800
                        if (*(int64_t *)(v41 + 16) == v32) {
                            // 0x10806
                            if (*(int64_t *)(v41 + 24) == v33) {
                                // 0x10a46
                                v39 = (int32_t *)(v41 + 32);
                                *v39 = *v39 + 1;
                                *(int64_t *)(v41 + 40) = time_val;
                                result = *(int64_t *)(v41 + 48);
                                goto lab_0x10875;
                            }
                        }
                    }
                }
            }
        }
    }
    int32_t fd = open((char *)path, O_RDONLY); // 0x1082f
    if (fd < 0) {
        // 0x10867
        syslog(LOG_ERR, (char *)(int64_t)"open - %m");
        // 0x10875
        return 0;
    }
    int64_t v42 = g156; // 0x1083b
    int64_t v43; // 0x105f0
    int32_t v44; // 0x105f0
    int64_t v45; // 0x105f0
    if (v42 == 0) {
        int64_t * mem2 = malloc(72); // 0x1088f
        if (mem2 == NULL) {
            // 0x10a32
            close(fd);
            // 0x10867
            syslog(LOG_ERR, (char *)(int64_t)"out of memory allocating a Map");
            // 0x10875
            return 0;
        }
        // 0x1089d
        v43 = (int64_t)mem2;
        v44 = 1;
        v45 = &g160;
    } else {
        // 0x10847
        g156 = *(int64_t *)(v42 + 64);
        v43 = v42;
        v44 = -1;
        v45 = (int64_t)&g157;
    }
    int32_t * v46 = (int32_t *)v45; // 0x108ac
    *v46 = *v46 + v44;
    int64_t * v47 = (int64_t *)v43; // 0x108ae
    *v47 = v31;
    int64_t v48 = v43 + 8; // 0x108b1
    *(int64_t *)v48 = buf;
    int64_t * v49 = (int64_t *)(v43 + 16); // 0x108b5
    *v49 = v32;
    int64_t v50 = v43 + 24; // 0x108b9
    *(int64_t *)v50 = v33;
    *(int32_t *)(v43 + 32) = 1;
    *(int64_t *)(v43 + 40) = time_val;
    if (v30 == 0) {
        // 0x1094b
        *(int64_t *)(v43 + 48) = 1;
        goto lab_0x10953;
    } else {
        int64_t * v51 = mmap(NULL, v30, 1, 2, fd, 0); // 0x108e7
        int64_t * v52 = (int64_t *)(v43 + 48); // 0x108ec
        *v52 = (int64_t)v51;
        if (v51 != (int64_t *)-1) {
            goto lab_0x10953;
        } else {
            // 0x108f6
            if (*__errno_location() != 12) {
                goto lab_0x10929;
            } else {
                // 0x10900
                panic();
                int64_t * v53 = mmap(NULL, v30, 1, 2, fd, 0); // 0x1091a
                *v52 = (int64_t)v53;
                if (v53 != (int64_t *)-1) {
                    goto lab_0x10953;
                } else {
                    goto lab_0x10929;
                }
            }
        }
    }
  lab_0x10953:
    // 0x10953
    close(fd);
    int64_t v54 = *v49; // 0x1095b
    int32_t v55 = *(int32_t *)v43; // 0x10964
    int32_t v56 = *(int32_t *)v48; // 0x1096d
    int32_t v57 = *(int32_t *)v50; // 0x10983
    uint32_t v58 = (33 * (33 * (33 * (v55 ^ 0x2b5a5) ^ v56) ^ (int32_t)v54) ^ v57) & g168; // 0x1098c
    int64_t v59 = v58; // 0x1098c
    int64_t * v60 = (int64_t *)(8 * v59 + g167);
    int64_t * v61 = v60; // 0x1099f
    int64_t v62 = v59; // 0x1099f
    if (*v60 == 0) {
      lab_0x109d6:
        // 0x109d6
        *v61 = v43;
        *(int32_t *)(v43 + 56) = v58;
        *(int32_t *)(v43 + 60) = (int32_t)v62;
        *(int64_t *)(v43 + 64) = g161;
        g161 = v43;
        g163 = &g164;
        g165 += v54;
        // 0x10875
        return *(int64_t *)(v43 + 48);
    }
    int64_t v63 = v59; // 0x109bb
    while ((v58 - 1 + g166 & g168) != (int32_t)v63) {
        int64_t v64 = v63 + 1 & (int64_t)g168;
        int64_t * v65 = (int64_t *)(8 * v64 + g167);
        v63 = v64;
        v61 = v65;
        v62 = v64;
        if (*v65 == 0) {
            goto lab_0x109d6;
        }
    }
    // 0x10a09
    syslog(LOG_ERR, "add_hash() failure");
    // 0x10a1e
    free(v47);
    g160 = &g159;
    // 0x10875
    return 0;
  lab_0x10929:
    // 0x10929
    syslog(LOG_ERR, "mmap - %m", 1);
    close(fd);
    // 0x10a1e
    free(v47);
    g160 = &g159;
    result = 0;
  lab_0x10875:
    // 0x10875
    return result;
}

// Address range: 0x10a60 - 0x10b27
int64_t panic(void) {
    // 0x10a60
    syslog(LOG_ERR, "mmc panic - freeing all unreferenced maps");
    if (g161 == 0) {
        // 0x10b21
        return &g204;
    }
    int64_t v1 = &g161; // 0x10a82
    int64_t * v2; // 0x10a60
    int64_t v3; // 0x10a60
    int64_t result; // 0x10a60
    int64_t * v4; // 0x10ae5
    int64_t * v5; // 0x10a60
    int64_t v6; // 0x10a60
    int64_t v7; // 0x10aa0
    int64_t * v8; // 0x10ab5
    int64_t v9; // 0x10ab5
    if (*(int32_t *)(g161 + 32) != 0) {
        // 0x10aa0
        v7 = g161 + 64;
        v2 = (int64_t *)v7;
        result = &g204;
        v3 = v7;
    } else {
        // 0x10ab5
        v8 = (int64_t *)(g161 + 16);
        v9 = *v8;
        if (v9 != 0) {
            // 0x10abe
            if (munmap((int64_t *)*(int64_t *)(g161 + 48), (int32_t)v9) < 0) {
                // 0x10acb
                syslog(LOG_ERR, "munmap - %m", v6);
            }
        }
        // 0x10ada
        g165 -= *v8;
        v4 = (int64_t *)(g161 + 64);
        v5 = (int64_t *)v1;
        *v5 = *v4;
        g163 = &g162;
        *v4 = g156;
        *(int32_t *)&g157 = (int32_t)&g158;
        g156 = g161;
        *(int64_t *)(8 * (int64_t)*(int32_t *)(g161 + 60) + g167) = 0;
        v2 = v5;
        result = g167;
        v3 = v1;
    }
    int64_t v10 = *v2; // 0x10aa7
    int64_t v11 = result; // 0x10aad
    v1 = v3;
    while (v10 != 0) {
        int64_t v12 = v10;
        if (*(int32_t *)(v12 + 32) != 0) {
            // 0x10aa0
            v7 = v12 + 64;
            v2 = (int64_t *)v7;
            result = v11;
            v3 = v7;
        } else {
            // 0x10ab5
            v8 = (int64_t *)(v12 + 16);
            v9 = *v8;
            if (v9 != 0) {
                // 0x10abe
                if (munmap((int64_t *)*(int64_t *)(v12 + 48), (int32_t)v9) < 0) {
                    // 0x10acb
                    syslog(LOG_ERR, "munmap - %m", v6);
                }
            }
            // 0x10ada
            g165 -= *v8;
            v4 = (int64_t *)(v12 + 64);
            v5 = (int64_t *)v1;
            *v5 = *v4;
            g163 = &g162;
            *v4 = g156;
            *(int32_t *)&g157 = (int32_t)&g158;
            g156 = v12;
            *(int64_t *)(8 * (int64_t)*(int32_t *)(v12 + 60) + g167) = 0;
            v2 = v5;
            result = g167;
            v3 = v1;
        }
        // 0x10aa7
        v10 = *v2;
        v11 = result;
        v1 = v3;
    }
    // 0x10b21
    return result;
}

// Address range: 0x10b30 - 0x10c68
int64_t mmc_unmap(int64_t a1, int64_t a2, int64_t a3) {
    int64_t v1; // 0x10b30
    if (a2 != 0) {
        int64_t v2 = *(int64_t *)(a2 + 8); // 0x10b43
        int64_t v3 = *(int64_t *)(a2 + 48); // 0x10b47
        int64_t v4 = *(int64_t *)(a2 + 104); // 0x10b4b
        uint32_t v5 = (33 * (int32_t)(33 * (33 * (v2 & 0xffffffff ^ 0x2b5a5) ^ a2) ^ v3) ^ (int32_t)v4) & g168; // 0x10b82
        int64_t v6 = v5; // 0x10b82
        int64_t v7 = *(int64_t *)(8 * v6 + g167); // 0x10b8c
        if (v7 != 0) {
            int64_t v8 = v6; // 0x10ba6
            if (*(int32_t *)(v7 + 56) == v5) {
                // 0x10bb5
                if (*(int64_t *)v7 == v2) {
                    // 0x10bba
                    if (*(int64_t *)(v7 + 8) == a2) {
                        // 0x10bc0
                        if (*(int64_t *)(v7 + 16) == v3) {
                            // 0x10bc6
                            if (*(int64_t *)(v7 + 24) == v4) {
                                // 0x10c2c
                                v1 = v7;
                                if (*(int64_t *)(v7 + 48) != a1) {
                                    goto lab_0x10be7;
                                } else {
                                    goto lab_0x10c32;
                                }
                            }
                        }
                    }
                }
            }
            while ((v5 - 1 + g166 & g168) != (int32_t)v8) {
                // 0x10bd4
                v8 = v8 + 1 & (int64_t)g168;
                int64_t v9 = *(int64_t *)(8 * v8 + g167); // 0x10bdc
                if (v9 == 0) {
                    // break -> 0x10be7
                    break;
                }
                int64_t v10 = v9;
                if (*(int32_t *)(v10 + 56) == v5) {
                    // 0x10bb5
                    if (*(int64_t *)v10 == v2) {
                        // 0x10bba
                        if (*(int64_t *)(v10 + 8) == a2) {
                            // 0x10bc0
                            if (*(int64_t *)(v10 + 16) == v3) {
                                // 0x10bc6
                                if (*(int64_t *)(v10 + 24) == v4) {
                                    // 0x10c2c
                                    v1 = v10;
                                    if (*(int64_t *)(v10 + 48) != a1) {
                                        goto lab_0x10be7;
                                    } else {
                                        goto lab_0x10c32;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    goto lab_0x10be7;
  lab_0x10be7:;
    int64_t v11 = g161; // 0x10bf1
    if (g161 == 0) {
        // 0x10c16
        syslog(LOG_ERR, (char *)(int64_t)"mmc_unmap failed to find entry!");
        return &g204;
    }
    v1 = v11;
    while (*(int64_t *)(v11 + 48) != a1) {
        int64_t v12 = *(int64_t *)(v11 + 64); // 0x10c06
        v11 = v12;
        if (v12 == 0) {
            // 0x10c16
            syslog(LOG_ERR, (char *)(int64_t)"mmc_unmap failed to find entry!");
            return &g204;
        }
        v1 = v11;
    }
    goto lab_0x10c32;
  lab_0x10c32:;
    int32_t * v13 = (int32_t *)(v1 + 32); // 0x10c32
    int32_t v14 = *v13; // 0x10c32
    if (v14 < 1) {
        // 0x10c16
        syslog(LOG_ERR, (char *)(int64_t)"mmc_unmap found zero or negative refcount!");
        return &g204;
    }
    // 0x10c39
    *v13 = v14 - 1;
    int64_t time_val = a3; // 0x10c42
    if (a3 == 0) {
        // 0x10c52
        time_val = time(NULL);
    }
    // 0x10c59
    *(int64_t *)(v1 + 40) = time_val;
    return time_val;
}

// Address range: 0x10c70 - 0x10e2d
int64_t mmc_cleanup(int64_t a1) {
    int64_t time_val = a1; // 0x10c7b
    if (a1 == 0) {
        // 0x10c82
        time_val = time(NULL);
    }
    int64_t v1 = g161; // 0x10c96
    int64_t v2 = &g161; // 0x10c96
    int64_t * v3; // 0x10c70
    int64_t v4; // 0x10c70
    int64_t v5; // 0x10c70
    if (g161 != 0) {
        while (true) {
          lab_0x10cc4:
            // 0x10cc4
            v5 = v1;
            if (*(int32_t *)(v5 + 32) != 0) {
                goto lab_0x10cb0;
            } else {
                // 0x10cca
                if (time_val - *(int64_t *)(v5 + 40) < g44) {
                    goto lab_0x10cb0;
                } else {
                    int64_t * v6 = (int64_t *)(v5 + 16); // 0x10cda
                    int64_t v7 = *v6; // 0x10cda
                    if (v7 != 0) {
                        // 0x10ce3
                        if (munmap((int64_t *)*(int64_t *)(v5 + 48), (int32_t)v7) < 0) {
                            // 0x10cf0
                            int64_t v8; // 0x10c70
                            syslog(LOG_ERR, "munmap - %m", v8);
                        }
                    }
                    // 0x10cff
                    g165 -= *v6;
                    int64_t * v9 = (int64_t *)(v5 + 64); // 0x10d0a
                    int64_t * v10 = (int64_t *)v2;
                    *v10 = *v9;
                    g163 = &g162;
                    *v9 = g156;
                    *(int32_t *)&g157 = (int32_t)&g158;
                    g156 = v5;
                    int32_t v11 = *(int32_t *)(v5 + 60); // 0x10d39
                    *(int64_t *)(8 * (int64_t)v11 + g167) = 0;
                    v3 = v10;
                    v4 = v2;
                    goto lab_0x10cb7;
                }
            }
        }
    }
  lab_0x10d4a:;
    // 0x10d4a
    int64_t v12; // 0x10c70
    int64_t result; // 0x10c70
    int64_t v13; // 0x10c70
    if (g165 > 0x3b9aca00) {
        goto lab_0x10d68;
    } else {
        // 0x10d57
        if (g163 < (int32_t)&g193) {
            // 0x10df6
            result = g163;
            if (g163 > 499) {
                goto lab_0x10d9b;
            } else {
                int64_t v14 = 5 * g44; // 0x10e04
                v13 = &g198;
                v12 = v14;
                if (v14 <= (int64_t)&g184) {
                    // 0x10e19
                    v13 = (v14 >= 0 ? v14 : v14 + 3) >> 2;
                    v12 = v14;
                }
                goto lab_0x10d94;
            }
        } else {
            goto lab_0x10d68;
        }
    }
  lab_0x10cb0:;
    int64_t v15 = v5 + 64; // 0x10cb0
    v3 = (int64_t *)v15;
    v4 = v15;
    goto lab_0x10cb7;
  lab_0x10cb7:
    // 0x10cb7
    v1 = *v3;
    v2 = v4;
    if (v1 == 0) {
        // break -> 0x10d4a
        goto lab_0x10d4a;
    }
    goto lab_0x10cc4;
  lab_0x10d68:
    // 0x10d68
    v13 = 60;
    v12 = g44;
    if (g44 >= 92) {
        // 0x10d7a
        v13 = ((int64_t)(0x5555555555555556 * (int128_t)(int64_t)&g197 >> 64) >> 63) + (int64_t)(0x5555555555555556 * (int128_t)(int64_t)&g197 >> 64);
        v12 = 0x5555555555555556 * (int128_t)(int64_t)&g197;
    }
    goto lab_0x10d94;
  lab_0x10d94:
    // 0x10d94
    g44 = v13;
    result = v12;
    goto lab_0x10d9b;
  lab_0x10d9b:
    // 0x10d9b
    if (*(int32_t *)&g157 < 101) {
        // 0x10ded
        return result;
    }
    int64_t v16 = &g158; // 0x10db9
    int64_t v17 = &g159; // 0x10db9
    int64_t v18 = g156; // 0x10db9
    int64_t v19 = *(int64_t *)(v18 + 64); // 0x10dc0
    g156 = v19;
    *(int32_t *)&g157 = (int32_t)v16 - 2;
    free((int64_t *)v18);
    g160 = v17;
    int64_t v20 = v16 + 0xffffffff; // 0x10ddf
    v16 = v20 & 0xffffffff;
    v17 = v17 + 0xffffffff & 0xffffffff;
    v18 = v19;
    while ((int32_t)v20 >= 102) {
        // 0x10dc0
        v19 = *(int64_t *)(v18 + 64);
        g156 = v19;
        *(int32_t *)&g157 = (int32_t)v16 - 2;
        free((int64_t *)v18);
        g160 = v17;
        v20 = v16 + 0xffffffff;
        v16 = v20 & 0xffffffff;
        v17 = v17 + 0xffffffff & 0xffffffff;
        v18 = v19;
    }
    // 0x10ded
    return &g204;
}

// Address range: 0x10e30 - 0x10f38
int64_t mmc_term(void) {
    // 0x10e30
    int64_t v1; // 0x10e30
    int64_t v2; // 0x10e30
    if (g161 == 0) {
        // 0x10eda
        if (g156 == 0) {
            // 0x10f2d
            return 0;
        }
        // 0x10ee6
        v2 = (int64_t)*(int32_t *)&g157;
        v1 = g156;
    } else {
        int64_t v3 = g161;
        int64_t * v4 = (int64_t *)(v3 + 16); // 0x10eb0
        int64_t v5 = *v4; // 0x10eb0
        int64_t v6; // 0x10e30
        if (v5 != 0) {
            // 0x10eb9
            if (munmap((int64_t *)*(int64_t *)(v3 + 48), (int32_t)v5) < 0) {
                // 0x10ec6
                syslog(LOG_ERR, "munmap - %m", v6);
            }
        }
        // 0x10e50
        g165 -= *v4;
        int64_t * v7 = (int64_t *)(v3 + 64); // 0x10e5b
        g163 = &g162;
        g161 = *v7;
        *v7 = g156;
        g156 = v3;
        *(int32_t *)&g157 = (int32_t)&g158;
        int32_t v8 = *(int32_t *)(v3 + 60); // 0x10e95
        *(int64_t *)(8 * (int64_t)v8 + g167) = 0;
        v2 = &g158;
        v1 = v3;
        while (g161 != 0) {
            // 0x10ead
            v3 = g161;
            v4 = (int64_t *)(v3 + 16);
            v5 = *v4;
            if (v5 != 0) {
                // 0x10eb9
                if (munmap((int64_t *)*(int64_t *)(v3 + 48), (int32_t)v5) < 0) {
                    // 0x10ec6
                    syslog(LOG_ERR, "munmap - %m", v6);
                }
            }
            // 0x10e50
            g165 -= *v4;
            v7 = (int64_t *)(v3 + 64);
            g163 = &g162;
            g161 = *v7;
            *v7 = g156;
            g156 = v3;
            *(int32_t *)&g157 = (int32_t)&g158;
            v8 = *(int32_t *)(v3 + 60);
            *(int64_t *)(8 * (int64_t)v8 + g167) = 0;
            v2 = &g158;
            v1 = v3;
        }
    }
    int64_t v9 = &g159; // 0x10ef8
    int64_t v10 = v2 + 0xffffffff;
    int64_t v11 = *(int64_t *)(v1 + 64); // 0x10f00
    g156 = v11;
    *(int32_t *)&g157 = (int32_t)v10;
    free((int64_t *)v1);
    g160 = v9;
    v9 = v9 + 0xffffffff & 0xffffffff;
    int64_t v12 = v10 & 0xffffffff; // 0x10f2b
    while (v11 != 0) {
        int64_t v13 = v11;
        v10 = v12 + 0xffffffff;
        v11 = *(int64_t *)(v13 + 64);
        g156 = v11;
        *(int32_t *)&g157 = (int32_t)v10;
        free((int64_t *)v13);
        g160 = v9;
        v9 = v9 + 0xffffffff & 0xffffffff;
        v12 = v10 & 0xffffffff;
    }
    // 0x10f2d
    return &g204;
}

// Address range: 0x10f40 - 0x10fab
int64_t mmc_logstats(void) {
    uint32_t v1 = *(int32_t *)&g157; // 0x10f54
    syslog(LOG_NOTICE, "  map cache - %d allocated, %d active (%lld bytes), %d free; hash size: %d; expire age: %lld", (int64_t)g160, (int64_t)g163, g165, (int64_t)v1, (int64_t)g166, g44);
    if (g163 + *(int32_t *)&g157 == g160) {
        // 0x10f95
        int64_t result; // 0x10f40
        return result;
    }
    // 0x10f97
    syslog(LOG_ERR, "map counts don't add up!");
    return &g204;
}

// Address range: 0x10fb0 - 0x10fef
int64_t tmr_init(int64_t a1, int64_t a2) {
    // 0x10fb0
    memset(&g169, 0, 536);
    g170 = 0;
    *(int32_t *)&g172 = 0;
    g175 = 0;
    g178 = 0;
    int64_t result; // 0x10fb0
    return result;
}

// Address range: 0x10ff0 - 0x111da
int64_t tmr_create(int32_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5) {
    int64_t v1 = g170; // 0x1100a
    int64_t result; // 0x10ff0
    int32_t v2; // 0x10ff0
    int64_t v3; // 0x10ff0
    if (v1 == 0) {
        int64_t * mem = malloc(72); // 0x11034
        if (mem == NULL) {
            // 0x111c3
            return 0;
        }
        // 0x11042
        result = (int64_t)mem;
        v2 = 1;
        v3 = &g178;
    } else {
        // 0x11016
        g170 = *(int64_t *)(v1 + 56);
        result = v1;
        v2 = -1;
        v3 = (int64_t)&g172;
    }
    int32_t * v4 = (int32_t *)v3; // 0x11051
    *v4 = *v4 + v2;
    *(int64_t *)result = a2;
    *(int64_t *)(result + 8) = a3;
    *(int64_t *)(result + 16) = a4;
    *(int32_t *)(result + 24) = (int32_t)a5;
    int64_t tp = result + 32; // 0x11062
    int64_t v5 = tp; // 0x11062
    int128_t v6; // 0x10ff0
    if (a1 == 0) {
        // 0x11074
        gettimeofday((struct timeval *)tp, NULL);
    } else {
        int128_t v7 = *(int128_t *)&v5; // 0x1106b
        int128_t v8 = __asm_movups_1(v7); // 0x1106b
        __asm_movups(*(int128_t *)(int64_t)v7, v8);
        v6 = v8;
    }
    int128_t v9 = v6;
    int64_t v10 = 0x20c49ba5e353f7cf * (int128_t)a4 >> 127; // 0x11091
    int64_t * v11 = (int64_t *)tp; // 0x110a3
    int64_t v12 = *v11 + v10; // 0x110a3
    *v11 = v12;
    int64_t * v13 = (int64_t *)(result + 40); // 0x110b5
    int64_t v14 = *v13; // 0x110b5
    int64_t v15 = v14 + (a4 - v10 * (int64_t)&g192) * (int64_t)&g192; // 0x110b5
    // 0x110ef
    *v13 = v15;
    int64_t v16 = v15 ^ v12; // 0x110f2
    int64_t v17 = 0xffffffbd * 0x7a44c6b * (v16 & 0xffffffff) / 0x200000000 + v16; // 0x11105
    *(int32_t *)(result + 64) = (int32_t)v17;
    v5 = &g169;
    int64_t * v18 = (int64_t *)((8 * v17 & 0x7fffffff8) + (int64_t)&g169);
    int64_t v19 = *v18; // 0x11111
    if (v19 == 0) {
        // 0x11139
        *v18 = result;
        __asm_movups(*(int128_t *)(result + 48), __asm_xorps(v9, v9));
        // 0x111bc
        g175 = &g176;
        // 0x111c3
        return result;
    }
    int64_t v20 = *(int64_t *)(v19 + 32); // 0x1111a
    if (v12 < v20) {
        goto lab_0x11120;
    } else {
        if (v12 != v20) {
            goto lab_0x1114e;
        } else {
            // 0x11148
            if (v15 > *(int64_t *)(v19 + 40)) {
                goto lab_0x1114e;
            } else {
                goto lab_0x11120;
            }
        }
    }
  lab_0x11120:
    // 0x11120
    *v18 = result;
    *(int64_t *)(result + 48) = 0;
    *(int64_t *)(result + 56) = v19;
    *(int64_t *)(v19 + 48) = result;
    // 0x111bc
    g175 = &g176;
    // 0x111c3
    return result;
  lab_0x1114e:;
    int64_t * v21 = (int64_t *)(v19 + 56);
    int64_t v22 = *v21; // 0x1114e
    int64_t * v23 = v21; // 0x11155
    int64_t v24 = v19; // 0x11155
    int64_t * v25; // 0x10ff0
    int64_t * v26; // 0x10ff0
    int64_t v27; // 0x10ff0
    int64_t v28; // 0x10ff0
    int64_t v29; // 0x10ff0
    if (v22 == 0) {
        goto lab_0x111ac;
    } else {
        int64_t v30 = *(int64_t *)(v22 + 32); // 0x11157
        v25 = v21;
        v27 = v19;
        v28 = v22;
        if (v12 < v30) {
            goto lab_0x11160_2;
        } else {
            int64_t v31 = v22; // 0x1117e
            v5 = v31;
            if (v12 == v30) {
                // 0x11178
                if (v15 <= *(int64_t *)(v31 + 40)) {
                    // 0x11160
                    v25 = (int64_t *)(v19 + 56);
                    v27 = v19;
                    v28 = v31;
                    goto lab_0x11160_2;
                }
            }
            int64_t * v32 = (int64_t *)(v31 + 56);
            int64_t v33 = *v32; // 0x1117e
            v23 = v32;
            v24 = v31;
            while (v33 != 0) {
                int64_t v34 = *(int64_t *)(v33 + 32); // 0x11187
                int64_t v35 = v31; // 0x11191
                v26 = v32;
                v29 = v33;
                if (v12 < v34) {
                    goto lab_0x11193;
                }
                v31 = v33;
                v5 = v31;
                if (v12 == v34) {
                    // 0x11178
                    if (v15 <= *(int64_t *)(v31 + 40)) {
                        // 0x11160
                        v25 = (int64_t *)(v35 + 56);
                        v27 = v35;
                        v28 = v31;
                        goto lab_0x11160_2;
                    }
                }
                // 0x1117e
                v32 = (int64_t *)(v31 + 56);
                v33 = *v32;
                v23 = v32;
                v24 = v31;
            }
            goto lab_0x111ac;
        }
    }
  lab_0x111ac:
    // 0x111ac
    *v23 = result;
    *(int64_t *)(result + 48) = v24;
    *(int64_t *)(result + 56) = 0;
    // 0x111bc
    g175 = &g176;
    // 0x111c3
    return result;
  lab_0x11160_2:
    // 0x11160
    v5 = v27;
    v26 = v25;
    v29 = v28;
  lab_0x11193:
    // 0x11193
    *v26 = result;
    *(int64_t *)(result + 48) = v5;
    *(int64_t *)(result + 56) = v29;
    *(int64_t *)(v29 + 48) = result;
    // 0x111bc
    g175 = &g176;
    // 0x111c3
    return result;
}

// Address range: 0x111e0 - 0x112b0
int64_t tmr_timeout(int64_t a1, int64_t a2) {
    int64_t v1 = 0; // 0x111f9
    int64_t v2 = 0; // 0x111f9
    for (int64_t i = 0; i < 529; i += 8) {
        int64_t v3 = v2;
        int64_t v4 = v1;
        int64_t v5 = *(int64_t *)(i + (int64_t)&g169); // 0x1121a
        int64_t v6 = v4; // 0x11221
        int64_t v7 = v3; // 0x11221
        if (v5 != 0) {
            int64_t v8 = *(int64_t *)(v5 + 40); // 0x11227
            int64_t v9 = *(int64_t *)(a1 + 8); // 0x1122e
            int64_t v10 = (*(int64_t *)(v5 + 32) - a1) * (int64_t)&g192; // 0x11232
            int64_t v11 = v10 | (int64_t)(0x20c49ba5e353f7cf * (int128_t)(v8 - v9) >> 127); // 0x11247
            v6 = 1;
            v7 = v11;
            if ((int32_t)v4 != 0) {
                int64_t v12 = v11 - v3; // 0x11200
                v6 = 1;
                v7 = v12 < 0 == ((v12 ^ v10) & (v10 ^ v3)) < 0 ? v3 : v11;
            }
        }
        // 0x1120d
        v2 = v7;
        v1 = v6;
    }
    int64_t result = 0; // 0x11270
    if ((int32_t)v1 != 0) {
        // 0x11272
        g180 = (v2 > 0 ? v2 : 0) * (int64_t)&g192;
        result = &g179;
    }
    // 0x112af
    return result;
}

// Address range: 0x112b0 - 0x11341
int64_t tmr_mstimeout(int64_t * a1, int64_t a2, int64_t a3, int64_t a4) {
    int64_t v1 = (int64_t)a1;
    int64_t v2 = 0; // 0x112c9
    int64_t v3 = 0; // 0x112c9
    for (int64_t i = 0; i < 529; i += 8) {
        int64_t v4 = v3;
        int64_t v5 = v2;
        int64_t v6 = *(int64_t *)(i + (int64_t)&g169); // 0x112ea
        int64_t v7 = v5; // 0x112f1
        int64_t v8 = v4; // 0x112f1
        if (v6 != 0) {
            int64_t v9 = *(int64_t *)(v6 + 40); // 0x112f7
            int64_t v10 = *(int64_t *)(v1 + 8); // 0x112fe
            int64_t v11 = (*(int64_t *)(v6 + 32) - v1) * (int64_t)&g192; // 0x11302
            int64_t v12 = v11 | (int64_t)(0x20c49ba5e353f7cf * (int128_t)(v9 - v10) >> 127); // 0x11317
            v7 = 1;
            v8 = v12;
            if ((int32_t)v5 != 0) {
                int64_t v13 = v12 - v4; // 0x112d0
                v7 = 1;
                v8 = v13 < 0 == ((v13 ^ v11) & (v11 ^ v4)) < 0 ? v4 : v12;
            }
        }
        // 0x112dd
        v3 = v8;
        v2 = v7;
    }
    // 0x1132d
    return (int32_t)v2 == 0 ? -1 : v3 >= 0 ? v3 : 0;
}

// Address range: 0x11350 - 0x114c4
int64_t tmr_run(int64_t * a1) {
    int64_t v1 = (int64_t)a1;
    int64_t v2 = v1; // 0x11375
    int64_t v3 = 0; // 0x11375
    int64_t result; // 0x11350
    int64_t v4; // 0x11350
    int64_t v5; // 0x11350
    int64_t v6; // 0x11350
    int64_t v7; // 0x11350
    int64_t v8; // 0x11350
    int64_t v9; // 0x11350
    int64_t * v10; // 0x11450
    int64_t * v11; // 0x113b9
    int64_t v12; // 0x113b9
    while (true) {
        int64_t v13 = *(int64_t *)(8 * v3 + (int64_t)&g169); // 0x11395
        result = &g169;
        v7 = v2;
        v5 = v13;
        v9 = v2;
        if (v13 != 0) {
            while (true) {
              lab_0x113b0:;
                int64_t v14 = v9;
                v6 = v5;
                int64_t * v15 = (int64_t *)(v6 + 32); // 0x113b3
                int64_t v16 = *v15; // 0x113b3
                result = v14;
                v7 = v14;
                if (v16 > v14) {
                    // break -> 0x11380
                    break;
                }
                // 0x113b9
                v11 = (int64_t *)(v6 + 56);
                v12 = *v11;
                if (v16 == v14) {
                    int64_t v17 = *(int64_t *)(v6 + 40); // 0x113bf
                    result = v17;
                    v7 = v14;
                    if (v17 > *(int64_t *)(v1 + 8)) {
                        // break -> 0x11380
                        break;
                    }
                }
                // 0x113c9
                if (*(int32_t *)(v6 + 24) == 0) {
                    // 0x11450
                    v10 = (int64_t *)(v6 + 48);
                    int64_t v18 = *v10; // 0x11450
                    int64_t v19; // 0x11350
                    if (v18 == 0) {
                        int32_t v20 = *(int32_t *)(v6 + 64); // 0x1149b
                        *(int64_t *)(8 * (int64_t)v20 + (int64_t)&g169) = v12;
                        v19 = v12;
                        if (v12 != 0) {
                            // 0x1146a
                            *(int64_t *)(v19 + 48) = v18;
                            goto lab_0x1146e;
                        } else {
                            goto lab_0x1146e;
                        }
                    } else {
                        // 0x11459
                        *(int64_t *)(v18 + 56) = v12;
                        int64_t v21 = *v11; // 0x11461
                        v19 = v21;
                        if (v21 == 0) {
                            goto lab_0x1146e;
                        } else {
                            // 0x1146a
                            *(int64_t *)(v19 + 48) = v18;
                            goto lab_0x1146e;
                        }
                    }
                } else {
                    int64_t v22 = *(int64_t *)(v6 + 16); // 0x113d8
                    int64_t v23 = 0x20c49ba5e353f7cf * (int128_t)v22 >> 127; // 0x113e8
                    *v15 = v16 + v23;
                    int64_t * v24 = (int64_t *)(v6 + 40); // 0x1140c
                    int64_t v25 = *v24; // 0x1140c
                    int64_t v26 = (v22 - v23 * (int64_t)&g192) * (int64_t)&g192 + v25; // 0x1140c
                    // 0x113a0
                    *v24 = v26;
                    v4 = l_resort(v6);
                    v8 = v6;
                    goto lab_0x113a8;
                }
            }
        }
      lab_0x11380:
        // 0x11380
        v2 = v7;
        if (v3 == 66) {
            // break -> 0x114b5
            break;
        }
        v3++;
    }
    // 0x114b5
    return result;
  lab_0x113a8:
    // 0x113a8
    result = v4;
    v7 = v8;
    v5 = v12;
    v9 = v8;
    if (v12 == 0) {
        // break -> 0x11380
        goto lab_0x11380;
    }
    goto lab_0x113b0;
  lab_0x1146e:
    // 0x1146e
    g175 = &g174;
    int64_t v27 = g170; // 0x11475
    *v11 = v27;
    g170 = v6;
    *(int32_t *)&g172 = (int32_t)&g173;
    *v10 = 0;
    v4 = v27;
    v8 = *(int64_t *)(v6 + 8);
    goto lab_0x113a8;
}

// Address range: 0x114d0 - 0x115dd
int64_t l_resort(int64_t a1) {
    // 0x114d0
    int128_t v1; // 0x114d0
    int128_t v2 = v1;
    int64_t v3 = a1 + 48; // 0x114d0
    int64_t * v4 = (int64_t *)v3; // 0x114d0
    int64_t v5 = *v4; // 0x114d0
    if (v5 == 0) {
        int32_t v6 = *(int32_t *)(a1 + 64); // 0x1153c
        int64_t v7 = *(int64_t *)(a1 + 56); // 0x11540
        *(int64_t *)(8 * (int64_t)v6 + (int64_t)&g169) = v7;
        if (v7 != 0) {
            // 0x114ea
            *(int64_t *)(v7 + 48) = v5;
            goto lab_0x114ee;
        } else {
            goto lab_0x114ee;
        }
    } else {
        int64_t * v8 = (int64_t *)(a1 + 56); // 0x114d9
        *(int64_t *)(v5 + 56) = *v8;
        int64_t v9 = *v8; // 0x114e1
        if (v9 == 0) {
            goto lab_0x114ee;
        } else {
            // 0x114ea
            *(int64_t *)(v9 + 48) = v5;
            goto lab_0x114ee;
        }
    }
  lab_0x115b3:;
    // 0x115b3
    int64_t * v10; // 0x114d0
    *v10 = a1;
    int64_t v11; // 0x114d0
    *v4 = v11;
    int64_t v12; // 0x114d0
    *(int64_t *)(a1 + 56) = v12;
    *(int64_t *)(v12 + 48) = a1;
    int64_t result; // 0x114d0
    return result;
  lab_0x114ee:;
    int64_t v13 = *(int64_t *)(a1 + 32); // 0x114ee
    uint64_t v14 = *(int64_t *)(a1 + 40); // 0x114f2
    int64_t v15 = v14 ^ v13; // 0x114f9
    int64_t v16 = 0xffffffbd * 0x7a44c6b * (v15 & 0xffffffff) / 0x200000000 + v15; // 0x1150c
    *(int32_t *)(a1 + 64) = (int32_t)v16;
    int64_t * v17 = (int64_t *)((8 * v16 & 0x7fffffff8) + (int64_t)&g169); // 0x11518
    int64_t v18 = *v17; // 0x11518
    if (v18 == 0) {
        // 0x11556
        *v17 = a1;
        __asm_movups(*(int128_t *)v3, __asm_xorps(v2, v2));
        return &g169;
    }
    int64_t v19 = *(int64_t *)(v18 + 32); // 0x11521
    if (v13 < v19) {
        // 0x11527
        *v17 = a1;
        *v4 = 0;
        *(int64_t *)(a1 + 56) = v18;
        *(int64_t *)(v18 + 48) = a1;
        return &g169;
    }
    if (v13 == v19) {
        // 0x11567
        if (v14 <= *(int64_t *)(v18 + 40)) {
            // 0x11527
            *v17 = a1;
            *v4 = 0;
            *(int64_t *)(a1 + 56) = v18;
            *(int64_t *)(v18 + 48) = a1;
            return &g169;
        }
    }
    int64_t * v20 = (int64_t *)(v18 + 56);
    int64_t v21 = *v20; // 0x1156d
    int64_t * v22 = v20; // 0x11574
    int64_t result2 = &g169; // 0x11574
    int64_t v23 = v18; // 0x11574
    if (v21 == 0) {
        goto lab_0x115c7;
    } else {
        int64_t v24 = *(int64_t *)(v21 + 32); // 0x11576
        v10 = v20;
        result = v24;
        v11 = v18;
        v12 = v21;
        if (v13 < v24) {
            goto lab_0x115b3;
        } else {
            int64_t v25 = v21;
            if (v13 == v24) {
                // 0x11598
                if (v14 <= *(int64_t *)(v25 + 40)) {
                    // 0x11598
                    v10 = (int64_t *)(v18 + 56);
                    result = v24;
                    v11 = v18;
                    v12 = v25;
                    goto lab_0x115b3;
                }
            }
            int64_t * v26 = (int64_t *)(v25 + 56);
            int64_t v27 = *v26; // 0x1159e
            v22 = v26;
            result2 = v24;
            v23 = v25;
            while (v27 != 0) {
                int64_t v28 = *(int64_t *)(v27 + 32); // 0x115a7
                int64_t v29 = v25; // 0x115b1
                v10 = v26;
                result = v28;
                v11 = v25;
                v12 = v27;
                if (v13 < v28) {
                    goto lab_0x115b3;
                }
                v25 = v27;
                int64_t v30 = v28;
                if (v13 == v30) {
                    // 0x11598
                    if (v14 <= *(int64_t *)(v25 + 40)) {
                        // 0x11598
                        v10 = (int64_t *)(v29 + 56);
                        result = v30;
                        v11 = v29;
                        v12 = v25;
                        goto lab_0x115b3;
                    }
                }
                // 0x1159e
                v26 = (int64_t *)(v25 + 56);
                v27 = *v26;
                v22 = v26;
                result2 = v30;
                v23 = v25;
            }
            goto lab_0x115c7;
        }
    }
  lab_0x115c7:
    // 0x115c7
    *v22 = a1;
    *v4 = v23;
    *(int64_t *)(a1 + 56) = 0;
    return result2;
}

// Address range: 0x115e0 - 0x11641
int64_t tmr_cancel(int64_t a1) {
    int64_t * v1 = (int64_t *)(a1 + 48); // 0x115e0
    int64_t v2 = *v1; // 0x115e0
    int64_t * v3; // 0x115e0
    int64_t * v4; // 0x115e0
    int64_t v5; // 0x115e0
    if (v2 == 0) {
        int32_t v6 = *(int32_t *)(a1 + 64); // 0x11627
        int64_t * v7 = (int64_t *)(a1 + 56);
        int64_t v8 = *v7; // 0x1162b
        *(int64_t *)(8 * (int64_t)v6 + (int64_t)&g169) = v8;
        v3 = v7;
        v5 = v8;
        v4 = v7;
        if (v8 != 0) {
            goto lab_0x115fa;
        } else {
            goto lab_0x115fe;
        }
    } else {
        int64_t * v9 = (int64_t *)(a1 + 56);
        *(int64_t *)(v2 + 56) = *v9;
        int64_t v10 = *v9; // 0x115f1
        v3 = v9;
        v5 = v10;
        v4 = v9;
        if (v10 == 0) {
            goto lab_0x115fe;
        } else {
            goto lab_0x115fa;
        }
    }
  lab_0x115fa:
    // 0x115fa
    *(int64_t *)(v5 + 48) = v2;
    v4 = v3;
    goto lab_0x115fe;
  lab_0x115fe:
    // 0x115fe
    g175 = &g174;
    int64_t result = g170; // 0x11605
    *v4 = result;
    g170 = a1;
    *(int32_t *)&g172 = (int32_t)&g173;
    *v1 = 0;
    return result;
}

// Address range: 0x11650 - 0x116d7
int64_t tmr_reset(int64_t a1, int64_t a2) {
    // 0x11650
    int64_t v1; // 0x11650
    int128_t v2 = __asm_movups_1(*(int128_t *)&v1); // 0x11650
    int64_t v3 = a2 + 32; // 0x11653
    __asm_movups(*(int128_t *)v3, v2);
    int64_t v4 = *(int64_t *)(a2 + 16); // 0x11657
    int64_t v5 = 0x20c49ba5e353f7cf * (int128_t)v4 >> 127; // 0x11671
    int64_t * v6 = (int64_t *)v3; // 0x11683
    *v6 = *v6 + v5;
    int64_t * v7 = (int64_t *)(a2 + 40); // 0x11695
    int64_t v8 = *v7; // 0x11695
    int64_t v9 = (v4 - v5 * (int64_t)&g192) * (int64_t)&g192 + v8; // 0x11695
    v1 = v9;
    *v7 = v9;
    if (v9 >= 0xf4240) {
        // 0x116a6
        *v7 = v1;
    }
    // 0x116cf
    return l_resort(a2);
}

// Address range: 0x116e0 - 0x1173f
int64_t tmr_cleanup(void) {
    int64_t v1 = &g177; // 0x116ee
    int64_t v2 = &g171; // 0x116ee
    if (g170 == 0) {
        // 0x1173a
        int64_t result; // 0x116e0
        return result;
    }
    int64_t v3 = g170;
    int64_t v4 = *(int64_t *)(v3 + 56); // 0x11710
    g170 = v4;
    *(int32_t *)&g172 = (int32_t)v2;
    free((int64_t *)v3);
    g178 = v1;
    v1 = v1 + 0xffffffff & 0xffffffff;
    v2 = v2 + 0xffffffff & 0xffffffff;
    while (v4 != 0) {
        // 0x11710
        v3 = v4;
        v4 = *(int64_t *)(v3 + 56);
        g170 = v4;
        *(int32_t *)&g172 = (int32_t)v2;
        free((int64_t *)v3);
        g178 = v1;
        v1 = v1 + 0xffffffff & 0xffffffff;
        v2 = v2 + 0xffffffff & 0xffffffff;
    }
    // 0x1173a
    return &g204;
}

// Address range: 0x11740 - 0x1183f
int64_t tmr_term(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {
    int64_t result = (uint32_t)g175; // 0x11761
    int64_t v1 = (int64_t)*(int32_t *)&g172; // 0x11761
    int64_t v2 = g170; // 0x11761
    int64_t * v3; // 0x11740
    int64_t * v4; // 0x11740
    int64_t v5; // 0x11740
    int64_t v6; // 0x11740
    int64_t v7; // 0x11740
    int64_t v8; // 0x11740
    int64_t v9; // 0x11740
    int64_t v10; // 0x117a0
    int64_t v11; // 0x117a7
    int64_t * v12; // 0x11790
    int64_t * v13; // 0x117c1
    int64_t v14; // 0x117c1
    for (int64_t i = 0; i < 67; i++) {
        // 0x11790
        v12 = (int64_t *)(8 * i + (int64_t)&g169);
        int64_t v15 = *v12; // 0x11790
        v5 = result;
        v6 = v1;
        int64_t v16 = v15; // 0x11797
        v7 = v2;
        if (v15 != 0) {
            while (true) {
                // 0x117be
                v8 = v16;
                v13 = (int64_t *)(v8 + 48);
                v14 = *v13;
                if (v14 == 0) {
                    int32_t v17 = *(int32_t *)(v8 + 64); // 0x117e0
                    int64_t * v18 = (int64_t *)(v8 + 56);
                    int64_t v19 = *v18; // 0x117e4
                    *(int64_t *)(8 * (int64_t)v17 + (int64_t)&g169) = v19;
                    v4 = v18;
                    v3 = v18;
                    v9 = v19;
                    if (v19 == 0) {
                        goto lab_0x117a0;
                    } else {
                        goto lab_0x117f1;
                    }
                } else {
                    int64_t * v20 = (int64_t *)(v8 + 56);
                    *(int64_t *)(v14 + 56) = *v20;
                    int64_t v21 = *v20; // 0x117d2
                    v4 = v20;
                    v3 = v20;
                    v9 = v21;
                    if (v21 != 0) {
                        goto lab_0x117f1;
                    } else {
                        goto lab_0x117a0;
                    }
                }
            }
            // 0x11770
            g175 = v10;
            g170 = v8;
            *(int32_t *)&g172 = (int32_t)v11;
            int64_t v22; // 0x117a0
            int64_t v23 = v22; // 0x11783
            int64_t v24; // 0x117a7
            int64_t v25 = v24; // 0x11783
            int64_t v26 = v8; // 0x11783
        }
    }
    int64_t v27 = &g177; // 0x117fa
    if (v2 == 0) {
        // 0x1183a
        return result;
    }
    int64_t v28 = v1 + 0xffffffff;
    int64_t v29 = *(int64_t *)(v2 + 56); // 0x11810
    g170 = v29;
    *(int32_t *)&g172 = (int32_t)v28;
    free((int64_t *)v2);
    g178 = v27;
    int64_t v30 = v28 & 0xffffffff; // 0x11838
    v27 = v27 + 0xffffffff & 0xffffffff;
    while (v29 != 0) {
        int64_t v31 = v29;
        v28 = v30 + 0xffffffff;
        v29 = *(int64_t *)(v31 + 56);
        g170 = v29;
        *(int32_t *)&g172 = (int32_t)v28;
        free((int64_t *)v31);
        g178 = v27;
        v30 = v28 & 0xffffffff;
        v27 = v27 + 0xffffffff & 0xffffffff;
    }
    // 0x1183a
    return &g204;
  lab_0x117a0:
    // 0x117a0
    v10 = v5 + 0xffffffff;
    *v4 = v7;
    v11 = v6 + 1;
    *v13 = 0;
    int64_t v32 = *v12; // 0x117b2
    v5 = v10 & 0xffffffff;
    v6 = v11 & 0xffffffff;
    v7 = v8;
    if (v32 == 0) {
        // break -> 0x11770
        goto lab_0x11770;
    }
    goto lab_0x117be;
  lab_0x117f1:
    // 0x117f1
    *(int64_t *)(v9 + 48) = v14;
    v4 = v3;
    goto lab_0x117a0;
}

// Address range: 0x11840 - 0x11891
int64_t tmr_logstats(void) {
    uint32_t v1 = *(int32_t *)&g172; // 0x1184d
    syslog(LOG_NOTICE, "  timers - %d allocated, %d active, %d free", (int64_t)g178, (int64_t)g175, (int64_t)v1);
    if (g175 + *(int32_t *)&g172 == g178) {
        // 0x1187b
        int64_t result; // 0x11840
        return result;
    }
    // 0x1187d
    syslog(LOG_ERR, "timer counts don't add up!");
    return &g204;
}

// Address range: 0x118a0 - 0x11912
int64_t match(int64_t a1, int64_t a2) {
    char * str = (char *)a1;
    char * found_char_pos = strchr(str, 124); // 0x118b0
    int64_t v1 = a1; // 0x118b8
    int32_t len; // 0x118f3
    if (found_char_pos == NULL) {
        // 0x118f0
        len = strlen(str);
        return match_one(a1, len, a2);
    }
    int64_t v2 = (int64_t)found_char_pos;
    while ((int32_t)match_one(v1, (int32_t)v2 - (int32_t)v1, a2) == 0) {
        // 0x118d4
        v1 = v2 + 1;
        char * str2 = (char *)v1;
        char * found_char_pos2 = strchr(str2, 124); // 0x118e3
        char * str3 = str2; // 0x118ee
        int64_t v3 = v1; // 0x118ee
        if (found_char_pos2 == NULL) {
            // 0x118f0
            len = strlen(str3);
            return match_one(v3, len, a2);
        }
        v2 = (int64_t)found_char_pos2;
    }
    // 0x11907
    return 1;
}

// Address range: 0x11920 - 0x11a09
int64_t match_one(int64_t a1, int32_t a2, int64_t a3) {
    // 0x11920
    if (a2 < 1) {
        // 0x11989
        return *(char *)a3 == 0;
    }
    uint64_t v1 = (int64_t)a2;
    int64_t v2 = 0;
    int64_t v3 = a1 + 1;
    char v4 = *(char *)a1; // 0x11964
    int64_t result; // 0x11920
    int64_t v5; // 0x11920
    int64_t v6; // 0x11920
    int32_t ini_seg_bytes; // 0x11920
    int32_t v7; // 0x119e7
    int64_t str; // 0x1199b
    switch (v4) {
        case 63: {
            // 0x11950
            if (*(char *)(v2 + a3) == 0) {
                // 0x11989
                return 0;
            }
            // break -> 0x11957
            break;
        }
        case 42: {
            // 0x1199b
            str = v2 + a3;
            if (*(char *)v3 != 42) {
                // 0x119b1
                v6 = v3;
                ini_seg_bytes = strcspn((char *)str, "/");
            } else {
                // 0x119a3
                v6 = a1 + 2;
                ini_seg_bytes = strlen((char *)str);
            }
            // 0x119c0
            if (ini_seg_bytes <= -1) {
                // 0x11989
                return 0;
            }
            // 0x119ca
            v7 = (int32_t)(a1 - v6) + a2;
            v5 = ini_seg_bytes;
            result = 1;
            while ((int32_t)match_one(v6, v7, v5 + str) == 0) {
                // 0x119f3
                result = 0;
                if (v5 >= 0 != v5 != 0) {
                    // break -> 0x11989
                    break;
                }
                v5--;
                result = 1;
            }
            // 0x11989
            return result;
        }
        default: {
            // 0x11970
            if (*(char *)(v2 + a3) != v4) {
                // 0x11989
                return 0;
            }
            // break -> 0x11957
            break;
        }
    }
    int64_t v8 = v2 + 1; // 0x1195b
    while (v8 < v1) {
        int64_t v9 = v3;
        v2 = v8;
        v3 = v9 + 1;
        v4 = *(char *)v9;
        switch (v4) {
            case 63: {
                // 0x11950
                if (*(char *)(v2 + a3) == 0) {
                    // 0x11989
                    return 0;
                }
                // break -> 0x11957
                break;
            }
            case 42: {
                // 0x1199b
                str = v2 + a3;
                if (*(char *)v3 != 42) {
                    // 0x119b1
                    v6 = v3;
                    ini_seg_bytes = strcspn((char *)str, "/");
                } else {
                    // 0x119a3
                    v6 = v9 + 2;
                    ini_seg_bytes = strlen((char *)str);
                }
                // 0x119c0
                if (ini_seg_bytes <= -1) {
                    // 0x11989
                    return 0;
                }
                // 0x119ca
                v7 = (int32_t)(a1 - v6) + a2;
                v5 = ini_seg_bytes;
                result = 1;
                while ((int32_t)match_one(v6, v7, v5 + str) == 0) {
                    // 0x119f3
                    result = 0;
                    if (v5 >= 0 != v5 != 0) {
                        // break -> 0x11989
                        break;
                    }
                    v5--;
                    result = 1;
                }
                // 0x11989
                return result;
            }
            default: {
                // 0x11970
                if (*(char *)(v2 + a3) != v4) {
                    // 0x11989
                    return 0;
                }
                // break -> 0x11957
                break;
            }
        }
        // 0x11957
        v8 = v2 + 1;
    }
    // 0x11989
    return *(char *)(v1 + a3) == 0;
}

// Address range: 0x11a10 - 0x11d93
int64_t tdate_parse(int64_t a1) {
    int64_t v1 = a1; // 0x11a24
    char * str; // 0x11a10
    while (true) {
      lab_0x11a34:;
        int64_t v2 = v1;
        str = (char *)v2;
        switch (*str) {
            case 32: {
                // 0x11a30
                v1 = v2 + 1;
                goto lab_0x11a34;
            }
            case 9: {
                // 0x11a30
                v1 = v2 + 1;
                goto lab_0x11a34;
            }
            default: {
                goto lab_0x11a3f;
            }
        }
    }
  lab_0x11a3f:;
    // 0x11a3f
    int64_t v3; // bp-1064, 0x11a10
    int64_t v4; // bp-1076, 0x11a10
    int64_t v5; // bp-1080, 0x11a10
    int64_t v6; // bp-1092, 0x11a10
    int64_t v7; // bp-1096, 0x11a10
    int64_t v8; // bp-1100, 0x11a10
    int32_t items_assigned = sscanf(str, "%d-%400[a-zA-Z]-%d %d:%d:%d GMT", &v8, &v3, &v6, &v7, &v5, &v4); // 0x11a6c
    int64_t v9; // bp-1088, 0x11a10
    if (items_assigned != 6) {
        goto lab_0x11a91;
    } else {
        // 0x11a7a
        if ((int32_t)scan_mon(&v3, &v9) != 0) {
            goto lab_0x11cbd;
        } else {
            goto lab_0x11a91;
        }
    }
  lab_0x11a91:;
    int32_t items_assigned2 = sscanf(str, "%d %400[a-zA-Z] %d %d:%d:%d GMT", &v8, &v3, &v6, &v7, &v5, &v4); // 0x11aba
    if (items_assigned2 != 6) {
        goto lab_0x11adf;
    } else {
        // 0x11ac8
        if ((int32_t)scan_mon(&v3, &v9) != 0) {
            goto lab_0x11cbd;
        } else {
            goto lab_0x11adf;
        }
    }
  lab_0x11adf:;
    int32_t items_assigned3 = sscanf(str, "%d:%d:%d GMT %d-%400[a-zA-Z]-%d", &v7, &v5, &v4, &v8, &v3, &v6); // 0x11b03
    if (items_assigned3 != 6) {
        goto lab_0x11b28;
    } else {
        // 0x11b11
        if ((int32_t)scan_mon(&v3, &v9) != 0) {
            goto lab_0x11cbd;
        } else {
            goto lab_0x11b28;
        }
    }
  lab_0x11cbd:;
    // 0x11cbd
    int64_t v10; // bp-1112, 0x11a10
    int64_t v11 = &v10; // 0x11a71
    int32_t v12 = *(int32_t *)(v11 + 20); // 0x11cbd
    int64_t v13 = *(int64_t *)(v11 + 24); // 0x11cc1
    uint32_t v14 = *(int32_t *)(v11 + 12); // 0x11cc6
    uint32_t v15 = *(int32_t *)(v11 + 16); // 0x11ccb
    uint32_t v16 = *(int32_t *)(v11 + 32); // 0x11cd0
    uint32_t v17 = *(int32_t *)(v11 + 36); // 0x11cd5
    int32_t v18 = v12 < 70 == (69 - v12 & v12) < 0 ? v12 : v12 + 100; // 0x11ce0
    int32_t v19 = v12 - (int32_t)&g200; // 0x11ce9
    uint32_t v20 = v19 < 0 == ((v19 ^ v12) & (v12 ^ (int32_t)&g200)) < 0 ? v12 - 1900 : v18; // 0x11cef
    int32_t v21 = v20 - 69; // 0x11cff
    int32_t v22 = v21 >= 0 ? v21 : v20 - 66; // 0x11d07
    int32_t v23 = *(int32_t *)((0x100000000 * v13 >> 30) + (int64_t)&g18); // 0x11d1d
    int64_t v24 = (int64_t)(365 * v20 - 0x63ce) + (int64_t)v23 + (int64_t)(v22 >> 2); // 0x11d22
    int64_t result; // 0x11a10
    if ((int32_t)v13 < 2) {
        // 0x11d5d
        result = (int64_t)v17 - 0x15180 + 60 * (60 * (24 * (v24 + (int64_t)v14) + (int64_t)v15) + (int64_t)v16);
        // 0x11d7e
        return result;
    }
    int32_t v25 = v20 + (int32_t)&g199; // 0x11d2a
    uint32_t v26 = -0x3d70a3d7 * v25 + 0x51eb850; // 0x11d36
    int64_t v27; // 0x11a10
    if ((v26 / 16 || -0x70000000 * v25) < 0xa3d70b) {
        // 0x11d5d
        v27 = v24 + 1;
        result = (int64_t)v17 - 0x15180 + 60 * (60 * (24 * (v27 + (int64_t)v14) + (int64_t)v15) + (int64_t)v16);
        // 0x11d7e
        return result;
    }
    // 0x11d48
    if ((v26 / 4 || 0x40000000 * v25) < 0x28f5c29 || v20 % 4 != 0) {
        // 0x11d5d
        result = (int64_t)v17 - 0x15180 + 60 * (60 * (24 * (v24 + (int64_t)v14) + (int64_t)v15) + (int64_t)v16);
        // 0x11d7e
        return result;
    }
    // 0x11d5d
    v27 = v24 + 1;
    result = (int64_t)v17 - 0x15180 + 60 * (60 * (24 * (v27 + (int64_t)v14) + (int64_t)v15) + (int64_t)v16);
    // 0x11d7e
    return result;
  lab_0x11b28:;
    int32_t items_assigned4 = sscanf(str, "%d:%d:%d GMT %d %400[a-zA-Z] %d", &v7, &v5, &v4, &v8, &v3, &v6); // 0x11b55
    if (items_assigned4 != 6) {
        goto lab_0x11b7a;
    } else {
        // 0x11b63
        if ((int32_t)scan_mon(&v3, &v9) != 0) {
            goto lab_0x11cbd;
        } else {
            goto lab_0x11b7a;
        }
    }
  lab_0x11b7a:;
    // 0x11b7a
    int64_t v28; // bp-552, 0x11a10
    int32_t items_assigned5 = sscanf(str, "%400[a-zA-Z], %d-%400[a-zA-Z]-%d %d:%d:%d GMT", &v28, &v8, &v3, &v6, &v7, &v5, &v4); // 0x11ba6
    int64_t v29; // bp-1072, 0x11a10
    if (items_assigned5 != 7) {
        goto lab_0x11be1;
    } else {
        // 0x11bb4
        if ((int32_t)scan_wday(&v28, &v29) == 0) {
            goto lab_0x11be1;
        } else {
            // 0x11bca
            if ((int32_t)scan_mon(&v3, &v9) != 0) {
                goto lab_0x11cbd;
            } else {
                goto lab_0x11be1;
            }
        }
    }
  lab_0x11be1:;
    int32_t items_assigned6 = sscanf(str, "%400[a-zA-Z], %d %400[a-zA-Z] %d %d:%d:%d GMT", &v28, &v8, &v3, &v6, &v7, &v5, &v4); // 0x11c10
    if (items_assigned6 != 7) {
        goto lab_0x11c47;
    } else {
        // 0x11c1e
        if ((int32_t)scan_wday(&v28, &v29) == 0) {
            goto lab_0x11c47;
        } else {
            // 0x11c34
            if ((int32_t)scan_mon(&v3, &v9) != 0) {
                goto lab_0x11cbd;
            } else {
                goto lab_0x11c47;
            }
        }
    }
  lab_0x11c47:;
    int32_t items_assigned7 = sscanf(str, "%400[a-zA-Z] %400[a-zA-Z] %d %d:%d:%d GMT %d", &v28, &v3, &v8, &v7, &v5, &v4, &v6); // 0x11c73
    if (items_assigned7 != 7 || (int32_t)scan_wday(&v28, &v29) == 0 || (int32_t)scan_mon(&v3, &v9) == 0) {
        // 0x11d7e
        return -1;
    }
    goto lab_0x11cbd;
}

// Address range: 0x11da0 - 0x11e9f
int64_t scan_mon(int64_t * str, int64_t * a2) {
    // 0x11da0
    int64_t v1; // 0x11da0
    uint64_t v2 = v1;
    if (g182 == 0) {
        // 0x11dbb
        qsort((int64_t *)&g45, 23, 16, (int32_t (*)(int64_t *, int64_t *))0x11fa0);
        g182 = 1;
    }
    if ((char)v2 != 0) {
        int16_t ** v3 = __ctype_b_loc(); // 0x11de6
        int64_t v4 = (int64_t)str;
        int64_t v5 = 0x100000000000000 * (v2 % 256);
        int32_t * v6; // 0x11e20
        if (*(char *)((int64_t)*v3 + 1 + (v5 >> 55)) % 2 != 0) {
            // 0x11e1b
            v6 = *__ctype_tolower_loc();
            *(char *)v4 = *(char *)((v5 >> 54) + (int64_t)v6);
        }
        int64_t v7 = v4 + 1;
        unsigned char v8 = *(char *)v7; // 0x11e00
        while (v8 != 0) {
            // 0x11e0c
            v4 = v7;
            v5 = 0x100000000000000 * (int64_t)v8;
            if (*(char *)((int64_t)*v3 + 1 + (v5 >> 55)) % 2 != 0) {
                // 0x11e1b
                v6 = *__ctype_tolower_loc();
                *(char *)v4 = *(char *)((v5 >> 54) + (int64_t)v6);
            }
            // 0x11e00
            v7 = v4 + 1;
            v8 = *(char *)v7;
        }
    }
    uint64_t v9 = 0;
    int64_t v10 = 22;
    int32_t v11 = v10 + v9; // 0x11e4f
    int32_t v12 = (int32_t)(v11 < 0) + v11 >> 1; // 0x11e56
    int64_t v13 = 16 * (int64_t)v12; // 0x11e5b
    int64_t str2 = *(int64_t *)(v13 + (int64_t)&g45); // 0x11e5f
    uint32_t strcmp_rc = strcmp((char *)str, (char *)str2); // 0x11e66
    int64_t result; // 0x11da0
    int64_t v14; // 0x11e43
    while (strcmp_rc < 0) {
        // 0x11e40
        v14 = v12 - 1;
        result = 0;
        if (v9 > v14) {
            return result;
        }
        v10 = v14;
        v11 = v10 + v9;
        v12 = (int32_t)(v11 < 0) + v11 >> 1;
        v13 = 16 * (int64_t)v12;
        str2 = *(int64_t *)(v13 + (int64_t)&g45);
        strcmp_rc = strcmp((char *)str, (char *)str2);
    }
    if (strcmp_rc == 0) {
        // 0x11e7f
        *a2 = *(int64_t *)((v13 | 8) + (int64_t)&g45);
        result = 1;
        return result;
    }
    int64_t v15 = v12 + 1; // 0x11e74
    result = 0;
    while (v10 >= v15) {
        // 0x11e4b
        v9 = v15;
        v11 = v10 + v9;
        v12 = (int32_t)(v11 < 0) + v11 >> 1;
        v13 = 16 * (int64_t)v12;
        str2 = *(int64_t *)(v13 + (int64_t)&g45);
        strcmp_rc = strcmp((char *)str, (char *)str2);
        while (strcmp_rc < 0) {
            // 0x11e40
            v14 = v12 - 1;
            result = 0;
            if (v9 > v14) {
                return result;
            }
            v10 = v14;
            v11 = v10 + v9;
            v12 = (int32_t)(v11 < 0) + v11 >> 1;
            v13 = 16 * (int64_t)v12;
            str2 = *(int64_t *)(v13 + (int64_t)&g45);
            strcmp_rc = strcmp((char *)str, (char *)str2);
        }
        if (strcmp_rc == 0) {
            // 0x11e7f
            *a2 = *(int64_t *)((v13 | 8) + (int64_t)&g45);
            result = 1;
            return result;
        }
        // 0x11e71
        v15 = v12 + 1;
        result = 0;
    }
  lab_0x11e90:
    // 0x11e90
    return result;
}

// Address range: 0x11ea0 - 0x11f9f
int64_t scan_wday(int64_t * str, int64_t * a2) {
    // 0x11ea0
    int64_t v1; // 0x11ea0
    uint64_t v2 = v1;
    if (*(char *)0x1b77c == 0) {
        // 0x11ebb
        qsort((int64_t *)&g46, 14, 16, (int32_t (*)(int64_t *, int64_t *))0x11fa0);
        *(char *)&g183 = 1;
    }
    if ((char)v2 != 0) {
        int16_t ** v3 = __ctype_b_loc(); // 0x11ee6
        int64_t v4 = (int64_t)str;
        int64_t v5 = 0x100000000000000 * (v2 % 256);
        int32_t * v6; // 0x11f20
        if (*(char *)((int64_t)*v3 + 1 + (v5 >> 55)) % 2 != 0) {
            // 0x11f1b
            v6 = *__ctype_tolower_loc();
            *(char *)v4 = *(char *)((v5 >> 54) + (int64_t)v6);
        }
        int64_t v7 = v4 + 1;
        unsigned char v8 = *(char *)v7; // 0x11f00
        while (v8 != 0) {
            // 0x11f0c
            v4 = v7;
            v5 = 0x100000000000000 * (int64_t)v8;
            if (*(char *)((int64_t)*v3 + 1 + (v5 >> 55)) % 2 != 0) {
                // 0x11f1b
                v6 = *__ctype_tolower_loc();
                *(char *)v4 = *(char *)((v5 >> 54) + (int64_t)v6);
            }
            // 0x11f00
            v7 = v4 + 1;
            v8 = *(char *)v7;
        }
    }
    uint64_t v9 = 0;
    int64_t v10 = 13;
    int32_t v11 = v10 + v9; // 0x11f4f
    int32_t v12 = (int32_t)(v11 < 0) + v11 >> 1; // 0x11f56
    int64_t v13 = 16 * (int64_t)v12; // 0x11f5b
    int64_t str2 = *(int64_t *)(v13 + (int64_t)&g46); // 0x11f5f
    uint32_t strcmp_rc = strcmp((char *)str, (char *)str2); // 0x11f66
    int64_t result; // 0x11ea0
    int64_t v14; // 0x11f43
    while (strcmp_rc < 0) {
        // 0x11f40
        v14 = v12 - 1;
        result = 0;
        if (v9 > v14) {
            return result;
        }
        v10 = v14;
        v11 = v10 + v9;
        v12 = (int32_t)(v11 < 0) + v11 >> 1;
        v13 = 16 * (int64_t)v12;
        str2 = *(int64_t *)(v13 + (int64_t)&g46);
        strcmp_rc = strcmp((char *)str, (char *)str2);
    }
    if (strcmp_rc == 0) {
        // 0x11f7f
        *a2 = *(int64_t *)((v13 | 8) + (int64_t)&g46);
        result = 1;
        return result;
    }
    int64_t v15 = v12 + 1; // 0x11f74
    result = 0;
    while (v10 >= v15) {
        // 0x11f4b
        v9 = v15;
        v11 = v10 + v9;
        v12 = (int32_t)(v11 < 0) + v11 >> 1;
        v13 = 16 * (int64_t)v12;
        str2 = *(int64_t *)(v13 + (int64_t)&g46);
        strcmp_rc = strcmp((char *)str, (char *)str2);
        while (strcmp_rc < 0) {
            // 0x11f40
            v14 = v12 - 1;
            result = 0;
            if (v9 > v14) {
                return result;
            }
            v10 = v14;
            v11 = v10 + v9;
            v12 = (int32_t)(v11 < 0) + v11 >> 1;
            v13 = 16 * (int64_t)v12;
            str2 = *(int64_t *)(v13 + (int64_t)&g46);
            strcmp_rc = strcmp((char *)str, (char *)str2);
        }
        if (strcmp_rc == 0) {
            // 0x11f7f
            *a2 = *(int64_t *)((v13 | 8) + (int64_t)&g46);
            result = 1;
            return result;
        }
        // 0x11f71
        v15 = v12 + 1;
        result = 0;
    }
  lab_0x11f90:
    // 0x11f90
    return result;
}

// Address range: 0x11fa0 - 0x11fab
int64_t strlong_compare(int64_t str, int64_t str2) {
    // 0x11fa0
    return strcmp((char *)str, (char *)str2);
}

// Address range: 0x11fac - 0x11fb9
int64_t _fini(void) {
    // 0x11fac
    int64_t result; // 0x11fac
    return result;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (11.4.0)
// Detected functions: 205


